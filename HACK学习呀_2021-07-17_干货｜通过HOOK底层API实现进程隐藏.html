<html>
<head>
<title>干货｜通过HOOK底层API实现进程隐藏</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
干货 ｜ 通过HOOK底层API实现进程隐藏
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                            
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-07-17</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div>

                
                                
                
                

                
                                                                

                
                                    
                    <div class="original_area_primary" style="margin-bottom: 0;">
                                                                                                </div>

                    
                                            <div class="original_area_primary">
                            <p role="option" class="original_primary_card_tips">
                                                                    <span>以下文章来源于HACK学习计划</span>
                                                                                                    <span>，作者Buffer</span>
                                                            </p>
                            <a class="weui-flex original_primary_card appmsg_card_context appmsg_card_active" href="#" id="copyright_info">
                                <div class="weui-flex__hd">
                                    <span class="radius_avatar"> </span>
                                </div>
                                <div class="weui-flex__item" role="option">
                                    <strong class="original_primary_nickname">HACK学习计划</strong>
                                                                            <span class="weui-hidden_abs">.</span>
                                        <p class="original_primary_desc">HACK学习计划养成，致力于培养渗透测试工程师，Web安全工程师，信息安全架构师，二进制安全，HACK硬件安全，移动互联网安全等，助力于为国家网络安全部队输送人才。</p>
                                                                    </div>
                                <div class="weui-flex__ft"></div>
                            </a>
                        </div><div id="weixin_content"><h2 style="margin-right: auto;margin-bottom: 2em;margin-left: auto;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);" data-mpa-powered-by="yiban.io">前言</a></h2><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">一次跟师傅交流时师傅谈到有些EDR或AV,他们保护目标主机,甚至无进程,不经想到病毒实际上也常用这种技术。当然,做到隐藏,一个简单的dll注入或者劫持就可以,但本文主要讲解关于进程的隐藏。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">PE文件隐藏可以通过</p><p style="-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;padding-left: 1em;list-style: circle;"><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>进程伪装: 将进程名替换成其他正常进程的名称(修改PEB路径和命令行信息)</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>傀儡进程: 通过将主进程挂起,替换内存数据,卸载镜像,修改上下文,并执行真正我们想要执行的进程,这也是一些壳的原理</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>HOOK: 通过HOOK三环最底层API<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">ZwQuerySystemInformation</code>实现隐藏,这是本文的重点</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>COM劫持、DLL劫持、DLL注入......</span></p><h2 style="margin: 4em auto 2em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);">实现原理</h2><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在正向开发中,要想做到进程遍历,往往需要使用<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">EnumProcess</code>或是快照<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">CreateToolhelp32Snapshot</code>这些函数 而这些函数的底层(ring 3),都是调用的<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">ZwQuerySystemInformation</code></p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="c++" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">NTSTATUS WINAPI </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">如果通过hook进行对<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">ZwQuerySystemInformation</code>的重定向,那么就可以改变执行流,返回的信息中已经被我们篡改。32位下和64位下需要修改的字节数是不同的,使用xdbg断点找到对应的硬编码</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">32位下: 需要修改5个字节硬编码</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xe9</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> xx xx xx xx</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3130034522439586" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/1_0HvLKcibChM1hU9a4Q16uZjqUszwQQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyoVyrYJic4PWWhqfnpbJ1V1GRUJ0HvLKcibChM1hU9a4Q16uZjqUszwQQ/640?wx_fmt=png'" data-type="png" data-w="869" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.1402439024390244" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/2_VQqAnSdqU9OvCpEkNeic7kgn6xDPEg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFy9ib1wkV2lWvcticiaFeY76GSYdOzVQqAnSdqU9OvCpEkNeic7kgn6xDPEg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">64位下: 需要修改12个字节的硬编码</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x48</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xb8</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> xx xx xx xx xx xx xx xx</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xFF</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xE0</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.24685816876122083" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/3_HTJSicoxo2dvsHlMO5ogu55UeickGA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyI9XR8bqXoZ1ZqKvmWPDa6JWyLFHTJSicoxo2dvsHlMO5ogu55UeickGA/640?wx_fmt=png'" data-type="png" data-w="1114" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.13211382113821138" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/4_zDooj4FHQ6iaeibBibuH80HiaYfBRQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyrWbx2uibKIWbc1pKmTUNibMpMDriaZ3zDooj4FHQ6iaeibBibuH80HiaYfBRQ/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">64位下该函数的名称已经改为<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">RtlGetNativeSystemInformation</code>。将<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">hookZwQuerySystemInformation</code>函数写在dll中,这样方便注入到任何进程中。</p><h2 style="margin: 4em auto 2em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);">实现代码</h2><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">hook函数</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="c++" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">void</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> hookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//获取ZwQuerySystemInformation的地址</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    HMODULE hntdll </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">LoadLibraryA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ntdll.dll"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Load ntdll Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#ifdef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> _WIN64</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#endif</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    typedef_ZwQuerySystemInformation </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">GetProcAddress</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ZwQuerySystemInformation"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Get ZwQuerySystemInformation Addr Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#ifdef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> _WIN64</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    BYTE pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">12</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x48</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xb8</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xFF</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xE0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">};</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    ULONGLONG </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InfoAddr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ULONGLONG</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">New_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InfoAddr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InfoAddr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">// 保存前 12 字节数据</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">g_Oldwin64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    BYTE pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0xe9</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0x0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">};</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//算出偏移地址</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    DWORD dwOffeset </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">New_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//得到完整的pData</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOffeset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOffeset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//保存原来的硬编码</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">g_Oldwin32</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#endif</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    DWORD dwOldProtect </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> NULL</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//修改为可写属性,不然会0xC00005访问错误</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">VirtualProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PAGE_EXECUTE_READWRITE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//修改硬编码</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//还原保护属性</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">VirtualProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pData</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">unhook函数</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="c++" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">void</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> unhookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//获取ZwQuerySystemInformation的地址</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    HMODULE hntdll </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">LoadLibraryA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ntdll.dll"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Load ntdll Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#ifdef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> _WIN64</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#endif</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    typedef_ZwQuerySystemInformation </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">GetProcAddress</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ZwQuerySystemInformation"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Get ZwQuerySystemInformation Addr Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    DWORD dwOldProtect </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> NULL</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//方便就直接改12个字节的可写属性</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">VirtualProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">12</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PAGE_EXECUTE_READWRITE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//还原原来的硬编码</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#ifdef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> _WIN64</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> g_Oldwin64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">g_Oldwin64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">RtlCopyMemory</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> g_Oldwin32</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">sizeof</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">g_Oldwin32</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">));</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#endif</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//还原属性</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">VirtualProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">12</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwOldProtect</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">自己可控的函数,即<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">New_ZwQuerySystemInformation</code></p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="c++" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">NTSTATUS WINAPI </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">New_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PVOID </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> ULONG </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    NTSTATUS status </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> NULL</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    PSYSTEM_PROCESS_INFORMATION pCur </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> NULL</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pPrev </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> NULL</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    DWORD dwHideProcessId </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29936</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//先卸载钩子</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    unhookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">// 获取 ntdll.dll 的加载基址, 若没有则返回</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    HMODULE hntdll </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">LoadLibraryA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ntdll.dll"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Load ntdll Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> status</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">// 获取 ZwQuerySystemInformation 函数地址</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#ifdef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> _WIN64</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">typedef</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">WINAPI</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      SYSTEM_INFORMATION_CLASS </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Inout_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">   PVOID                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_In_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">      ULONG                    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">_Out_opt_</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> PULONG                   </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">#endif</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    typedef_ZwQuerySystemInformation </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">typedef_ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">GetProcAddress</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">hntdll</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ZwQuerySystemInformation"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        std</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">::</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cout </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;&lt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"[!] Get ZwQuerySystemInformation Addr Faild..\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> status</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//调用原来的函数,第二个参数是返回请求的信息</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    status </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ReturnLength</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">NT_SUCCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">status</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">==</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformationClass</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        pCur </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">PSYSTEM_PROCESS_INFORMATION</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">SystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">while</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">TRUE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">// 判断是否是要隐藏的进程PID,是就把该进程信息删除</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dwHideProcessId </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">==</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">DWORD</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">UniqueProcessId</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">==</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                    pPrev</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                    pPrev</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pPrev</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">else</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                pPrev </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">==</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">break</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">            pCur </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">PSYSTEM_PROCESS_INFORMATION</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)((</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">BYTE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">*)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pCur </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> pCur</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">NextEntryOffset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//挂钩</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    hookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> status</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">以上函数全部写在dll中,<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">dllmain</code>主函数:</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="c++" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">BOOL APIENTRY </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">DllMain</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> HMODULE hModule</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                       DWORD  ul_reason_for_call</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                       LPVOID lpReserved</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">                     </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">switch</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ul_reason_for_call</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">case</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DLL_PROCESS_ATTACH</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        hookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        g_hModule </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> hModule</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">break</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">case</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DLL_THREAD_ATTACH</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">break</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">case</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DLL_THREAD_DETACH</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">break</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">case</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> DLL_PROCESS_DETACH</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        unhookZwQuerySystemInformation</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">break</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> TRUE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><h2 style="margin: 4em auto 2em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);">测试</h2><p style="-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;padding-left: 1em;list-style: circle;"><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>win10</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>64位dll</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>Injectdll(进程注入程序)</span><span style="margin: 0.2em 8px;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-indent: -1em;display: block;"><span style="margin-right: 10px;-webkit-tap-highlight-color: transparent;">•</span>Taskmgr.exe</span></p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">要注意的是dll的位数。找到任务管理器pid:</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.22709163346613545" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/5_8jyZzNn2DaEhPDzia0iaAGtQPYIucA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyBtlSPaiaakGBJW5MSecofibQicY4X8jyZzNn2DaEhPDzia0iaAGtQPYIucA/640?wx_fmt=png'" data-type="png" data-w="1004" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里选择隐藏QQ程序</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3074817518248175" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/6_J5GGSTgFt4ZrGt49nNrcruSspMicfQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFySNOZpb9YwzMgVRFejyq4znyjdJ5GGSTgFt4ZrGt49nNrcruSspMicfQ/640?wx_fmt=png'" data-type="png" data-w="1096" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">注入程序后</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3482142857142857" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/7_XBUynOyVZpIkqhfgvFibaN9XiaMuVQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyZOVtrk0F5d0dx9sHBXCVUzlyQRXBUynOyVZpIkqhfgvFibaN9XiaMuVQ/640?wx_fmt=png'" data-type="png" data-w="1344" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5976491862567812" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/8_9AS9KWHmkRCM5g1VBiaRzHaFiaS34g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouicCI0NibYtz0sT1E21g2dHFyAGjsZicWXtqrhz1lVvrAEmZkiaYL9AS9KWHmkRCM5g1VBiaRzHaFiaS34g/640?wx_fmt=png'" data-type="png" data-w="1106" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到QQ进程信息已经剔除</p><h2 style="margin: 4em auto 2em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);">思考</h2><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">如何将所有进程钩住? 使用全局钩子,这里我认为是两个知识点,就不继续展开说了。</p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: rgb(163, 163, 163) !important;"><img data-ratio="0.109375" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/9_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-w="640" style="box-sizing: border-box !important;visibility: visible !important;width: 640px !important;"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__4" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__5" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgb(163, 163, 163) !important;"><strong data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)">推荐阅读：</strong></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__11" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" data-darkmode-color-16257124717414="rgb(255, 104, 39)" data-darkmode-original-color-16257124717414="#fff|rgb(255, 104, 39)" style="color: rgb(255, 104, 39);font-size:15px;line-height:35px;;letter-spacing: 0.544px;"></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__12" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="text-align: center;"><span style="font-size:15px;line-height:35px;;color: rgb(255, 104, 39);">本月报名可以参加抽奖送Kali NetHunter手机的优惠活动</span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__12" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__13" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: rgb(163, 163, 163) !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247497897&amp;idx=1&amp;sn=5801b91d451b4c253eb3e2c5ff220673&amp;chksm=ec1cad96db6b2480ce0be49a377819558c06b29603b812512b7cb52ca0c123bc444764f11502&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span class="js_jump_icon h5_image_link" data-positionback="static" style="inset: auto;margin: 0px;"><img class="rich_pages" data-ratio="0.4255555555555556" data-s="300,640" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/10_1icJc9VoX8KbdFsB6plzmBCTjGDibQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibHHibNbEpsAMia19jkGuuz9tTIfiauo7fjdWicOTGhPibiat3Kt90m1icJc9VoX8KbdFsB6plzmBCTjGDibQ/640?wx_fmt=png'" data-type="png" data-w="900" style="border-width: 0px;border-style: initial;border-color: initial;border-radius: 30px;inset: auto;margin: 0px;box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></span></a></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__14" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__15" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" data-darkmode-color-16257124717414="rgb(255, 104, 39)" data-darkmode-original-color-16257124717414="#fff|rgb(255, 104, 39)" style="font-size:18px;line-height:38px;;color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" data-darkmode-color-16257124717414="rgb(255, 104, 39)" data-darkmode-original-color-16257124717414="#fff|rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" class="js_darkmode__16" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: right;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" class="js_darkmode__17" style="background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: right;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16257124717414="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16257124717414="#fff|rgb(255, 255, 255)" style="font-size:12px;line-height:32px;;">原创投稿作者：Buffer</span></p><p style="text-align: center;"><img class="rich_pages" data-galleryid="" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2021-07-17_干货｜通过HOOK底层API实现进程隐藏/11_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>