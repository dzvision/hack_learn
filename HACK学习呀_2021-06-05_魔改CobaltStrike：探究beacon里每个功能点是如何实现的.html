<html>
<head>
<title>魔改CobaltStrike：探究beacon里每个功能点是如何实现的</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
魔改CobaltStrike：探究beacon里每个功能点是如何实现的
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                            
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-06-05</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div>

                
                                
                
                

                
                                                                

                
                                    
                    <div class="original_area_primary" style="margin-bottom: 0;">
                                                                                                </div>

                    
                                            <div class="original_area_primary">
                            <p role="option" class="original_primary_card_tips">
                                                                    <span>以下文章来源于moonsec</span>
                                                                                                    <span>，作者快乐鸡哥</span>
                                                            </p>
                            <a class="weui-flex original_primary_card appmsg_card_context appmsg_card_active" href="#" id="copyright_info">
                                <div class="weui-flex__hd">
                                    <span class="radius_avatar"> </span>
                                </div>
                                <div class="weui-flex__item" role="option">
                                    <strong class="original_primary_nickname">moonsec</strong>
                                                                            <span class="weui-hidden_abs">.</span>
                                        <p class="original_primary_desc">暗月博客</p>
                                                                    </div>
                                <div class="weui-flex__ft"></div>
                            </a>
                        </div><div id="weixin_content"><p data-mpa-powered-by="yiban.io"><br  /></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="95749"><section style="text-align: center;margin:10px auto;"><section style="display:inline-block;max-height:35px;overflow:hidden;"><section data-brushtype="text" style="line-height:1.75em;color:#6ab82e;color:#f24900;letter-spacing: 2px;text-align: center;font-size:20px;line-height:40px;;"><strong>魔改CobaltStrike：命由己造（上）</strong></section><section style="box-sizing:border-box;width:100%;margin-top:-45px;pointer-events: none;" data-width="100%"><img data-ratio="0.28056426332288403" data-type="gif" data-w="638" data-width="100%" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/1_5lSfkQDicmiaSYV83hFWF2jibqe5Kw.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDXnbrujNUknAj8wKX54fxVoDxpRE5lSfkQDicmiaSYV83hFWF2jibqe5Kw/640?wx_fmt=gif'" style="box-sizing:border-box;width:100%;display:block;opacity:0.7;"  /></section></section></section></section><section data-tools="135编辑器" data-id="88503"><section style="margin: 10px auto;padding: 2px;box-sizing: border-box;"><section style="box-sizing: border-box;width: 56px;height: 40px;text-align: center;font-size: 2em;color: rgb(254, 254, 254);float: left;line-height: 40px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkRibiawOia1oleaXibzOjw4RmJfo7BqLQibUN0FQJcCQN2byCoGdc1CiarHk187AXDCRjQwx3438AN1cjJA/640?wx_fmt=png&quot;);background-repeat: no-repeat;background-size: 100%;background-color: rgb(139, 183, 72);"><section data-original-title="" title="">1</section></section><section style="overflow-wrap: break-word;border-bottom: 2px dashed rgb(128, 177, 53);min-height: 36px;display: inline-block;line-height: 36px;margin-top: 0px;margin-left: 10px;box-sizing: border-box;"><span data-brushtype="text" style="color: #80B135;font-size:18px;line-height:38px;;margin-top: 0px;display: inline-block;">概述</span></section></section></section><p style="text-indent: 0.29in;margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">这次我们来探究</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">里每个功能点是如何实现的，以便日后更好地实现自定义</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">。因为有近百个相关功能点，所以文章就分了上下两部分。</span></span></p><p style="text-indent: 0.29in;margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;font family: 等线;">项目地址如下：</span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">https://github.com/mai1zhi2/CobaltstrikeSource</span></p><p style="margin-bottom: 0in;"><br  /></p><section data-tools="135编辑器" data-id="88503"><section style="margin: 10px auto;padding: 2px;box-sizing: border-box;"><section style="box-sizing: border-box;width: 56px;height: 40px;text-align: center;font-size: 2em;color: rgb(254, 254, 254);float: left;line-height: 40px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkRibiawOia1oleaXibzOjw4RmJfo7BqLQibUN0FQJcCQN2byCoGdc1CiarHk187AXDCRjQwx3438AN1cjJA/640?wx_fmt=png&quot;);background-repeat: no-repeat;background-size: 100%;background-color: rgb(139, 183, 72);"><section data-original-title="" title="" data-num="2">2</section></section><section style="overflow-wrap: break-word;border-bottom: 2px dashed rgb(128, 177, 53);min-height: 36px;display: inline-block;line-height: 36px;margin-top: 0px;margin-left: 10px;box-sizing: border-box;"><span data-brushtype="text" style="color: #80B135;font-size:18px;line-height:38px;;margin-top: 0px;display: inline-block;">前情提要</span></section></section></section><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">我们从上篇协议剖析得文章中知道当</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">发送心跳包后，</span>teamserver<span style="font-size:15px;line-height:35px;;font family: 等线;">会返回相应的任务号，并返回相应得任务信息，</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">接收到任务信息后，会进入循环处理：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4083885209713024" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/2_KZa71azCibbGNnu02967GnVibnTtHw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDQHjPGia8iarFibYNctTAqExH7LPHIKZa71azCibbGNnu02967GnVibnTtHw/640?wx_fmt=png'" data-type="png" data-w="453" height="210" width="514"></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">在</span>AllCase_10007F19()<span style="font-size:15px;line-height:35px;;font family: 等线;">里面就是</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">得全部命令功能，我们按反编译循环中的</span>case<span style="font-size:15px;line-height:35px;;font family: 等线;">号从低向高写，</span>case<span style="font-size:15px;line-height:35px;;font family: 等线;">号与发送数据包的任务号是大同小异的。</span></span></p><p style="margin-bottom: 0in;"><br  /></p><section data-tools="135编辑器" data-id="88503"><section style="margin: 10px auto;padding: 2px;box-sizing: border-box;"><section style="box-sizing: border-box;width: 56px;height: 40px;text-align: center;font-size: 2em;color: rgb(254, 254, 254);float: left;line-height: 40px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkRibiawOia1oleaXibzOjw4RmJfo7BqLQibUN0FQJcCQN2byCoGdc1CiarHk187AXDCRjQwx3438AN1cjJA/640?wx_fmt=png&quot;);background-repeat: no-repeat;background-size: 100%;background-color: rgb(139, 183, 72);"><section data-original-title="" title="" data-num="3">3</section></section><section style="overflow-wrap: break-word;border-bottom: 2px dashed rgb(128, 177, 53);min-height: 36px;display: inline-block;line-height: 36px;margin-top: 0px;margin-left: 10px;box-sizing: border-box;"><span data-brushtype="text" style="color: #80b135;font-size:18px;line-height:38px;;margin-top: 0px;display: inline-block;">功能剖析</span></section></section></section><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>spawn</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>（</strong></span><strong>x86</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>）</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case1<span style="font-size:15px;line-height:35px;;font family: 等线;">，派生会话，原理是挂起方式启动</span>rundll32<span style="font-size:15px;line-height:35px;;font family: 等线;">并注入</span>dll</span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;font family: 等线;">接收到的数据：</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.34216335540838855" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/3_wHgyT6YodqH7sUrTLyw0lQaC5UZf6A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDnjABcuUaGJqQr2ibmXGgSUpdUwHgyT6YodqH7sUrTLyw0lQaC5UZf6A/640?wx_fmt=png'" data-type="png" data-w="453" height="189" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">Createprocess()<span style="font-size:15px;line-height:35px;;font family: 等线;">以挂起方式启动</span>rundll32.exe<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.282560706401766" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/4_46uE24vCgBXG98OL7RCtRjSksssBSA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD84Uuiaiciavc2XP1icib4L32a0yFQ46uE24vCgBXG98OL7RCtRjSksssBSA/640?wx_fmt=png'" data-type="png" data-w="453" height="156" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">注意输入的标志</span>0x00000004<span style="color: #FF0000;font-size:15px;line-height:35px;;">&nbsp;CREATE_SUSPENDED</span>:</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3576158940397351" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/5_vxibYAWtE8LViaR0x1EvUCmYlHVJMQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDNdCsn3OvuzhDd30CChCDyl5yRFvxibYAWtE8LViaR0x1EvUCmYlHVJMQ/640?wx_fmt=png'" data-type="png" data-w="453" height="198" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.0772626931567329" data-type="png" data-w="453" height="42" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/6_oXCibMauiaiboj2YRfmZgJWBgleTOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDzsY2p4qjL7ZPGKza5gA5wNg5gZfoXCibMauiaiboj2YRfmZgJWBgleTOg/640?wx_fmt=png'" width="547"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">使用</span>VirtualAllocEx()<span style="font-size:15px;line-height:35px;;font family: 等线;">在目标</span>rundll32<span style="font-size:15px;line-height:35px;;font family: 等线;">进程申请内存空间：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.12582781456953643" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/7_CSw5OPibvS29XynCicicG6q1CX2iaw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDNWkrZhXslIc9BS48azIA6fSOiau5ICSw5OPibvS29XynCicicG6q1CX2iaw/640?wx_fmt=png'" data-type="png" data-w="453" height="70" width="553"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.40397350993377484" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/8_5o32trfEh4ErY4b7gR4hOicb2CmuLw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDfyKGMuicPp0dxCxRvjx12C5Isx5o32trfEh4ErY4b7gR4hOicb2CmuLw/640?wx_fmt=png'" data-type="png" data-w="453" height="223" width="553"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">WriteProcessMemory()<span style="font-size:15px;line-height:35px;;font family: 等线;">在申请的内存空间写入</span>dll<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.25165562913907286" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/9_sbiaMqF7bzVhfYRRLlia5BdcGncrfQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDy4619bSVBeQAMcVbzXyDsSGc8PsbiaMqF7bzVhfYRRLlia5BdcGncrfQ/640?wx_fmt=png'" data-type="png" data-w="453" height="139" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3487858719646799" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/10_uv6Zc3mVJxZjCDF828GxibdfcO4iaw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDgEe8yDTsWIWQgHTBvSYJ8OzkEluv6Zc3mVJxZjCDF828GxibdfcO4iaw/640?wx_fmt=png'" data-type="png" data-w="453" height="193" width="553"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">使用</span>VirtualProtectEx()<span style="font-size:15px;line-height:35px;;font family: 等线;">设置内存属性，</span><span style="color: rgb(111, 0, 138);font-size:15px;line-height:35px;;font family: 新宋体, serif;">PAGE_EXECUTE_READWRITE</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.1368653421633554" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/11_ibd4ZdUthAoB5Mvz6w5DE4eiaItXTA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDKzyd7kSaBvkS2L6GsKoiaJUS0iamibd4ZdUthAoB5Mvz6w5DE4eiaItXTA/640?wx_fmt=png'" data-type="png" data-w="453" height="76" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.39293598233995586" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/12_OFpXh8ic2uF2icLccq92CeN07aia9g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDDe1I4o5SY4j32CHgvfCiar1zSSbibOFpXh8ic2uF2icLccq92CeN07aia9g/640?wx_fmt=png'" data-type="png" data-w="453" height="217" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">设置</span>context<span style="font-size:15px;line-height:35px;;font family: 等线;">上下文，并恢复线程：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.12582781456953643" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/13_AJTDbrfaVq5pFzSNaKcedTpLGSqj2A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDuNFn3mk46OpM9adk6a6Mg9PvAJTDbrfaVq5pFzSNaKcedTpLGSqj2A/640?wx_fmt=png'" data-type="png" data-w="453" height="69" width="553"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.0684326710816777" data-type="png" data-w="453" height="38" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/14_h82MXG6VoyBM2nC1DQOcIjUj87n2Ag.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDFpiacfhiarCzslaVllEOdPhCv1h82MXG6VoyBM2nC1DQOcIjUj87n2Ag/640?wx_fmt=png'" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.0706401766004415" data-type="png" data-w="453" height="35" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/15_iaicibPhAxDu7L5L8n257LyzxWpNvQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDVUYY6DLXomcXu2pDjF5BWv9afa6iaicibPhAxDu7L5L8n257LyzxWpNvQ/640?wx_fmt=png'" width="496"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.02869757174392936" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/16_gVXU1gBicPD4bPWNOhEw7ojNunMtOA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDaRwu9I1Cdg3byaVk6YwcCRh26gVXU1gBicPD4bPWNOhEw7ojNunMtOA/640?wx_fmt=png'" data-type="png" data-w="453" height="16" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>exit</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>退出</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case3<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>Exit<span style="font-size:15px;line-height:35px;;font family: 等线;">退出功能，修改</span>dwMilliseconds<span style="font-size:15px;line-height:35px;;font family: 等线;">时间为</span>0<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.1479028697571744" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/17_3Y5Bs5j4VkRgTWgnFhA6Rwibvh1gkw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDIPKzvfhdvIPNDPnvLQJthDzAW3Y5Bs5j4VkRgTWgnFhA6Rwibvh1gkw/640?wx_fmt=png'" data-type="png" data-w="453" height="82" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">如果为</span>0<span style="font-size:15px;line-height:35px;;font family: 等线;">就调用</span>sub_10009BB0()<span style="font-size:15px;line-height:35px;;font family: 等线;">退出程序：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4481236203090508" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/18_w0jon35PuJibmGicv4XDZibpIupTnQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDCeXp4l2N8blxL2cYhLyz41Wtf5Mw0jon35PuJibmGicv4XDZibpIupTnQ/640?wx_fmt=png'" data-type="png" data-w="453" height="248" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Sleep</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case4<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>Sleep<span style="font-size:15px;line-height:35px;;font family: 等线;">设置</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">睡眠时间</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">接收数据包，取得修改的时间并进行修改</span>dwMilliseconds</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3465783664459161" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/19_CSZGlP1E577WNomPf74t8d5JMwgoEg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDkCWbyfiaAN8hBQczfjT9APMrdCSZGlP1E577WNomPf74t8d5JMwgoEg/640?wx_fmt=png'" data-type="png" data-w="453" height="192" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4768211920529801" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/20_3XXDGB7Z9zp5pGD2uPgcuerd3Iwwyg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD6GbnewfhSmr3bVAlATOfrETia3XXDGB7Z9zp5pGD2uPgcuerd3Iwwyg/640?wx_fmt=png'" data-type="png" data-w="453" height="264" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Cd</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>切换目录</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case 5<span style="font-size:15px;line-height:35px;;font family: 等线;">，切换目录使用</span>S<em><span style="font-style: normal;font-size:15px;line-height:35px;;">etCurrentDirectory</span></em><span style="font-size:15px;line-height:35px;;font family: 等线;">切换当前进程的当前工作目录。</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.26269315673289184" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/21_YtznMHicyFJXoeJ85Q9EP3r9pxfkDw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDxJjOQuEwLogFAGOvdqotjU7EJYtznMHicyFJXoeJ85Q9EP3r9pxfkDw/640?wx_fmt=png'" data-type="png" data-w="453" height="145" width="553"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4216335540838852" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/22_neibJmLg8nYBYKuLuhenGC3BTVB7qg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDUWLEfdBYtVXooIMbEnbwicmoCicneibJmLg8nYBYKuLuhenGC3BTVB7qg/640?wx_fmt=png'" data-type="png" data-w="453" height="234" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Inject(x86)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case9<span style="font-size:15px;line-height:35px;;font family: 等线;">，指定已打开进程来注入会话，原理就是远程线程注入，</span>dllinject<span style="font-size:15px;line-height:35px;;font family: 等线;">、</span>shinject<span style="font-size:15px;line-height:35px;;font family: 等线;">之类也会走这个</span>case<span style="font-size:15px;line-height:35px;;font family: 等线;">。</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">先用</span>openprocess()<span style="font-size:15px;line-height:35px;;font family: 等线;">打开目标进程：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.22958057395143489" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/23_Ie96ia1zdlbLWxA302YmDJrJrdicUg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDFTg2m3ZicmL4ibFDbucAaY442nweIe96ia1zdlbLWxA302YmDJrJrdicUg/640?wx_fmt=png'" data-type="png" data-w="453" height="127" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">目标申请空间后写入</span>dll<span style="font-size:15px;line-height:35px;;font family: 等线;">文件：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.17218543046357615" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/24_bI97ibFqOTFTJib6PPOlxG2IJYUWZQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDsJDlbwXjDsY6JAYIKnlRibwv7eYibI97ibFqOTFTJib6PPOlxG2IJYUWZQ/640?wx_fmt=png'" data-type="png" data-w="453" height="95" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">最后调用</span>CreateRemoteThread()<span style="font-size:15px;line-height:35px;;font family: 等线;">进行远程线程注入：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.05077262693156733" data-type="png" data-w="453" height="28" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/25_aBYEFOf5rl9ICdzuj8ibSicFfg7p8w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD94zT9ahKE3Je9rXVh5GRY0aaf6aBYEFOf5rl9ICdzuj8ibSicFfg7p8w/640?wx_fmt=png'" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.24282560706401765" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/26_qytuzWVNeDWZFm5e6BFiaOELZYXNyQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDdpocgFJianzBibMBoMGtBmiauN40qytuzWVNeDWZFm5e6BFiaOELZYXNyQ/640?wx_fmt=png'" data-type="png" data-w="453" height="134" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Upload</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>上传文件</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case10 <span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>upload<span style="font-size:15px;line-height:35px;;font family: 等线;">上传文件，</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.39293598233995586" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/27_W5IP3EQY1pUQu3jfiadkpia3SasRaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDydcEBIVX2icM4Q9N6WCgGmzGoWaW5IP3EQY1pUQu3jfiadkpia3SasRaA/640?wx_fmt=png'" data-type="png" data-w="453" height="217" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">首先分割</span>teamserver<span style="font-size:15px;line-height:35px;;font family: 等线;">回传的数据，得到上传的文件名，然后</span>wb<span style="font-size:15px;line-height:35px;;font family: 等线;">模式打开文件：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.31125827814569534" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/28_79PeFUC7yDt9WjB9gQADNQ4BvBKKYw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD34oDZuI4mKtxV9Vdr76kTtoJ79PeFUC7yDt9WjB9gQADNQ4BvBKKYw/640?wx_fmt=png'" data-type="png" data-w="453" height="172" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">然后获得数据长度和内容，调用</span>fwrite<span style="font-size:15px;line-height:35px;;font family: 等线;">写入：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3995584988962472" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/29_nnT1erHqia1vv39Ng3A9dticMEqYbg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDqxicZKpv31jnPsCo36ic9HiaFCQAnnnT1erHqia1vv39Ng3A9dticMEqYbg/640?wx_fmt=png'" data-type="png" data-w="453" height="221" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>download</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>下载文件</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case11<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>download<span style="font-size:15px;line-height:35px;;font family: 等线;">下载文件，先分割数据包获得需要下载的文件名，然后打开文件，不断读取文件内容，然后加密返回给</span>teamserver<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.40176600441501104" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/30_qastuqawwFR36ibCk6zPiagjjWOJ4w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDpkA9U27glJ9VM7sBP2QplnZobbqastuqawwFR36ibCk6zPiagjjWOJ4w/640?wx_fmt=png'" data-type="png" data-w="453" height="223" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3995584988962472" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/31_ffMrBx47qsb9IxPkHFL8p9qcHJ6wHQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDOZFAfoaXjgCf0VrjC9LibzVfwffMrBx47qsb9IxPkHFL8p9qcHJ6wHQ/640?wx_fmt=png'" data-type="png" data-w="453" height="221" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>execute</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>执行程序</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case12 <span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>execute<span style="font-size:15px;line-height:35px;;font family: 等线;">执行程序，但不回显</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.37527593818984545" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/32_ZdL7NKV1otVrbw6VSMYu0oax5RSj4w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD2FcCpdK9VbDOA317Ic93mOichZdL7NKV1otVrbw6VSMYu0oax5RSj4w/640?wx_fmt=png'" data-type="png" data-w="453" height="208" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">直接使用</span>createprocess()<span style="font-size:15px;line-height:35px;;font family: 等线;">启动相应进程：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4282560706401766" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/33_tbviceMyPhtgSD0dA7aQdPibRk9lcA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDKQVDJ91T4CmU0Wc936CLCtMPzibtbviceMyPhtgSD0dA7aQdPibRk9lcA/640?wx_fmt=png'" data-type="png" data-w="453" height="237" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Spawnto(x86)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case13<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>spawnto<span style="font-size:15px;line-height:35px;;font family: 等线;">，设置</span>Beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">派生会话时使用的程序</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2141280353200883" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/34_WbO2KoUjSK1q4JeespZlBVDxDffRjA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDeZ5kzTCo4goYCic1MyTtqS8Z9WbO2KoUjSK1q4JeespZlBVDxDffRjA/640?wx_fmt=png'" data-type="png" data-w="453" height="118" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">当再执行</span>spawn<span style="font-size:15px;line-height:35px;;font family: 等线;">时，会判断启用哪个程序进行注入，而不是再注入默认的</span>rundll32.exe<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.16997792494481237" data-type="png" data-w="453" height="94" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/35_bUcJb4bamS3ia0oS73cHv4icicSlwA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD12BVdUk5BhRLticaXKrtzghIRlafbUcJb4bamS3ia0oS73cHv4icicSlwA/640?wx_fmt=png'" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.11479028697571744" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/36_S4C2zWW78W0ruuNOa1ssVicCCkzlhw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDiboLGNL8gQO74sJoVJqUWP0n5XS4C2zWW78W0ruuNOa1ssVicCCkzlhw/640?wx_fmt=png'" data-type="png" data-w="453" height="64" width="553"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.07947019867549669" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/37_unicDRL30oKbPSkpRULmaQIdmAMhyA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD69NH10jlU47vtlInxAxAcptOOunicDRL30oKbPSkpRULmaQIdmAMhyA/640?wx_fmt=png'" data-type="png" data-w="453" height="44" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.03532008830022075" data-type="png" data-w="453" height="20" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/38_gC61vsWAhkS0CbqaPVAJej0thHdSSQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD7S3JRJhpxAhklMABhjptHHeTgC61vsWAhkS0CbqaPVAJej0thHdSSQ/640?wx_fmt=png'" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>端口转发数据回传</strong></span><strong>(</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>没有命令参数</strong></span><strong>)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>case15</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>，</strong></span><strong>case16</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>，</strong>这两个是与</span>rportfwd<span style="font-size:15px;line-height:35px;;font family: 等线;">端口转发相关的</span>case<span style="font-size:15px;line-height:35px;;font family: 等线;">，首先接收到访问目标机器的请求信息：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.26490066225165565" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/39_zWW3CJap1pa8rOSsMOuXRz4WgY2bmA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDDLcWwkax2VGcapnUWCCXO1CvzWW3CJap1pa8rOSsMOuXRz4WgY2bmA/640?wx_fmt=png'" data-type="png" data-w="453" height="147" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">然后发送给目标机器，然后中转机通过</span>select<span style="font-size:15px;line-height:35px;;font family: 等线;">模型等待信息返回：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.5827814569536424" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/40_XFWeWiahNBJR2b4PLzuk1gMs4eJ02A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDU7vqfT9iagPiaNXrTeGPHhP8WzCXFWeWiahNBJR2b4PLzuk1gMs4eJ02A/640?wx_fmt=png'" data-type="png" data-w="453" height="323" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">最后把</span>rportfwd<span style="font-size:15px;line-height:35px;;font family: 等线;">端口转发的信息返回：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.35320088300220753" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/41_4N92aic9fVPw4xiaA5xhNngXWhZupg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDmf5LibnVyVUqBblZ7O1g0Sl6ibjv4N92aic9fVPw4xiaA5xhNngXWhZupg/640?wx_fmt=png'" data-type="png" data-w="453" height="195" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>desktopVNC</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>远程桌面</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case18<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>x86 desktopVNC<span style="font-size:15px;line-height:35px;;font family: 等线;">远程桌面（不注入其他进程），不建议用</span>vnc</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2251655629139073" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/42_dJNDNSOTgBsy3MKnywv0ttobYz6x2Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDUY6rqMNjyiasJ1icTjCwmiclZQVdJNDNSOTgBsy3MKnywv0ttobYz6x2Q/640?wx_fmt=png'" data-type="png" data-w="453" height="124" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>download_cancel</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>取消相关下载文件</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case19<span style="font-size:15px;line-height:35px;;font family: 等线;">，命令</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">取消相关的文件下载：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.24282560706401765" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/43_Q0X3F1J7YmTgf15qcG2rg68nDdBqrQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDoUfle2MnvrgnLUQeuyMyvPcOQ0X3F1J7YmTgf15qcG2rg68nDdBqrQ/640?wx_fmt=png'" data-type="png" data-w="453" height="134" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>中转子</strong></span><strong>beacon</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>所发送的数据</strong></span><strong>(</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>没有相关命令参数</strong></span><strong>)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case22<span style="font-size:15px;line-height:35px;;font family: 等线;">，没有相关命令行，负责中转子</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">的数据传输（注意，不是端口转发的数据）：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3620309050772627" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/44_xF1XnHGReiaCuib3TEa035m3zGaCvw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD1aE23jZId2eqTX1I1EWD5l6WmuxF1XnHGReiaCuib3TEa035m3zGaCvw/640?wx_fmt=png'" data-type="png" data-w="453" height="200" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.17660044150110377" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/45_Mqgo5Ppjic9AiavucnzVeuAZ33YRjw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDphibPpBRWY1959el5RarU2jAX0pMqgo5Ppjic9AiavucnzVeuAZ33YRjw/640?wx_fmt=png'" data-type="png" data-w="453" height="98" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.18763796909492272" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/46_2qA8WXtUwlHN9wqqPhYUcgPzUYF7kA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDHiav7NP24xoogzsUm9bhTFXbY2qA8WXtUwlHN9wqqPhYUcgPzUYF7kA/640?wx_fmt=png'" data-type="png" data-w="453" height="104" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.31346578366445915" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/47_qaiafqblZgWibHKuvEkUfzEHYA2ZBw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDTiciaWb7kPkY9qxkWibswE5f0g1XBqaiafqblZgWibHKuvEkUfzEHYA2ZBw/640?wx_fmt=png'" data-type="png" data-w="453" height="173" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Unlink</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case23<span style="font-size:15px;line-height:35px;;font family: 等线;">，调用</span>shutdow()<span style="font-size:15px;line-height:35px;;font family: 等线;">断开与子</span>Beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">的连接</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4194260485651214" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/48_NQcm0qkDKIyUbYiaicJrGS3aTKiaHA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD6DpS87AxFo6G8qHsnC8ibYYaSMDdNQcm0qkDKIyUbYiaicJrGS3aTKiaHA/640?wx_fmt=png'" data-type="png" data-w="453" height="232" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.17880794701986755" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/49_b3Z0fqTxoYjOsXBWE37XWQVbvhmgyw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDAZRhsmwzsRCPunhqxWMD8VTrb3Z0fqTxoYjOsXBWE37XWQVbvhmgyw/640?wx_fmt=png'" data-type="png" data-w="453" height="99" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Getuid</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case27<span style="font-size:15px;line-height:35px;;font family: 等线;">，获取当前令牌关联的用户</span>ID</span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">使用</span>GetTokenInformation<span style="font-size:15px;line-height:35px;;font family: 等线;">检索令牌信息和</span>LookuoAccountSid<span style="font-size:15px;line-height:35px;;font family: 等线;">获取令牌</span>SID<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2803532008830022" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/50_nBTRRJsFhbsutIb06EtIwia8Zp8BjQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDMVFUa7hFaO1G4z9mSRLb6VGuSnBTRRJsFhbsutIb06EtIwia8Zp8BjQ/640?wx_fmt=png'" data-type="png" data-w="453" height="155" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;font family: 等线;">最后拼接输出：</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.24282560706401765" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/51_ia06dOYicGCOEP2ticNKzWHmGgqnxw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDNObWtmwEOIWCeJXt98jqKoGrGugia06dOYicGCOEP2ticNKzWHmGgqnxw/640?wx_fmt=png'" data-type="png" data-w="453" height="135" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>rev2self</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case28<span style="font-size:15px;line-height:35px;;font family: 等线;">，恢复</span>Beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">原始令牌</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">调用</span>RevertToSelf()<span style="font-size:15px;line-height:35px;;font family: 等线;">终止当前用户标识的模拟并返回原始线程标记</span>:</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.6136865342163356" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/52_VeS4ITXd6OeUvzfClTtuLjBBnfrmrQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD6ItkNdicDY6Q2212ec2Sk9ibsgVeS4ITXd6OeUvzfClTtuLjBBnfrmrQ/640?wx_fmt=png'" data-type="png" data-w="453" height="338" width="551"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.18543046357615894" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/53_3Jcx2UAMxGLe2R5Xj3gxmQnM2PLdYg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDK7ymOyA9VFaddRHIc9e5ePv83Jcx2UAMxGLe2R5Xj3gxmQnM2PLdYg/640?wx_fmt=png'" data-type="png" data-w="453" height="103" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>steal_token</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case31<span style="font-size:15px;line-height:35px;;font family: 等线;">，从目标进程中窃取访问令牌</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">先打开进程，获取指定进程的句柄令牌，再用</span>ImpersonateLoggedOnUser<span style="font-size:15px;line-height:35px;;font family: 等线;">模拟一个登陆用户的访问令牌的安全上下文，最后用</span>DuplicateTokenEx<span style="font-size:15px;line-height:35px;;font family: 等线;">拷贝一个当前令牌相同权限的令牌</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2052980132450331" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/54_25kL0a3icjvW2oeVXgq5eaoBtsaYnw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDBvLzh0aQbH3N5SfTdtXP8uvAc25kL0a3icjvW2oeVXgq5eaoBtsaYnw/640?wx_fmt=png'" data-type="png" data-w="453" height="114" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>ps</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case32<span style="font-size:15px;line-height:35px;;font family: 等线;">，显示进程列表</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">使用</span>CreateToolhelp32Snapshot()<span style="font-size:15px;line-height:35px;;font family: 等线;">、</span>Process32Next()<span style="font-size:15px;line-height:35px;;font family: 等线;">相关函数遍历系统进程信息，然后进行发送给服务器：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4083885209713024" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/55_MjdolMaOriaFokpZic5enJRooGfXVg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD7vTBwKUw6h7oWRbJ9oej53xR3JMjdolMaOriaFokpZic5enJRooGfXVg/640?wx_fmt=png'" data-type="png" data-w="453" height="226" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4900662251655629" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/56_qQzoXNUbOXvgrcwkl09rvohnaHA4wA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD87TTwwtlnoDcQicr67LaZZ5rfqQzoXNUbOXvgrcwkl09rvohnaHA4wA/640?wx_fmt=png'" data-type="png" data-w="453" height="271" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Kill</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case33<span style="font-size:15px;line-height:35px;;font family: 等线;">，结束指定进程</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">调用</span>TerminateProcess()<span style="font-size:15px;line-height:35px;;font family: 等线;">结束指定进程：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.32891832229580575" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/57_MroTOibBtfkZGGTiaRFIZ1eTH5YibA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD4AZuep0vFmjk2fQicHtytSWym523MroTOibBtfkZGGTiaRFIZ1eTH5YibA/640?wx_fmt=png'" data-type="png" data-w="453" height="182" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>powershell-import</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case37<span style="font-size:15px;line-height:35px;;font family: 等线;">，导入</span>Powershell<span style="font-size:15px;line-height:35px;;font family: 等线;">脚本</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">导入相关的</span>ps<span style="font-size:15px;line-height:35px;;font family: 等线;">脚本（如</span>nishang<span style="font-size:15px;line-height:35px;;font family: 等线;">）以便后续调用</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.47240618101545256" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/58_XIrpm24D7VD5cTLeSzG8ttWE6FawSg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDGGq7Hs4hHq0G5kNc56RPoaeiaXIrpm24D7VD5cTLeSzG8ttWE6FawSg/640?wx_fmt=png'" data-type="png" data-w="453" height="261" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.30242825607064017" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/59_KtKmbn7OujzjSkdYgFQspmF6Y8PXdw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDy3V9Jx2xDw1iasL7H5zHsRusoKtKmbn7OujzjSkdYgFQspmF6Y8PXdw/640?wx_fmt=png'" data-type="png" data-w="453" height="167" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Runas</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case38<span style="font-size:15px;line-height:35px;;font family: 等线;">，以其他用户权限执行程序</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">调用</span>CreateProcessWithLogonW()<span style="font-size:15px;line-height:35px;;font family: 等线;">函数，以某用户身份执行指定程序</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.4194260485651214" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/60_Liarc8vib3B5DZIceAFic6Wa1s3IPQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD8hJFUz8GpKiaZKWP1AdYNPeZwNa3Liarc8vib3B5DZIceAFic6Wa1s3IPQ/640?wx_fmt=png'" data-type="png" data-w="453" height="232" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.22075055187637968" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/61_vic841ydCkWfmQ97ib5UdosW4KFiaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDutMq6nXGibSjib2YT52a7sOqARqZiavic841ydCkWfmQ97ib5UdosW4KFiaA/640?wx_fmt=png'" data-type="png" data-w="453" height="122" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Pwd</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case39<span style="font-size:15px;line-height:35px;;font family: 等线;">，显示当前所在目录</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">直接用</span>GetCurrentDirectoryA()<span style="font-size:15px;line-height:35px;;font family: 等线;">得到当前目录并返回：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.141280353200883" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/62_kFw3lLxicrpzWNIKKQJbQxkzUqFicQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD9DGWSneHxStMx2gnOxOiakmicjPskFw3lLxicrpzWNIKKQJbQxkzUqFicQ/640?wx_fmt=png'" data-type="png" data-w="453" height="78" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Job</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>执行后数据的回传（没有相关命令）</strong></span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case40<span style="font-size:15px;line-height:35px;;font family: 等线;">，当</span>job(PortScan<span style="font-size:15px;line-height:35px;;font family: 等线;">之类的</span>)<span style="font-size:15px;line-height:35px;;font family: 等线;">执行后产生数据会用管道回传给</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.06181015452538632" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/63_gyfFoIt7NzFRrjvLdj8dWqZhDnevQA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDRoBUtqYiarLY47w6a4AwjFnwxgyfFoIt7NzFRrjvLdj8dWqZhDnevQA/640?wx_fmt=png'" data-type="png" data-w="453" height="34" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.41280353200883" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/64_9uv6wa5aASQnajFOtRSc7QYjZ4ZSww.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDkicSwMQKqe8HJpibegTiaGh8Qqm9uv6wa5aASQnajFOtRSc7QYjZ4ZSww/640?wx_fmt=png'" data-type="png" data-w="453" height="228" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">Createfile()<span style="font-size:15px;line-height:35px;;font family: 等线;">创建管道：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.23178807947019867" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/65_Qdo4D0j0rgickfsOia2B1iayjMnaHw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDrnqVaFHWI3mY3KXYWD8AXAuGt0DQdo4D0j0rgickfsOia2B1iayjMnaHw/640?wx_fmt=png'" data-type="png" data-w="453" height="128" width="554"  /></p><p style="margin-bottom: 0in;"><span style="color: #6F008A;font-size:15px;line-height:35px;;"><span style="color: rgb(111, 0, 138);font-size:15px;line-height:35px;;font family: 新宋体, serif;">SetNamedPipeHandleState()</span><span style="color: rgb(111, 0, 138);font-size:15px;line-height:35px;;font family: 新宋体;">设置管道</span><span style="color: rgb(111, 0, 138);font-size:15px;line-height:35px;;font family: 新宋体, serif;">PIPE_READMODE_BYTE</span><span style="color: rgb(111, 0, 138);font-size:15px;line-height:35px;;font family: 新宋体;">模式：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2141280353200883" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/66_cRomuoyaMNAxGYflld5G5FNI5GnOxQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDfkMFDnkMLtFdXFeJ0M3SC3yvicRomuoyaMNAxGYflld5G5FNI5GnOxQ/640?wx_fmt=png'" data-type="png" data-w="453" height="118" width="554"  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">调用</span>PeekNamedPipe()<span style="font-size:15px;line-height:35px;;font family: 等线;">读取管道内的数据：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.3730684326710817" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/67_cLKzPP3P7NXWugCepekpMfANgQApMw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD3W1ORGfxe4GsjQ2SvI9JuxqbicLKzPP3P7NXWugCepekpMfANgQApMw/640?wx_fmt=png'" data-type="png" data-w="453" height="206" width="554"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.11699779249448124" data-type="png" data-w="453" height="65" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/68_ibCTC9TmOcoyvfddwruEcNv8U4PoDw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDar97HK8BQNIWibe1FZHsrbbOw0ibCTC9TmOcoyvfddwruEcNv8U4PoDw/640?wx_fmt=png'" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Jobs</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case41<span style="font-size:15px;line-height:35px;;font family: 等线;">，查看</span>Beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">中的所有任务，在</span>list<span style="font-size:15px;line-height:35px;;font family: 等线;">读取后台进行中的任务</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2737306843267108" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/69_XIyFNsvGhtNO66tkqXmTx3kRuqbnYQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDZYha20clx44YibAjyDLFHf1muXIyFNsvGhtNO66tkqXmTx3kRuqbnYQ/640?wx_fmt=png'" data-type="png" data-w="453" height="151" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>jobkill</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case42<span style="font-size:15px;line-height:35px;;font family: 等线;">，结束一个在后台运行</span></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">调用</span>DisconnectNamedPipe()<span style="font-size:15px;line-height:35px;;font family: 等线;">与后台进程终止链接：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.38631346578366443" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/70_KBqRONN9rstRFNA1dU4Uv6uKCKh6mg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDgIy8GyY5o9N7U6IdyibW58yRsKBqRONN9rstRFNA1dU4Uv6uKCKh6mg/640?wx_fmt=png'" data-type="png" data-w="453" height="213" width="553"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Inject(x64)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case43<span style="font-size:15px;line-height:35px;;font family: 等线;">，指定已打开进程来注入会话，原理就是远程线程注入，</span>dllinject<span style="font-size:15px;line-height:35px;;font family: 等线;">、</span>shinject<span style="font-size:15px;line-height:35px;;font family: 等线;">之类也会走这个</span>case<span style="font-size:15px;line-height:35px;;font family: 等线;">，流程与</span>case9<span style="font-size:15px;line-height:35px;;font family: 等线;">一样。</span></span></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Spawn(x64)</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case44<span style="font-size:15px;line-height:35px;;font family: 等线;">，派生会话（</span>x64<span style="font-size:15px;line-height:35px;;font family: 等线;">），原理也是挂起线程</span>rundll32<span style="font-size:15px;line-height:35px;;font family: 等线;">线程注入</span>dll<span style="font-size:15px;line-height:35px;;font family: 等线;">，流程都是一样的，只是在不同文件夹在</span>rundll32.exe</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.423841059602649" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/71_3yf2icGY9crE8oS1m8IRLDvVXK1LcA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDoa1xr0QZiaicHiaRW6EC2L8Bj8Ft3yf2icGY9crE8oS1m8IRLDvVXK1LcA/640?wx_fmt=png'" data-type="png" data-w="453" height="235" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>X64</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>注入进程的</strong></span><strong>desktop</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case45<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>x64 desktopVNC<span style="font-size:15px;line-height:35px;;font family: 等线;">远程桌面（注入进程）</span>,<span style="font-size:15px;line-height:35px;;font family: 等线;">不建议用</span>vnc</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.1456953642384106" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/72_1sTsXOMM5jwS2qRFj9xrMmZk4MCVUA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDo1icDqAMcckoQicKcWJQfKfW1L1sTsXOMM5jwS2qRFj9xrMmZk4MCVUA/640?wx_fmt=png'" data-type="png" data-w="453" height="81" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>X86</strong><span style="font-size:15px;line-height:35px;;font family: 等线;"><strong>注入进程的</strong></span><strong>desktop</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case46<span style="font-size:15px;line-height:35px;;font family: 等线;">，</span>x86 desktopVNC<span style="font-size:15px;line-height:35px;;font family: 等线;">远程桌面（注入进程），不建议用</span>vnc</span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.1390728476821192" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/73_yojW1gYk507Soy6iaxQlLU5533E8aQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDXibo10tXCicz8rXOpUnKmoKpRfQyojW1gYk507Soy6iaxQlLU5533E8aQ/640?wx_fmt=png'" data-type="png" data-w="453" height="77" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Pause</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case47<span style="font-size:15px;line-height:35px;;font family: 等线;">，暂停，当执行到某些任务（如注入扫描</span>dll<span style="font-size:15px;line-height:35px;;font family: 等线;">）时</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">会主动暂停一秒左右：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.2119205298013245" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/74_uvfUMc250nWLYpiaJRMYOG7BxNXcZg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDOetbczShxUeC4ppIic2le1YAibyuvfUMc250nWLYpiaJRMYOG7BxNXcZg/640?wx_fmt=png'" data-type="png" data-w="453" height="117" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><strong>Make_token</strong></span></p><p style="margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;">case49<span style="font-size:15px;line-height:35px;;font family: 等线;">，创建令牌，使用</span>GetTokenInformation<span style="font-size:15px;line-height:35px;;font family: 等线;">检索令牌信息和</span>LookuoAccountSid<span style="font-size:15px;line-height:35px;;font family: 等线;">获取令牌</span>SID<span style="font-size:15px;line-height:35px;;font family: 等线;">：</span></span></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.37527593818984545" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/75_qHoPd6vEZXb9mfSibxoPtCISXrtvzw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nD5gyb0bFMpB6cNmwFWnAgzQJLXqHoPd6vEZXb9mfSibxoPtCISXrtvzw/640?wx_fmt=png'" data-type="png" data-w="453" height="208" width="553"  /></p><p style="margin-bottom: 0in;"><img align="bottom" border="0" data-ratio="0.35320088300220753" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/76_sm8PxKVqIDhBzMMpiaJ1alGr0zhDcg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Jvbbfg0s6AAdAW94oUWwsibUe3Gib9R6nDKoyKu0ZicnWibc02xZuNK4jEjZnsm8PxKVqIDhBzMMpiaJ1alGr0zhDcg/640?wx_fmt=png'" data-type="png" data-w="453" height="195" width="554"  /></p><p style="margin-bottom: 0in;"><br  /></p><p style="margin-bottom: 0in;"><br  /></p><section data-tools="135编辑器" data-id="88503"><section style="margin: 10px auto;padding: 2px;box-sizing: border-box;"><section style="box-sizing: border-box;width: 56px;height: 40px;text-align: center;font-size: 2em;color: rgb(254, 254, 254);float: left;line-height: 40px;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/fgnkxfGnnkRibiawOia1oleaXibzOjw4RmJfo7BqLQibUN0FQJcCQN2byCoGdc1CiarHk187AXDCRjQwx3438AN1cjJA/640?wx_fmt=png&quot;);background-repeat: no-repeat;background-size: 100%;background-color: rgb(139, 183, 72);"><section data-original-title="" title="" data-num="4">4</section></section><section style="overflow-wrap: break-word;border-bottom: 2px dashed rgb(128, 177, 53);min-height: 36px;display: inline-block;line-height: 36px;margin-top: 0px;margin-left: 10px;box-sizing: border-box;"><span data-brushtype="text" style="color: #80B135;font-size:18px;line-height:38px;;margin-top: 0px;display: inline-block;">小结</span></section></section></section><p style="text-indent: 0.29in;margin-bottom: 0in;"><span style="font-size:15px;line-height:35px;;"><span style="font-size:15px;line-height:35px;;font family: 等线;">在这里我们分析</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">的约前</span>50<span style="font-size:15px;line-height:35px;;font family: 等线;">项功能，一探其相关功能的实现，为日后重写</span>beacon<span style="font-size:15px;line-height:35px;;font family: 等线;">有所帮助，下次我们继续分析后</span>50<span style="font-size:15px;line-height:35px;;font family: 等线;">项功能。最后谢谢大家观看。</span></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__0" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><img data-ratio="0.109375" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/77_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-w="640" style="box-sizing: border-box !important;visibility: visible !important;width: 640px !important;"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__1" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__2" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)">推荐阅读：</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="font-size:15px;line-height:35px;;color: rgb(255, 104, 39);">本月报名可以参加抽奖送暗夜精灵6Pro笔记本电脑的优惠活动</span><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247496998&amp;idx=1&amp;sn=da047300e19463fc88fcd3e76fda4203&amp;chksm=ec1ca019db6b290f06c736843c2713464a65e6b6dbeac9699abf0b0a34d5ef442de4654d8308&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1" hasload="1" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><span class="js_jump_icon h5_image_link" data-positionback="static" style="line-height: 0;inset: auto;"><img class="rich_pages" data-galleryid="" data-ratio="0.4269788182831661" data-s="300,640" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/78_ZtzN9KGsEWibPgYw55Lkm5VuKthibQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvouibfico2qhUHkxIvX2u13s7zzLMaFdWAhC1MTl3xzjjPth3bLibSZtzN9KGsEWibPgYw55Lkm5VuKthibQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="897" style="border-width: 0px;border-style: initial;border-color: initial;border-radius: 36px;inset: auto;box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></span></a></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__5" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__6" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)" style="font-size:18px;line-height:38px;;color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__6" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p style="white-space: normal;font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><img class="rich_pages __bg_gif" data-galleryid="" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2021-06-05_魔改CobaltStrike：探究beacon里每个功能点是如何实现的/79_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style="box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></p></section>
                </div>
</div>
</body>
</html>