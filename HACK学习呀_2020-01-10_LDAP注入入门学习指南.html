<html>
<head>
<title>LDAP注入入门学习指南</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
LDAP注入入门学习指南
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                                    damit5
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-01-10</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);" data-mpa-powered-by="yiban.io"><h1 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:18px;line-height:38px;;">LDAP简介</span></h1><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;"><strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">LDAP(Lightweight Directory Access Protocol)</strong>：轻量级目录访问协议，是一种在线目录访问协议。LDAP主要用于目录中资源的搜索和查询，是X.500的一种简便的实现，是运行于TCP/IP之上的协议，端口号为：<strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">389</strong>， 加密<strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">636</strong>（SSL）</span></p><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP结构</span></a></h2><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="top: auto;left: auto;margin: 0px 287px;right: auto;bottom: auto;font-size:15px;line-height:35px;;"><img src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/1_MMGhlic5v3y9eEUUTj7UMY3EWvcb6Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjuA6ibuM896cFqiaiaHAicMuIGJq7fMMGhlic5v3y9eEUUTj7UMY3EWvcb6Q/640?wx_fmt=png'" data-type="png" style="margin: 0px;border-width: initial;border-style: none;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: middle;display: block;width: 100%;height: auto;" data-ratio="0.5361635220125787" data-w="636" data-backw="574" data-backh="308"  /></span><span style="margin-top: 0.5em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;color: rgb(153, 153, 153);display: block;text-align: center;font-size:15px;line-height:35px;;">LDAP结构</span></p><table width="710" style="width: 654px;"><thead style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><th style="box-sizing: border-box;padding: 0px 0px 0.5em;border-width: 0px 0px 3px;border-top-style: initial;border-right-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(238, 241, 248);border-left-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">属性</span></th><th style="box-sizing: border-box;padding: 0px 0px 0.5em;border-width: 0px 0px 3px;border-top-style: initial;border-right-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(238, 241, 248);border-left-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: left;"><span style="font-size:15px;line-height:35px;;">解释</span></th></tr></thead><tbody style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">dn（Distinguished Name）</span></td><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;"><span style="font-size:15px;line-height:35px;;">一条记录的位置 ，如上图，我们要想描述baby这个节点，描述如下</span><br style="box-sizing: border-box;"  /><span style="font-size:15px;line-height:35px;;">cn=baby,ou=marketing,ou=pepple,dc=mydomain,dc=org</span></td></tr><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">dc(domain compoent)</span></td><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;"><span style="font-size:15px;line-height:35px;;">一条记录所属区域 域名部分</span></td></tr><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">ou (Organization Unit)</span></td><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;"><span style="font-size:15px;line-height:35px;;">一条记录所属组织</span></td></tr><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">cn/uid（Common Name）</span></td><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;"><span style="font-size:15px;line-height:35px;;">一条记录的名字/ID</span></td></tr><tr style="box-sizing: border-box;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: inherit;vertical-align: baseline;"><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;text-align: center;"><span style="font-size:15px;line-height:35px;;">Entry</span></td><td style="box-sizing: border-box;padding: 10px 0px;border-top: 0px;border-right: 0px;border-left: 0px;border-bottom-color: rgb(238, 241, 248);outline: 0px;font-style: inherit;font family: inherit;vertical-align: middle;"><span style="font-size:15px;line-height:35px;;">条目记录数</span></td></tr></tbody></table><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">使用场景</span></h2><blockquote style="margin-top: 1.4em;margin-bottom: 1.4em;padding: 0.1px 20px;border-width: 0px 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: rgb(57, 170, 86);outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size: 1.1em;vertical-align: baseline;color: rgba(44, 44, 44, 0.6);background: rgba(208, 211, 248, 0.15);text-align: start;white-space: normal;"><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;"><span style="font-size:15px;line-height:35px;;">实战中能遇到的主要是 大厂 和 内网</span></p></blockquote><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP服务是许多公司和机构日常操作的关键组成部分，目录服务如微软的Microsoft Active Directory，Novell E-Directory和RedHat Directory服务都基于LDAP协议。不过也有其他的应用和服务会利用LDAP服务，简单是说Windows下在Server 服务器上常用AD，在Linux系统常用的服务是Openldap。</span></p><h1 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:18px;line-height:38px;;">LDAP查询语法</span></h1><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;"><span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">search</span>语法：attribute operator value<br mpa-from-tpl="t"  /><span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">search</span>&nbsp;<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">filter</span>&nbsp;option<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">s:</span>( <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"&amp;"</span>&nbsp;<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">or</span>&nbsp;<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"|"</span>&nbsp;(filter1) (filter2) (filter3) ...) (<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"!"</span>&nbsp;(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">filter</span>))</code></pre></section><p><br  /></p><p><span style="color: rgb(68, 68, 68);font-size:16px;line-height:36px;;font-weight: bold;text-align: start;letter-spacing: 0.544px;">详细解释</span></p><p><br  /></p><p><span style="color: rgb(255, 104, 39);"><strong><span style="font-size:15px;line-height:35px;;">=(等于)</span></strong></span></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">查找”Name”属性为”John”的所有对象:</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(Name=John)</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">这条语句会返回”name”为”john”的所有对象，以便强调LDAP语句的开始和结束</span><br  /></p><p><span style="color: rgb(255, 104, 39);"><strong><span style="font-size:15px;line-height:35px;;">&amp;(逻辑与)</span></strong></span></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">如果具</span><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">有多个条件，并且希望所有条件都能满足，则使用该语法。</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(Name=John)(live=Dallas))</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">以上语句查询居住在Dallas，并且名为John的所有人员</span><br  /></p><p><span style="color: rgb(255, 104, 39);"><strong><span style="font-size:15px;line-height:35px;;">!(逻辑非)</span></strong></span></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">此操作符用来排除具有特定属性的对象:</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(!Name=John)</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.544px;text-align: start;">查找所有”name”不为”John”的人员</span><br  /></p><p><span style="color: rgb(255, 104, 39);"><strong><span style="font-size:15px;line-height:35px;;">通配符 *</span></strong></span></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">可以</span><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">用通配符表示值可以等于任何内容</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(title=*)</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.544px;text-align: start;">查找具有职务头衔的所有人员</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(Name=Jo*)</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.544px;text-align: start;">查找所有”Name”以”Jo”开头的人员</span><br  /></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">最后，举一个较复杂的例子:</span><br  /></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(Name=John)(|(live=Dallas)(live=Austin)))</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">查找所有居住在Dallas或Austin，并且名为John的人员</span><br  /></p><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;"><br  /></span></p><h1 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:18px;line-height:38px;;">LDAP注入</span></h1><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP注入原因</span></h2><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP注入和SQL注入比较类似，不过没有SQL注入中那么多华丽花哨的东西，要简单一些。二者都是没有对用户输入的合法性进行验证，而是直接将数据发送给服务器进行查询，因此攻击者可以注入任意恶意代码。</span></p><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP注意事项</span></h2><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><br mpa-from-tpl="t"  /></h2><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(attribute=<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">value</span>)(injected_filter)) (second_filter)</code></pre></section><p><span style="font-size:15px;line-height:35px;;">在OpenLDAP中，第二个过滤器会被忽略，只有第一个会被执行，那么类似上面的这种注入就可以成功的。</span><br  /></p><p><span style="font-size:15px;line-height:35px;;">而在ADAM中，有两个过滤器的查询是不被允许的，那么这种注入是没什么用的。</span></p><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP过滤器</span></h2><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP 注入的一个重要原因就是过滤器的问题，LDAP 在对目录内容进行搜索的时候，需要过滤器来进行配置</span></p><blockquote style="margin-top: 1.4em;margin-bottom: 1.4em;padding: 0.1px 20px;border-width: 0px 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: rgb(57, 170, 86);outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size: 1.1em;vertical-align: baseline;color: rgba(44, 44, 44, 0.6);background: rgba(208, 211, 248, 0.15);text-align: start;white-space: normal;"><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;"><span style="font-size:15px;line-height:35px;;">LDAP过滤器定义于RFC4515中，这些过滤器的结构可概括如下：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;"><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Fileter</span>&nbsp;= (filtercomp)<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Filtercomp</span>&nbsp;= and / or / not / item<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">And</span>&nbsp;= &amp; filterlist<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Or</span>&nbsp;= | filterlist<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Not</span>&nbsp;= ! filter<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Filterlist</span>&nbsp;= <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">1</span>*filter<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Item</span>&nbsp;= simple / present / substring<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Simple</span>&nbsp;= “=” / “~=” / ”&gt;=” / “&lt;=”<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Present</span>&nbsp;= attr =*<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Substring</span>&nbsp;= attr “=” [initial]*[final]<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Initial</span>&nbsp;= assertion value<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">Final</span>&nbsp;= assertion value</code></pre></section><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;"><span style="color: rgb(68, 68, 68);letter-spacing: 0.544px;font-size:15px;line-height:35px;;">所有过滤器必须置于括号中，只有简化的逻辑操作符</span><code style="color: rgb(68, 68, 68);letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">(AND、OR、NOT)</span></code><span style="color: rgb(68, 68, 68);letter-spacing: 0.544px;font-size:15px;line-height:35px;;">和关系操作符</span><code style="color: rgb(68, 68, 68);letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">(=、&gt;=、&lt;=、~=)</span></code><span style="color: rgb(68, 68, 68);letter-spacing: 0.544px;font-size:15px;line-height:35px;;">可用于构造它们。特殊符“*”可用来替换过滤器中的一个或多个字符。</span></p></blockquote><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">除使用逻辑操作符外，RFC4256还允许使用下面的单独符号作为两个特殊常量：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;) -&gt;Absolute <span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">TRUE</span>&nbsp;<br mpa-from-tpl="t"  />(|) -&gt;Absolute <span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">FALSE</span></code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;color: rgb(57, 170, 86);font-weight: bold;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;">LDAP注入举栗</span></p><p><span style="font-size:15px;line-height:35px;;"><strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">AND</strong>&nbsp;LDAP注入</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">当后端的代码如下</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(parameter1=value1)(parameter2=value2))</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">这里value1和value2都会被查询，其中value1和value2是用户可控的，如果过滤不完善，就会存在LDAP注入的可能。</span><br  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">比如一个用户登录的场景，用户输入username和password，应用会构造一个过滤器并发给LDAP服务器进行查询。</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(username=uname)(password=<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">pwd</span>))</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">当用户输入一个有效的</span><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">用户名，例如admin，那么就有可能在username字段后面进行注入，从而在不知道密码的情况下进行登陆。</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;"><span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">payload</span>: admin)(&amp;))<br mpa-from-tpl="t"  /><span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">result</span>: (&amp;(username=admin)(&amp;))(password=<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">123</span>))</code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">LDAP服务器只会处理第一个过滤器，而第一个过滤器永真，因此绕过了登录框</span></p><p><span style="font-size:15px;line-height:35px;;"><strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">OR</strong>&nbsp;LDAP注入</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">当后端代码如下：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(|(parameter1=value1)(parameter2=value2))</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">一个典型的OR LDAP注入的场景就是：</span><br  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">假设一个资源管理器允许用户了解系统中可用的资源(打印机、扫描器、存储系统等)。用于展示可用资源的查询为：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(|(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=Rsc1)(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=Rsc2))</code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">Rsc1和Rsc2表示系统中不同种类的资源，例如，Rsc1=printer，Rsc2=scanner用于列出系统中所以可用的打印机和扫描器。</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">payload: Rsc1=printer)(uid=*)<br mpa-from-tpl="t"  />resul<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">t:</span>&nbsp;(|(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=printer)(uid=*))(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=scanner))</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">LD</span><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">AP服务器会响应所有的打印机和用户对象</span><br  /></p><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">LDAP盲注</span></p><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">LDAP&nbsp;AND盲注</span></p><p><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;">假设一个Web应用想从一个LDAP目录列出所有可用的Epson打印机，错误信息不会返回，应用发送如下的过滤器：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(objectclass=printer)(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=Epson*))</code></pre></section><p><span style="letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;font-size:15px;line-height:35px;;">使用这个查询，如果有可用的Epson打印机，其图标就会显示给客户端，否则没有图标出现。如果攻击者进行LDAP盲注入攻击</span><code style="letter-spacing: 0.544px;color: rgb(68, 68, 68);text-align: start;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">*)(objectClass=*))(&amp;(objectClass=void</span></code><span style="letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;font-size:15px;line-height:35px;;">，Web应用会构造如下查询：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(objectclass=*)(objectClass=*))(&amp;(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">type</span>=Epson*))</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.544px;text-align: start;">仅对第一个过滤器进行处理：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(objectclass=<span style="color: rgb(171, 178, 191);background: rgba(0, 0, 0, 0);display: inline;width: 105px;text-decoration: none solid rgb(171, 178, 191);font-weight: 400;font-style: italic;">*)(objectClass=*</span>))</code></pre></section><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">结果是，打印机的图标会一定显示出来，因为该查询永远会有结果，过滤器</span><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">objectClass=*总是返回一</span><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">个对象。</span><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">当图标被显示时响应为真，否则为假。</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">例如构造如下的注入：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(objectClass=*)(objectClass=users))(&amp;(objectClass=foo)(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=Epson*))<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />(&amp;(objectClass=*)(objectClass=resources))(&amp;(objectClass=foo)(<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">type</span>=Epson*))</code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">这种代码注入的设置允许攻击者推测可能存在于LDAP目录服务中不同对象类的值。</span><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">当响应Web页面至少包含一个打印机图标时，对象类的值就是存在的，另一方面而言，如果对象类的值不存在或没有对它的访问，就不会有图标出现。</span></p><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">LDAP&nbsp;</span><strong style="font-size:15px;line-height:35px;;font family: inherit;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;vertical-align: baseline;">OR盲注</strong><br  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">这种情况下，用于推测想要的信息的逻辑是相反的，因为使用的是OR逻辑操作符。接下来使用的是同一个例子，OR环境的注入为：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(|(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>))(&amp;(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">type</span>=Epson*))</code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">这个LDAP查询没有从LDAP目录服务获得任何对象，打印机的图标也不会显示给客户端(FALSE)。</span><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">如果在响应的Web页面中有任何图标，则响应为TRUE。</span><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">故攻击者可以注入下列LDAP过滤器来收集信息：</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(|(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(objectClass=users))(&amp;(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">type</span>=Epson*))<br mpa-from-tpl="t"  />(|(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(objectClass=resources))(&amp;(objectClass=<span style="color: rgb(230, 192, 123);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(230, 192, 123);font-weight: 400;font-style: normal;">void</span>)(<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">type</span>=Epson*))</code></pre></section><p><br  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-weight: bold;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;font-size:18px;line-height:38px;;">LDAP靶场</span></p><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">靶场截图</span></h2><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.6403861625100563" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/2_13ERmDjwsbB8k45DxZFCibRiboxaPA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjvjPqpDkarephfc6kEn81Azvrn013ERmDjwsbB8k45DxZFCibRiboxaPA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1243" style=""  /></p><p><span style="font-size:15px;line-height:35px;;color: rgb(57, 170, 86);font-weight: bold;text-align: start;letter-spacing: 0.544px;">下载地址</span></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;"><br mpa-from-tpl="t"  /></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">链接：http<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">s:</span>//pan.baidu.<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">com</span>/s/<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 7px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">1</span>x50hYn2Q4jIsLHbDnU3CVA<br mpa-from-tpl="t"  />提取码：<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">8</span>yej</code></pre></section><p><br mpa-from-tpl="t"  /></p><p><span style="font-size:15px;line-height:35px;;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;">此处以 LDAP attacks ==&gt; Example 2 为例</span><br  /></p><h2 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(57, 170, 86);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">利用过程</span></h2><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">使用</span><code style="padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">nmap</span></code><span style="font-size:15px;line-height:35px;;">扫描，发现开启</span><code style="padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">389</span></code><span style="font-size:15px;line-height:35px;;">端口</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;"><span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">C</span>:\Users\h&gt;nmap -Pn -p- -sV <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 47px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">192.168</span>.<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">30.144</span>&nbsp;-n -T4<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />Starting Nmap <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">7.70</span>&nbsp;( <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">https</span>:<span style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 297px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//nmap.org ) at 2019-08-05 15:29 ?D1ú±ê×?ê±??</span><br mpa-from-tpl="t"  />Nmap scan report for <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">192.168</span>.<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">30.144</span><br mpa-from-tpl="t"  />Host is up (<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">0.0034s</span>&nbsp;latency).<br mpa-from-tpl="t"  />Not <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">shown</span>: <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">65532</span>&nbsp;closed ports<br mpa-from-tpl="t"  />PORT STATE SERVICE VERSION<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">22</span>/tcp open ssh OpenSSH <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">5.5</span>p1 Debian <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 7px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">6</span>+squeeze3 (protocol <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">2.0</span>)<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">80</span>/tcp open http Apache httpd <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">2.2</span>.<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">16</span>&nbsp;((Debian))<br mpa-from-tpl="t"  /><span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">389</span>/tcp open ldap OpenLDAP <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">2.2</span>.X - <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">2.3</span>.X<br mpa-from-tpl="t"  />MAC <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">Address</span>: <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">00</span>:<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 7px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">0</span><span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 7px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">C</span>:<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">29</span>:<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">63</span>:<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">12</span>:<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">24</span>&nbsp;(VMware)<br mpa-from-tpl="t"  />Service <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">Info</span>: <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">OS</span>: Linux; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">CPE</span>: <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">cpe</span>:/<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">o</span>:<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">linux</span>:linux_kernel<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />Service detection performed. Please report any incorrect results at <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">https</span>:<span style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 132px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//nmap.org/submit/ .</span><br mpa-from-tpl="t"  />Nmap <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">done</span>: <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 7px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">1</span>&nbsp;IP address (<span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">1</span>&nbsp;host up) scanned in <span style="color: rgb(209, 154, 102);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(209, 154, 102);font-weight: 400;font-style: normal;">35.09</span>&nbsp;seconds</code></pre></section><p><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;">访问Example 2，使用burp抓包，提示认证成功</span><br  /></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.390625" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/3_5ic2qTOeASia6QtUeKEXr64fv5DJCg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tj9AQ4ibaE84Mj2Qp6kq7OOBPFWqic5ic2qTOeASia6QtUeKEXr64fv5DJCg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1280" style=""  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">根据第一步扫出来的 389 端口，再加上此处的登陆，猜测他的判定语句为</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(name=hacker)(passwd=hacker))</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">其中2个&nbsp;</span><code style="color: rgb(68, 68, 68);text-align: start;letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">hacker</span></code><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">&nbsp;为我们的可控制变量</span><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;"></span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;"></span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;"><strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;">一、无密码登录</strong><strong style="border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;font family: inherit;vertical-align: baseline;"></strong></span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">尝试构造（先正常闭合，然后再截断后面）</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(name=hacker))%00)(passwd=hacker))</code></pre></section><p><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">服务器在对这个条件判定时，只会执行</span><code style="color: rgb(68, 68, 68);text-align: start;letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">(&amp;(name=hacker))</span></code><span style="color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;letter-spacing: 0.544px;font-size:15px;line-height:35px;;">，永为真，即无密码直接登陆，密码随便输，效果如下：</span><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;color: rgb(68, 68, 68);font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;text-align: start;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.3203125" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/4_NgYDHBtl6666ybh7qp37vQOnHoVxNA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjmIfXJeTdyJjrHnb6CSnvktkjNgYDHBtl6666ybh7qp37vQOnHoVxNA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1280" style=""  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong style="font-size:15px;line-height:35px;;font family: inherit;letter-spacing: 0.544px;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-style: inherit;vertical-align: baseline;">二、用户遍历</strong></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">通过上方的结果，我们已经能无密码登陆用户了，但是如果该用户权限不足需要新的用户怎么办呢？</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">构造语句如下（其中，</span><code style="padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">*</span></code><span style="font-size:15px;line-height:35px;;">&nbsp;为通配符）</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;">(&amp;(name=h*))%00)(passwd=xxx))</code></pre></section><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.32265625" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/5_IZlqsk95NUZUXYABR1ibLrAiaNj8tA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjWlKKI912ia6cJA1363m0Y6jzx0qIZlqsk95NUZUXYABR1ibLrAiaNj8tA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1280" style=""  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;">如上图，构造的payload可直接登录</span><code style="letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">hacker</span></code><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;">账号</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;">尝试对首字母进行遍历，可成功获取&nbsp;</span><code style="letter-spacing: 0.544px;padding-right: 0.3em;padding-left: 0.3em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: inherit;font-style: inherit;font family: &quot;Source Code Pro&quot;, Consolas, Monaco, Menlo, Consolas, monospace;font-size: 12.6px;vertical-align: baseline;white-space: nowrap;background: rgba(208, 211, 248, 0.2);border-radius: 4px;"><span style="font-size:15px;line-height:35px;;">admin</span></code><span style="letter-spacing: 0.544px;font-size:15px;line-height:35px;;">&nbsp;账户</span><br  /></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.471875" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/6_EJibOwTyCYTur1IlrpdQzLYry5N8wQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjhpicPv5veNuQawdFJBNicZXv75UEJibOwTyCYTur1IlrpdQzLYry5N8wQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1280" style=""  /></p><h1 style="padding-top: 1em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font-weight: bold;vertical-align: baseline;line-height: 1em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP注入防御</span><br  /></h1><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">LDAP注入的防御和SQL注入的防御类似，主要是对用户的输入进行合法性验证,只要守好数据的入口和出口，就能有效的防御攻击。</span></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;">下图包含了LDAP中用到的特殊字符和需要转义处理的字符：</span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.4782608695652174" data-s="300,640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/7_a0SYbnqN1gy4GU3PQ87jnLicKRmuYw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8rQbJgJjYqbjKiakxD7a2tjLgOXt7rfp28sF9BKicOhQp8MnPa0SYbnqN1gy4GU3PQ87jnLicKRmuYw/640?wx_fmt=png'" data-type="png" data-w="644" style=""  /></p><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;letter-spacing: 0.544px;">具体实现可参考如下 PHP 代码</span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;"><span style="color: rgb(171, 178, 191);background: rgba(0, 0, 0, 0);display: inline;width: 231px;text-decoration: none solid rgb(171, 178, 191);font-weight: 400;font-style: normal;"><span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">function</span>&nbsp;<span style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 106px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;">ldapspecialchars</span><span style="color: rgb(171, 178, 191);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(171, 178, 191);font-weight: 400;font-style: normal;">($string)</span>&nbsp;</span>{<br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;$sanitized=<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">array</span>(<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 27px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\\'</span>&nbsp;=&gt; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\5c'</span>,<br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'*'</span>&nbsp;=&gt; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\2a'</span>,<br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'('</span>&nbsp;=&gt; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\28'</span>,<br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 20px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">')'</span>&nbsp;=&gt; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\29'</span>,<br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"\x00"</span>&nbsp;=&gt; <span style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'\00'</span>);<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 40px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">return</span>&nbsp;str_replace(array_keys($sanitized),array_values($sanitized),$string);<br mpa-from-tpl="t"  />}</code></pre></section><p style="margin-top: 1.6em;margin-bottom: 1.6em;border-width: 0px;border-style: initial;border-color: initial;outline: 0px;font family: Arial, &quot;open sans&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, sans-serif;font-size:14px;line-height:34px;;vertical-align: baseline;line-height: 1.6em;color: rgb(68, 68, 68);text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><strong style="font-size:17px;line-height:37px;;text-align: center;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;">参考文章</strong></p><p><span style="font-size:17px;line-height:37px;;"><strong><br  /></strong></span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;">LDAP 注入（Injection）入门学习</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;color: rgb(0, 128, 255);">http://zone.secevery.com/article/976</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;">LDAP安全 (LDAP注入与匿名访问)</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;color: rgb(0, 128, 255);">https://www.from0to1.me/index.php/archives/71/</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;">LDAP注入漏洞与防御</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;color: rgb(0, 128, 255);">https://www.jianshu.com/p/d94673be9ed0</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;">LDAP注入与防御剖析</span></p><p style="text-align: center;"><span style="font-size:14px;line-height:34px;;color: rgb(0, 128, 255);">https://wooyun.js.org/drops/LDAP%E6%B3%A8%E5%85%A5%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%89%96%E6%9E%90.html</span></p><p style="text-align: center;"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/8_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="white-space: normal;caret-color: rgb(167, 167, 167);letter-spacing: 0.544px;text-align: center;background-color: rgb(255, 255, 255);color: rgb(85, 85, 85);font family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:34px;;visibility: visible !important;width: 640px !important;"  /></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;color: rgb(0, 0, 0);">作者：</span><span style="font-size:12px;line-height:32px;;color: rgb(0, 0, 0);">damit5</span></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;color: rgb(0, 0, 0);">参考来源：</span><span style="font-size:12px;line-height:32px;;color: rgb(0, 0, 0);">damit5's&nbsp;blog</span></p><p style="text-align: right;"><span style="font-size:12px;line-height:32px;;color: rgb(0, 0, 0);"><br  /></span></p><pre style="letter-spacing: 0.544px;background: rgb(255, 255, 255);font family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:13px;line-height:33px;;white-space: nowrap;line-height: 1.42857;word-break: break-all;border-width: 0px;border-style: initial;border-color: initial;border-radius: 4px;"><p style="letter-spacing: 0.544px;white-space: normal;font family: -apple-system-font, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;text-align: right;"><span style="vertical-align: inherit;">本文由公众号HACK学习排版编辑整理</span></p></pre><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-01-10_LDAP注入入门学习指南/9_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /><br  /></p></section>
                </div>
</div>
</body>
</html>