<html>
<head>
<title>Chrome80.X版本如何解密Cookies文件</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
Chrome 80.X版本如何解密Cookies文件
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                                                                                                        <span role="link" id="js_author_name" class="rich_media_meta_link weui-wa-hotarea" datarewardsn="" datatimestamp="" datacanreward="0">HACK学习</span>
                                                                                                                                        </span>
                                                                
                                                                                                            <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-03-05</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><p data-mpa-powered-by="yiban.io">最近遇到了一个头疼的问题，就是Chrome在2月份更新了版本 80.0.3987.122（正式版本） （64 位）,以前写的抓取Cookies文件的脚本用不了，Chrome更新了加密算法，今天刚好解决了，分享出来大家一起交流学习下<br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X00&nbsp;抓取Cookies遇到问题</span></strong><br  /></p><p><br  /></p><p>新版本ChromeCookies加密原理：</p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">Windows上的Chrome Cookie（“ Cookies” SQLite文件的“ encrypted_value”）或密码（“ Login Data” SQLite文件的“ password_value”）的解密实现。不支持以“ v10”为前缀的那些和以“ v10”为前缀的那些。此存储库中的代码用JDK1.8编写，并在Windows 10 Professional 1903上针对Chrome 80.0.3987.106 x86 64位进行了测试。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">加密的cookie和密码存储在SQLite文件“ Cookies”和“登录数据”中，可在Chrome用户数据目录中找到。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">Chrome用户数据目录显示在</span></p><p><span style="font-size:15px;line-height:35px;;">https://chromium.googlesource.com/chromium/src/+/master/docs/user_data_dir.md中。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">https://github.com/n8henrie/pycookiecheat/issues/12是学习如何从keyring / keychain查找对称密钥以及在Linux和Mac中解密cookie的好地方。但是，pycookiecheat没有涵盖Windows平台中的有用信息。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">我们可以了解如何从Chromium源代码中加密Cookie值。</span></p><p><span style="font-size:15px;line-height:35px;;">我在http://www.meilongkui.com/archives/1904上写过中文文章。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">简而言之，根据Chrome的版本，有两种不同的加密方法：</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><ol style="" class="list-paddingleft-2"><li><p><span style="font-size:15px;line-height:35px;;">没有以“ v10”或“ v11”为前缀的加密值</span></p></li><li><p><span style="font-size:15px;line-height:35px;;">以“ v10”或“ v11”为前缀的加密值</span></p><p><br  /></p></li></ol><p><span style="font-size:15px;line-height:35px;;">如果加密的值未以“ v10”或“ v11”作为前缀，则使用Windows DPAPI（数据保护应用程序编程接口）对原始值进行加密。从理论上讲，数据保护API可以对任何类型的数据进行对称加密。实际上，它在Windows操作系统中的主要用途是使用用户或系统秘密作为熵的重要贡献来执行非对称私钥的对称加密。实际上，在这种情况下，Chrome只是直接使用DPAPI来获取加密的cookie值。</span></p><p style="margin-bottom: 16px;color: rgb(36, 41, 46);font family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;"><br  /></span></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X01&nbsp;查看新版与老版的Cookies加密值</span></strong><br  /></p><p style="text-align: center;"><br  /></p><p><br  /></p><p>使用Navicat查看下Chrome的Cookies文件</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="180" data-ratio="0.3111111111111111" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/1_XbDrOTlLj6NTY8MdNrs0YA85klzFSg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfNXBJIpMia6wOpnJOSwtBhp7NPXbDrOTlLj6NTY8MdNrs0YA85klzFSg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="900" style="width: 578px;height: 180px;"  /></p><p>Chrome80版本之前的Cookies的值的加密，前面没有V10以及V11<br  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.3359319631467045" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/2_Mh8tav7Yreib3zLPZavLpdY8MZgvAg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfJPxI76qTdaMGmZFA7iblRYdJ6NMh8tav7Yreib3zLPZavLpdY8MZgvAg/640?wx_fmt=png'" data-type="png" data-w="1411" style=""  /></p><p>Chrome80版本之后的Cookies的值的加密，前面有V10或者V11</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.40427280197206245" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/3_JYhCjgKLddA5kxsHKYfia9dR7ibiaQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfApZUzhSlHk2icokVl3ibEr4YlpDPrJYhCjgKLddA5kxsHKYfia9dR7ibiaQ/640?wx_fmt=png'" data-type="png" data-w="1217" style=""  /></p><p>区别在于多了V10和V11，也表明加密算法变了，用以前写的脚本就无法读取V10和V11里面的value了<br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X02 Chrome-80版本之前的的Cookies解密脚本</span></strong><br  /></p><p><br  /></p><p><span style="font-size:17px;line-height:37px;;color: rgb(255, 76, 65);"><strong>Python脚本</strong></span><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> os</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> sqlite3</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">from</span> collections <span style="color: rgb(167, 29, 93);">import</span> defaultdict</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">from</span> win32.win32crypt <span style="color: rgb(167, 29, 93);">import</span> <span style="color: rgb(0, 134, 179);">CryptUnprotectData</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(150, 152, 150);">#脚本使用的python3.6</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(150, 152, 150);">#pip install pywin32</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(24, 54, 145);">'''</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">实际使用场景请自行修改<span style="color: rgb(0, 134, 179);">Cookies</span>/cookies.sqlite位置，下面代码均为默认安装的位置，有些绿色版的文件夹位置以及老版本的渗透版火狐浏览器位置需要自行修改</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(24, 54, 145);">'''</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(150, 152, 150);">#获取chrome浏览器的cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> getcookiefromchrome():</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cookiepath=os.environ[<span style="color: rgb(24, 54, 145);">'LOCALAPPDATA'</span>]+r<span style="color: rgb(24, 54, 145);">"\Google\Chrome\User Data\Default\Cookies"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    sql=<span style="color: rgb(24, 54, 145);">"select host_key,name,encrypted_value from cookies"</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">with</span> sqlite3.connect(cookiepath) <span style="color: rgb(167, 29, 93);">as</span> conn:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cu=conn.cursor()        </span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        select_cookie = (cu.execute(sql).fetchall())</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cookie_list = []</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">for</span> host_key,name,encrypted_value <span style="color: rgb(167, 29, 93);">in</span> select_cookie:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            cookie = <span style="color: rgb(0, 134, 179);">CryptUnprotectData</span>(encrypted_value)[<span style="color: rgb(0, 134, 179);">1</span>].decode()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            cookies = {host_key:name+<span style="color: rgb(24, 54, 145);">":"</span>+cookie}</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            cookie_list.append(cookies)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        d = defaultdict(list)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">for</span> cookie_item <span style="color: rgb(167, 29, 93);">in</span> cookie_list:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">for</span> key,value <span style="color: rgb(167, 29, 93);">in</span> cookie_item.items():</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                d[key].append(value.strip())</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">print</span> (dict(d))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">getcookiefromchrome()</span></code></pre></section><p><span style="display: none;line-height: 0px;">‍</span></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X03&nbsp;其他浏览器的Cookies文件保存位置</span></strong><br  /></p><p><br  /></p><p>其他浏览器的Cookies位置，均可使用上述脚本来进行抓取<br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">IE浏览器<span style="color: rgb(0, 134, 179);">Cookie</span>数据位于：%APPDATA%\Microsoft\Windows\Cookies\ 目录中的xxx.txt文件 （里面可能有很多个.txt <span style="color: rgb(0, 134, 179);">Cookie</span>文件）</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">如：C:\Users\yren9\AppData\Roaming\Microsoft\Windows\Cookies\0WQ6YROK.txt</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">在IE浏览器中，IE将各个站点的<span style="color: rgb(0, 134, 179);">Cookie</span>分别保存为一个XXX.txt这样的纯文本文件（文件个数可能很多，但文件大小都较小）；而<span style="color: rgb(0, 134, 179);">Firefox</span>和<span style="color: rgb(0, 134, 179);">Chrome</span>是将所有的<span style="color: rgb(0, 134, 179);">Cookie</span>都保存在一个文件中（文件大小较大），该文件的格式为<span style="color: rgb(0, 134, 179);">SQLite3</span>数据库格式的文件。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Firefox</span>的<span style="color: rgb(0, 134, 179);">Cookie</span>数据位于：%APPDATA%\Mozilla\Firefox\Profiles\ 目录中的xxx.<span style="color: rgb(167, 29, 93);">default</span>目录，名为cookies.sqlite的文件。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">如：C:\Users\jay\AppData\Roaming\Mozilla\Firefox\Profiles\ji4grfex.<span style="color: rgb(167, 29, 93);">default</span>\cookies.sqlite</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">在<span style="color: rgb(0, 134, 179);">Firefox</span>中查看cookie, 可以选择”工具 &gt; 选项 &gt;” “隐私 &gt; 显示cookie”。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Firefox</span>的<span style="color: rgb(0, 134, 179);">Cookie</span>数据位于：%APPDATA%\Mozilla\Firefox\Profiles\ 目录中的xxx.<span style="color: rgb(167, 29, 93);">default</span>目录，名为cookies.sqlite的文件。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">如：C:\Users\jay\AppData\Roaming\Mozilla\Firefox\Profiles\*.<span style="color: rgb(167, 29, 93);">default</span>-release\cookies.sqlite</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Chrome</span>的<span style="color: rgb(0, 134, 179);">Cookie</span>数据位于：%LOCALAPPDATA%\Google\Chrome\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\ 目录中，名为<span style="color: rgb(0, 134, 179);">Cookies</span>的文件。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">如：C:\Users\jay\AppData\Local\Google\Chrome\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Local\Google\Chrome\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">在<span style="color: rgb(0, 134, 179);">Linux</span>系统上（以<span style="color: rgb(0, 134, 179);">Ubuntu</span> <span style="color: rgb(0, 134, 179);">12.04</span> 和 RHEL6.x 为例）浏览器的<span style="color: rgb(0, 134, 179);">Cookie</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">Firefox</span>的<span style="color: rgb(0, 134, 179);">Cookie</span>路径为：$HOME/.mozilla/firefox/xxxx.<span style="color: rgb(167, 29, 93);">default</span>/目录下的cookie.sqlite文件。</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">寰宇浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Local\ ====   %LOCALAPPDATA%</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%LOCALAPPDATA%\QupZilla\profiles\default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">QQ浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Local\Tencent\Q<span style="color: rgb(0, 134, 179);">QBrowser</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%LOCALAPPDATA%\Tencent\Q<span style="color: rgb(0, 134, 179);">QBrowser</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">360</span>安全浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Roaming\3<span style="color: rgb(0, 134, 179);">60se6</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%APPDATA%\3<span style="color: rgb(0, 134, 179);">60se6</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">360</span>极速浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Local\3<span style="color: rgb(0, 134, 179);">60Chrome</span>\Chrome\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%LOCALAPPDATA%\3<span style="color: rgb(0, 134, 179);">60Chrome</span>\Chrome\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">搜狗浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Roaming\SogouExplorer\Webkit\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%APPDATA%\SogouExplorer\Webkit\Default\Cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">2345</span>浏览器：</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">C:\Users\Andy\AppData\Local\2<span style="color: rgb(0, 134, 179);">345Explorer</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">%LOCALAPPDATA%\2<span style="color: rgb(0, 134, 179);">345Explorer</span>\User <span style="color: rgb(0, 134, 179);">Data</span>\Default\CookiesV3</span></code></pre></section><p><br  /></p><p><br  /></p><p>如果是Chrome80后的版本运行效果：<br  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.21963394342762063" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/4_KfFJztKDmtCkDfZk2IdWSo9663NNEA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAf9HzMBx633UvdQhxEECv9vhtIKfFJztKDmtCkDfZk2IdWSo9663NNEA/640?wx_fmt=png'" data-type="png" data-w="601" style=""  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X04&nbsp;<strong style="text-align: center;white-space: normal;"><span style="color: rgb(255, 76, 65);">Chrome-80版本之后的的Cookies解密脚本</span></strong></span></strong><br  /></p><p><br  /></p><p><br  /></p><p>Python代码截图：<br  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.10062893081761007" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/5_clCBSazTYAVESiaDFEIvHVGmE4oolg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAf9JCHNdO9WkcJTp0tnrFDd7IF7clCBSazTYAVESiaDFEIvHVGmE4oolg/640?wx_fmt=png'" data-type="png" data-w="636" style=""  /></p><p><br  /></p><p>demo.py</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> chrome_cookie <span class="code-snippet__keyword">import</span> ChromeCookieJar</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">if</span> __name__==<span class="code-snippet__string">'__main__'</span>:</span></code><code><span class="code-snippet_outer">    jar = ChromeCookieJar()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    jar.load()</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">for</span> cookie <span class="code-snippet__keyword">in</span> jar:</span></code><code><span class="code-snippet_outer">        print(vars(cookie))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><p>aesgcm.py<br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer">import os</span></code><code><span class="code-snippet_outer">import sys</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">from cryptography.hazmat.backends import default_backend</span></code><code><span class="code-snippet_outer">from cryptography.hazmat.primitives.ciphers import (</span></code><code><span class="code-snippet_outer">    Cipher, algorithms, modes</span></code><code><span class="code-snippet_outer">)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">NONCE_BYTE_SIZE = 12</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">def encrypt(cipher, plaintext, nonce):</span></code><code><span class="code-snippet_outer">    cipher.mode = modes.GCM(nonce)</span></code><code><span class="code-snippet_outer">    encryptor = cipher.encryptor()</span></code><code><span class="code-snippet_outer">    ciphertext = encryptor.update(plaintext)</span></code><code><span class="code-snippet_outer">    return (cipher, ciphertext, nonce)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">def decrypt(cipher, ciphertext, nonce):</span></code><code><span class="code-snippet_outer">    cipher.mode = modes.GCM(nonce)</span></code><code><span class="code-snippet_outer">    decryptor = cipher.decryptor()</span></code><code><span class="code-snippet_outer">    return decryptor.update(ciphertext)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">def get_cipher(key):</span></code><code><span class="code-snippet_outer">    cipher = Cipher(</span></code><code><span class="code-snippet_outer">        algorithms.AES(key),</span></code><code><span class="code-snippet_outer">        None,</span></code><code><span class="code-snippet_outer">        backend=default_backend()</span></code><code><span class="code-snippet_outer">    )</span></code><code><span class="code-snippet_outer">    return cipher</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;text-align: left;font-size:14px;line-height:34px;;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code></pre></section><p>chrome_cookie.py</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> os</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> sys</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> sqlite3</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> http.cookiejar <span style="color: rgb(167, 29, 93);">as</span> cookiejar</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">from</span> urllib.parse <span style="color: rgb(167, 29, 93);">import</span> urlencode</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> json, base64</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">import</span> aesgcm</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">sql = <span style="color: rgb(24, 54, 145);">"""</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">SELECT</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    host_key, name, path,encrypted_value <span style="color: rgb(167, 29, 93);">as</span> value</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">FROM</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cookies</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer" style="color: rgb(24, 54, 145);">"""</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> dpapi_decrypt(encrypted):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">import</span> ctypes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">import</span> ctypes.wintypes</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">class</span> DATA_BLOB(ctypes.<span style="color: rgb(0, 134, 179);">Structure</span>):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        _fields_ = [(<span style="color: rgb(24, 54, 145);">'cbData'</span>, ctypes.wintypes.DWORD),</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    (<span style="color: rgb(24, 54, 145);">'pbData'</span>, ctypes.POINTER(ctypes.c_char))]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    p = ctypes.create_string_buffer(encrypted, len(encrypted))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    blobin = DATA_BLOB(ctypes.<span style="color: rgb(167, 29, 93);">sizeof</span>(p), p)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    blobout = DATA_BLOB()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    retval = ctypes.windll.crypt32.<span style="color: rgb(0, 134, 179);">CryptUnprotectData</span>(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        ctypes.byref(blobin), <span style="color: rgb(167, 29, 93);">None</span>, <span style="color: rgb(167, 29, 93);">None</span>, <span style="color: rgb(167, 29, 93);">None</span>, <span style="color: rgb(167, 29, 93);">None</span>, <span style="color: rgb(0, 134, 179);">0</span>, ctypes.byref(blobout))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> <span style="color: rgb(167, 29, 93);">not</span> retval:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">raise</span> ctypes.<span style="color: rgb(0, 134, 179);">WinError</span>()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    result = ctypes.string_at(blobout.pbData, blobout.cbData)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    ctypes.windll.kernel32.<span style="color: rgb(0, 134, 179);">LocalFree</span>(blobout.pbData)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">return</span> result</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> unix_decrypt(encrypted):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> sys.platform.startswith(<span style="color: rgb(24, 54, 145);">'linux'</span>):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        password = <span style="color: rgb(24, 54, 145);">'peanuts'</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        iterations = <span style="color: rgb(0, 134, 179);">1</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">else</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">raise</span> <span style="color: rgb(0, 134, 179);">NotImplementedError</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">from</span> <span style="color: rgb(0, 134, 179);">Crypto</span>.<span style="color: rgb(0, 134, 179);">Cipher</span> <span style="color: rgb(167, 29, 93);">import</span> AES</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">from</span> <span style="color: rgb(0, 134, 179);">Crypto</span>.<span style="color: rgb(0, 134, 179);">Protocol</span>.KDF <span style="color: rgb(167, 29, 93);">import</span> PBKDF2</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    salt = <span style="color: rgb(24, 54, 145);">'saltysalt'</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    iv = <span style="color: rgb(24, 54, 145);">' '</span> * <span style="color: rgb(0, 134, 179);">16</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    length = <span style="color: rgb(0, 134, 179);">16</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    key = PBKDF2(password, salt, length, iterations)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cipher = AES.<span style="color: rgb(167, 29, 93);">new</span>(key, AES.MODE_CBC, IV=iv)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    decrypted = cipher.decrypt(encrypted[<span style="color: rgb(0, 134, 179);">3</span>:])</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">return</span> decrypted[:-ord(decrypted[-<span style="color: rgb(0, 134, 179);">1</span>])]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> get_key_from_local_state():</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    jsn = <span style="color: rgb(167, 29, 93);">None</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">with</span> open(os.path.join(os.environ[<span style="color: rgb(24, 54, 145);">'LOCALAPPDATA'</span>],</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        r<span style="color: rgb(24, 54, 145);">"Google\Chrome\User Data\Local State"</span>),encoding=<span style="color: rgb(24, 54, 145);">'utf-8'</span>,mode =<span style="color: rgb(24, 54, 145);">"r"</span>) <span style="color: rgb(167, 29, 93);">as</span> f:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        jsn = json.loads(str(f.readline()))</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">return</span> jsn[<span style="color: rgb(24, 54, 145);">"os_crypt"</span>][<span style="color: rgb(24, 54, 145);">"encrypted_key"</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> aes_decrypt(encrypted_txt):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    encoded_key = get_key_from_local_state()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    encrypted_key = base64.b64decode(encoded_key.encode())</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    encrypted_key = encrypted_key[<span style="color: rgb(0, 134, 179);">5</span>:]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    key = dpapi_decrypt(encrypted_key)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    nonce = encrypted_txt[<span style="color: rgb(0, 134, 179);">3</span>:<span style="color: rgb(0, 134, 179);">15</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    cipher = aesgcm.get_cipher(key)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">return</span> aesgcm.decrypt(cipher,encrypted_txt[<span style="color: rgb(0, 134, 179);">15</span>:],nonce)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> chrome_decrypt(encrypted_txt):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> sys.platform == <span style="color: rgb(24, 54, 145);">'win32'</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">try</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> encrypted_txt[:<span style="color: rgb(0, 134, 179);">4</span>] == b<span style="color: rgb(24, 54, 145);">'\x01\x00\x00\x00'</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                decrypted_txt = dpapi_decrypt(encrypted_txt)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">return</span> decrypted_txt.decode()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">elif</span> encrypted_txt[:<span style="color: rgb(0, 134, 179);">3</span>] == b<span style="color: rgb(24, 54, 145);">'v10'</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                decrypted_txt = aes_decrypt(encrypted_txt)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">return</span> decrypted_txt[:-<span style="color: rgb(0, 134, 179);">16</span>].decode()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">except</span> <span style="color: rgb(0, 134, 179);">WindowsError</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> <span style="color: rgb(167, 29, 93);">None</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">else</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">try</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> unix_decrypt(encrypted_txt)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">except</span> <span style="color: rgb(0, 134, 179);">NotImplementedError</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">return</span> <span style="color: rgb(167, 29, 93);">None</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">def</span> to_epoch(chrome_ts):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">if</span> chrome_ts:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">return</span> chrome_ts - <span style="color: rgb(0, 134, 179);">11644473600</span> * <span style="color: rgb(0, 134, 179);">000</span> * <span style="color: rgb(0, 134, 179);">1000</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">else</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">return</span> <span style="color: rgb(167, 29, 93);">None</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">class</span> <span style="color: rgb(0, 134, 179);">ChromeCookieJar</span>(cookiejar.<span style="color: rgb(0, 134, 179);">FileCookieJar</span>):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">def</span> __init__(<span style="color: rgb(167, 29, 93);">self</span>, filename=<span style="color: rgb(167, 29, 93);">None</span>, delayload=<span style="color: rgb(167, 29, 93);">False</span>, policy=<span style="color: rgb(167, 29, 93);">None</span>):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">if</span> filename <span style="color: rgb(167, 29, 93);">is</span> <span style="color: rgb(167, 29, 93);">None</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> sys.platform == <span style="color: rgb(24, 54, 145);">'win32'</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                filename = os.path.join(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    os.environ[<span style="color: rgb(24, 54, 145);">'USERPROFILE'</span>],</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    r<span style="color: rgb(24, 54, 145);">'AppData\Local\Google\Chrome\User Data\default\Cookies'</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(24, 54, 145);">'''</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(0, 134, 179);">AppData</span>\\<span style="color: rgb(0, 134, 179);">Local</span>\\<span style="color: rgb(0, 134, 179);">Google</span>\\<span style="color: rgb(0, 134, 179);">Chrome</span>\\<span style="color: rgb(0, 134, 179);">User</span> <span style="color: rgb(0, 134, 179);">Data</span>\\<span style="color: rgb(0, 134, 179);">Profile</span> [n]\\<span style="color: rgb(0, 134, 179);">Cookies</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(24, 54, 145);">'''</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">elif</span> sys.platform.startswith(<span style="color: rgb(24, 54, 145);">'linux'</span>):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                filename = os.path.expanduser(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    <span style="color: rgb(24, 54, 145);">'~/.config/google-chrome/Default/Cookies'</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">if</span> <span style="color: rgb(167, 29, 93);">not</span> os.path.exists(filename):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                    filename = os.path.expanduser(</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                        <span style="color: rgb(24, 54, 145);">'~/.config/chromium/Default/Cookies'</span>)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> <span style="color: rgb(167, 29, 93);">not</span> os.path.exists(filename):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                filename = <span style="color: rgb(167, 29, 93);">None</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cookiejar.<span style="color: rgb(0, 134, 179);">FileCookieJar</span>.__init__(<span style="color: rgb(167, 29, 93);">self</span>, filename, delayload, policy)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><br  /></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">    <span style="color: rgb(167, 29, 93);">def</span> _really_load(<span style="color: rgb(167, 29, 93);">self</span>, f, filename, ignore_discard, ignore_expires):</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        con = sqlite3.connect(filename)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        con.row_factory = sqlite3.<span style="color: rgb(0, 134, 179);">Row</span></span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        con.create_function(<span style="color: rgb(24, 54, 145);">'decrypt'</span>, <span style="color: rgb(0, 134, 179);">1</span>, chrome_decrypt)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        con.create_function(<span style="color: rgb(24, 54, 145);">'to_epoch'</span>, <span style="color: rgb(0, 134, 179);">1</span>, to_epoch)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cur = con.cursor()</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cur.execute(sql)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        <span style="color: rgb(167, 29, 93);">for</span> row <span style="color: rgb(167, 29, 93);">in</span> cur:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">            <span style="color: rgb(167, 29, 93);">if</span> row[<span style="color: rgb(24, 54, 145);">'value'</span>] <span style="color: rgb(167, 29, 93);">is</span> <span style="color: rgb(167, 29, 93);">not</span> <span style="color: rgb(167, 29, 93);">None</span>:</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                name = row[<span style="color: rgb(24, 54, 145);">'name'</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                value = chrome_decrypt(row[<span style="color: rgb(24, 54, 145);">'value'</span>])</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                host = row[<span style="color: rgb(24, 54, 145);">'host_key'</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                path = row[<span style="color: rgb(24, 54, 145);">'path'</span>]</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">                <span style="color: rgb(167, 29, 93);">print</span>(<span style="color: rgb(24, 54, 145);">"host:"</span>+host + <span style="color: rgb(24, 54, 145);">" path:"</span> +path + <span style="color: rgb(24, 54, 145);">" name:"</span>+ name+<span style="color: rgb(24, 54, 145);">" value:"</span>+value)</span></code><code style="font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;white-space: pre;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer">        cur.close()</span></code></pre></section><p>使用前需要安装：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">pip</span> install cryptography</span></code></pre></section><p>如何使用：</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.17922606924643583" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/6_xzib8NLciaYslCcu9icrhp5leJ8r0g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfDjiaBux1LbPEfWKroHkbp8MqUCGCxzib8NLciaYslCcu9icrhp5leJ8r0g/640?wx_fmt=png'" data-type="png" data-w="982" style=""  /></p><p>需要将这三个文件放在一个目录下，然后运行demo.py</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5994423791821561" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/7_VYjq4GYWEQKyOjGELQzER4mv0GZ9lg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfmCV8ZLUhVgKlh5CZg4MwL1OOVYjq4GYWEQKyOjGELQzER4mv0GZ9lg/640?wx_fmt=png'" data-type="png" data-w="1076" style=""  /></p><p><br  /></p><p><strong>如何打包成exe</strong></p><p><strong><br  /></strong></p><p>先安装</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">pip</span> install pyinstaller</span></code></pre></section><p>打包多文件</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="json"><code><span class="code-snippet_outer">[pyinstaller [主文件] -p [其他文件<span class="code-snippet__number">1</span>] -p [其他文件<span class="code-snippet__number">2</span>] --hidden-import [自建模块<span class="code-snippet__number">1</span>] --hidden-import [自建模块<span class="code-snippet__number">2</span>]</span></code></pre></section><p><br  /></p><p>pyinstaller.exe -F -w demo.py -p aesgcm.py -p chrome_cookie.py</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.057997557997558" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/8_a8oVf50Z34STt4CLgSQ7dG8RNF6AnA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfJ3rib6MjvZFtfdm76QP7JszgTia8oVf50Z34STt4CLgSQ7dG8RNF6AnA/640?wx_fmt=png'" data-type="png" data-w="1638" style=""  /></p><p style="text-align: left;">打包完毕</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.2598116169544741" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/9_xjCT2lwv55c3VCEOicAkXSrEYhImjQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAficYp4V2mI6lja8DISzClHUR4YpxjCT2lwv55c3VCEOicAkXSrEYhImjQ/640?wx_fmt=png'" data-type="png" data-w="1274" style="text-align: center;white-space: normal;"  /></p><p style="text-align: left;">打包完的exe位置在dist目录下</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.3621460506706408" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/10_4mbpd75vicsyajbYlPpvasY8EMfoWw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfyIC7ZicaRRIkQw9pVIzc9UZ66L4mbpd75vicsyajbYlPpvasY8EMfoWw/640?wx_fmt=png'" data-type="png" data-w="671" style=""  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.14563106796116504" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/11_8759xghSD4onmC1qITTsCBbia7NLmA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfskBJbNGZUUqaBguhtdax7v19v8759xghSD4onmC1qITTsCBbia7NLmA/640?wx_fmt=png'" data-type="png" data-w="618" style=""  /></p><p>打包完的exe运行效果</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">demo</span><span class="code-snippet__selector-class">.exe</span> &gt; 1<span class="code-snippet__selector-class">.txt</span></span></code></pre></section><p>将cookie信息打到1.txt文件中</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.07477477477477477" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/12_c6Isk9ffb4Xt3Yro9YBSqALZ1Picpw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfSia66gQGgAaved8UVyJDGiaI0KBic6Isk9ffb4Xt3Yro9YBSqALZ1Picpw/640?wx_fmt=png'" data-type="png" data-w="1110" style=""  /></p><p>运行结果：<br  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.15605095541401273" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/13_ntFSUINiaUic15iaLG841UzoA2UNMQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAfDEpHSMMIlfk2H3c7b1zu2dgibF2GntFSUINiaUic15iaLG841UzoA2UNMQ/640?wx_fmt=png'" data-type="png" data-w="628" style=""  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.39528432732316227" data-s="300,640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/14_iciafRbbQqjSPu9g1FBKwO6NiarQJQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9zyKlXR9mUvpmUezpHUdAf2VpATia6icZ4xu1cEO9iaebM0PWyX8iciafRbbQqjSPu9g1FBKwO6NiarQJQ/640?wx_fmt=png'" data-type="png" data-w="1442" style=""  /></p><p><br  /></p><p><br  /></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">0X05 实战应用场景</span></strong></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);"><br  /></span></strong></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);">当控制了一台目标机器，但是后台需要手机验证码，谷歌验证器或者需要多因素验证才能登录，恰好你的目标刚好是浏览器登录在网站中，cookie还是有效的，这时候就可以去抓取目标的电脑浏览器的Cookies，解密，然后替换Cookie进入</span></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);">你可以抓取目标机器的浏览器Cookies，然后你这边做socks代理，从而替换Cookie的方式登录后台<br  /></span></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);">还能避免是单点登录的情况下，把目标挤下去，引起目标怀疑</span></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);"><br  /></span></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);">利用场景很多，看你的思路和实际渗透需求去做即可</span></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);"><br  /></span></strong></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/15_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);width: 640px !important;visibility: visible !important;"  /></span></strong></p><p style="text-align: center;"><strong><span style="color: rgb(255, 76, 65);">点赞，转发，再看</span></strong></p><p style="text-align: center;"><br  /></p><p style="text-align: center;">文章中代码下载地址：</p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);font-size:13px;line-height:33px;;">链接：https://pan.baidu.com/s/1Ur-jcqZ2xXpuUutxLpJewQ&nbsp;</span></p><p style="text-align: center;"><span style="color: rgb(0, 0, 0);font-size:13px;line-height:33px;;">提取码：blty</span></p><p style="text-align: center;"><br  /></p><p style="text-align: center;">压缩包解压密码是：hacker1961</p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-03-05_Chrome80.X版本如何解密Cookies文件/16_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>