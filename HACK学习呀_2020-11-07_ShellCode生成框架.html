<html>
<head>
<title>ShellCode生成框架</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
ShellCode生成框架
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    一寸一叶
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-11-07</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><p data-mpa-powered-by="yiban.io"></p><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">这里先写个简单的静态加载到exe文件中，明天再来写个动态的</p><p style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;"><br  /></p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">因为vs编译后自己会生成很多东西，我们稍微配置下</span><p></p><figure style="margin-right: 8px;margin-bottom: 1.5em;margin-left: 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/1_ECpKuZU3cbiaKIc0vv06lr4OgDwibQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodC2bXiao3vycHORwxC6Mnw07uUo6VECpKuZU3cbiaKIc0vv06lr4OgDwibQ/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.5" data-w="640"  /></figure><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/2_clK981cSQGtzXcXwoMtGVm8wfzy8Gg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCibIEMicvONOpNVJN2iccIZLrNGwiclK981cSQGtzXcXwoMtGVm8wfzy8Gg/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.4875" data-w="640"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">先获取kernel32基址</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">__declspec</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">naked</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);"> DWORD getKernel32</span><span style="color: rgb(51, 51, 51);">()</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  __asm</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> fs</span><span style="color: rgb(51, 51, 51);">:[</span><span style="color: rgb(0, 134, 179);">30h</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//PEB</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">eax </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0ch</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//PEB-&gt;Ldr</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">eax </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">14h</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//PEB-&gt;Ldr.InMemOrder</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">eax</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//第二个模块</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">eax</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//第三个模块</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      mov eax</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">eax </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">10h</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//base address</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      ret</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">获取GetProcAddress函数地址</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">FARPROC  getProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">HMODULE hModuleBase</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PIMAGE_DOS_HEADER lpDosHeader </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_DOS_HEADER</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PIMAGE_NT_HEADERS32 lpNtHeader </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_NT_HEADERS32</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> lpDosHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(51, 51, 51);">e_lfanew</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(!</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">Size</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(!</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">VirtualAddress</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PIMAGE_EXPORT_DIRECTORY lpExports </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_EXPORT_DIRECTORY</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">VirtualAddress</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PDWORD lpdwFunName </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PDWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfNames</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PWORD lpwOrd </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfNameOrdinals</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PDWORD lpdwFunAddr </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PDWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfFunctions</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  DWORD dwLoop </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FARPROC pRet </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">for</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(;</span><span style="color: rgb(51, 51, 51);"> dwLoop </span><span style="color: rgb(51, 51, 51);">&lt;=</span><span style="color: rgb(51, 51, 51);"> lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">NumberOfNames</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">-</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">1</span><span style="color: rgb(51, 51, 51);">;</span><span style="color: rgb(51, 51, 51);"> dwLoop</span><span style="color: rgb(51, 51, 51);">++)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> pFunName </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);">*)(</span><span style="color: rgb(51, 51, 51);">lpdwFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">dwLoop</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'G'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">1</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">2</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">3</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'P'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">4</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">5</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">6</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'c'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">7</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">8</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">9</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">10</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">11</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">12</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">13</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pRet </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FARPROC</span><span style="color: rgb(51, 51, 51);">)(</span><span style="color: rgb(51, 51, 51);">lpdwFunAddr</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">lpwOrd</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">dwLoop</span><span style="color: rgb(51, 51, 51);">]]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      </span><span style="color: rgb(167, 29, 93);">break</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> pRet</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">首先定义ms-dos头</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">PIMAGE_DOS_HEADER lpDosHeader </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_DOS_HEADER</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">;</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后得到pe头image-nt-header</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">PIMAGE_NT_HEADERS32 lpNtHeader </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_NT_HEADERS32</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> lpDosHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(51, 51, 51);">e_lfanew</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">直接dos头加e_lfanew，这里因为是c++代码就不用汇编写入偏移地址3c等等，后面也要贴上汇编代码，结合一起看其实也不难理解</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(!</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">Size</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(!</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">VirtualAddress</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code></pre></section><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">这里还是贴上这个图(转载的图)</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/3_Gm68zEJ00uMuhV2y5n1wjSZjmGLwuQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCvH9iaayR29chReeJib9ntDibAzeGm68zEJ00uMuhV2y5n1wjSZjmGLwuQ/640?wx_fmt=png'" data-type="png" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="1.248780487804878" data-w="615"  /></figure><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/4_mKsdOeaZOa6rUdAJNic9ia5iads8Gw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodC3LAEwxyPGjKV2sxBHeIuJegRtV2mKsdOeaZOa6rUdAJNic9ia5iads8Gw/640?wx_fmt=png'" data-type="png" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.65" data-w="600"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">在pe-option-header里面存在一个size和virualaddress，我们还是主要看 VirtualAddress（相对虚拟地址）字段，我们得到这个结构体</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">PIMAGE_EXPORT_DIRECTORY lpExports </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PIMAGE_EXPORT_DIRECTORY</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpNtHeader</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">OptionalHeader</span><span style="color: rgb(51, 51, 51);">.</span><span style="color: rgb(0, 134, 179);">DataDirectory</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">IMAGE_DIRECTORY_ENTRY_EXPORT</span><span style="color: rgb(51, 51, 51);">].</span><span style="color: rgb(0, 134, 179);">VirtualAddress</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">我们将会使用这个结构的如下字段：</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">AddressOfFunctions：指向一个DWORD类型的数组，每个数组元素指向一个函数地址。AddressOfNames：指向一个DWORD类型的数组，每个数组元素指向一个函数名称的字符串。AddressOfNameOrdinals：指向一个WORD类型的数组，每个数组元素表示相应函数的排列序号（16位整数）</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">PDWORD lpdwFunName </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PDWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfNames</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PWORD lpwOrd </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfNameOrdinals</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  PDWORD lpdwFunAddr </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">PDWORD</span><span style="color: rgb(51, 51, 51);">)((</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">AddressOfFunctions</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后判断是否为GetProcAddress函数是就返回</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);"> DWORD dwLoop </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FARPROC pRet </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">for</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(;</span><span style="color: rgb(51, 51, 51);"> dwLoop </span><span style="color: rgb(51, 51, 51);">&lt;=</span><span style="color: rgb(51, 51, 51);"> lpExports</span><span style="color: rgb(51, 51, 51);">-&gt;</span><span style="color: rgb(0, 134, 179);">NumberOfNames</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">-</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">1</span><span style="color: rgb(51, 51, 51);">;</span><span style="color: rgb(51, 51, 51);"> dwLoop</span><span style="color: rgb(51, 51, 51);">++)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> pFunName </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);">*)(</span><span style="color: rgb(51, 51, 51);">lpdwFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">dwLoop</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">if</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'G'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">1</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">2</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">3</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'P'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">4</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">5</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">6</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'c'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">7</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">8</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">9</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">10</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">11</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">12</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">&amp;&amp;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pFunName</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(0, 134, 179);">13</span><span style="color: rgb(51, 51, 51);">]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">==</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">)</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">{</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      pRet </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FARPROC</span><span style="color: rgb(51, 51, 51);">)(</span><span style="color: rgb(51, 51, 51);">lpdwFunAddr</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">lpwOrd</span><span style="color: rgb(51, 51, 51);">[</span><span style="color: rgb(51, 51, 51);">dwLoop</span><span style="color: rgb(51, 51, 51);">]]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">+</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">DWORD</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">hModuleBase</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">      </span><span style="color: rgb(167, 29, 93);">break</span><span style="color: rgb(51, 51, 51);">;</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(51, 51, 51);">}</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">return</span><span style="color: rgb(51, 51, 51);"> pRet</span><span style="color: rgb(51, 51, 51);">;</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里用到了导出表里面得一个single每次查找一次就+1这里返回回去就是-1然后逐一进行判断</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">头部再定义一下</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">DWORD getKernel32</span><span style="color: rgb(51, 51, 51);">();</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">FARPROC  getProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">HMODULE hModuleBase</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里kernel32.dll和GetProcess函数地址都得到了后面就好说了</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里我们举CreateFile和Messagebox例子</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里是原来应该得写法</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(150, 152, 150);">//some code……</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> HANDLE</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI </span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);">FN_CreateFileA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpFileName</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwDesiredAccess</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwShareMode</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPSECURITY_ATTRIBUTES lpSecurityAttributes</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwCreationDisposition</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwFlagsAndAttributes</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> HANDLE hTemplateFile</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_CreateFileA fn_CreateFileA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_CreateFileA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(0, 134, 179);">GetProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(0, 134, 179);">LoadLibraryA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(24, 54, 145);">"kernel32.dll"</span><span style="color: rgb(51, 51, 51);">),</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">"CreateFileA"</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">我们先处理LoadLibraryA("kernel32.dll")</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">先得到GetProcAddress</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> FARPROC</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI </span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_GetProcAddress</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> HMODULE hModule</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpProcName</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_GetProcAddress fn_GetProcAddress </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_GetProcAddress</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getProcAddress</span><span style="color: rgb(51, 51, 51);">((</span><span style="color: rgb(51, 51, 51);">HMODULE</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getKernel32</span><span style="color: rgb(51, 51, 51);">());</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后把"CreateFileA"字符串替换了</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szCreateFile</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'C'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'F'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里完整为</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> FARPROC</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI </span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_GetProcAddress</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> HMODULE hModule</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpProcName</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_GetProcAddress fn_GetProcAddress </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_GetProcAddress</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getProcAddress</span><span style="color: rgb(51, 51, 51);">((</span><span style="color: rgb(51, 51, 51);">HMODULE</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getKernel32</span><span style="color: rgb(51, 51, 51);">());</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> HANDLE</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI </span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);">FN_CreateFileA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpFileName</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwDesiredAccess</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwShareMode</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPSECURITY_ATTRIBUTES lpSecurityAttributes</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwCreationDisposition</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> DWORD dwFlagsAndAttributes</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> HANDLE hTemplateFile</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szCreateFile</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'C'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'F'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_CreateFileA fn_CreateFileA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_CreateFileA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">fn_GetProcAddress</span><span style="color: rgb(51, 51, 51);">((</span><span style="color: rgb(51, 51, 51);">HMODULE</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getKernel32</span><span style="color: rgb(51, 51, 51);">(),</span><span style="color: rgb(51, 51, 51);"> szCreateFile</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szNewFile</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'1'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'.'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'x'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'\0'</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  fn_CreateFileA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">szNewFile</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> GENERIC_WRITE</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> CREATE_ALWAYS</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> NULL</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">下面为MessageBoxA</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> HMODULE </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpLibFileName</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szLoadLibraryA</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'L'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'L'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'b'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    FN_LoadLibraryA fn_LoadLibraryA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">fn_GetProcAddress</span><span style="color: rgb(51, 51, 51);">((</span><span style="color: rgb(51, 51, 51);">HMODULE</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getKernel32</span><span style="color: rgb(51, 51, 51);">(),</span><span style="color: rgb(51, 51, 51);"> szLoadLibraryA</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(167, 29, 93);">int</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_MessageBoxA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> HWND hWnd</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpText</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpCaption</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> UINT uType</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//正常写法</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//FN_MessageBoxA fn_MessageBoxA = (FN_MessageBoxA)GetProcAddress(LoadLibraryA("user32.dll"), "MessageBoxA");</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szUser32</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'U'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'3'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'2'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'.'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szMessageboxA</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'M'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'g'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'B'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'x'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_MessageBoxA fn_MessageBoxA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_MessageBoxA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">fn_GetProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">fn_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">szUser32</span><span style="color: rgb(51, 51, 51);">),</span><span style="color: rgb(51, 51, 51);"> szMessageboxA</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szHello</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'c'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'u'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'n'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szTip</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'p'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  fn_MessageBoxA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">NULL</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> szHello</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> szTip</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> MB_OK</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">看看正常写法</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">FN_MessageBoxA fn_MessageBoxA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_MessageBoxA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(0, 134, 179);">GetProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(0, 134, 179);">LoadLibraryA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(24, 54, 145);">"user32.dll"</span><span style="color: rgb(51, 51, 51);">),</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">"MessageBoxA"</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">因为获取得是user32.dll而不是直接一样得kernel32.dll所以我们要获取下LoadLibraryA得地址</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> HMODULE </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpLibFileName</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szLoadLibraryA</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'L'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'L'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'b'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    FN_LoadLibraryA fn_LoadLibraryA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">fn_GetProcAddress</span><span style="color: rgb(51, 51, 51);">((</span><span style="color: rgb(51, 51, 51);">HMODULE</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">getKernel32</span><span style="color: rgb(51, 51, 51);">(),</span><span style="color: rgb(51, 51, 51);"> szLoadLibraryA</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后就是获取MessageBoxA得地址</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">typedef</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(167, 29, 93);">int</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">WINAPI</span><span style="color: rgb(51, 51, 51);">*</span><span style="color: rgb(51, 51, 51);"> FN_MessageBoxA</span><span style="color: rgb(51, 51, 51);">)(</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> HWND hWnd</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpText</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_opt_</span><span style="color: rgb(51, 51, 51);"> LPCSTR lpCaption</span><span style="color: rgb(51, 51, 51);">,</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">    </span><span style="color: rgb(0, 134, 179);">_In_</span><span style="color: rgb(51, 51, 51);"> UINT uType</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//正常写法</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(150, 152, 150);">//FN_MessageBoxA fn_MessageBoxA = (FN_MessageBoxA)GetProcAddress(LoadLibraryA("user32.dll"), "MessageBoxA");</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szUser32</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'U'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'r'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'3'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'2'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'.'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'d'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'l'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szMessageboxA</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'M'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'s'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'a'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'g'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'B'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'o'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'x'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'A'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  FN_MessageBoxA fn_MessageBoxA </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">FN_MessageBoxA</span><span style="color: rgb(51, 51, 51);">)</span><span style="color: rgb(51, 51, 51);">fn_GetProcAddress</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">fn_LoadLibraryA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">szUser32</span><span style="color: rgb(51, 51, 51);">),</span><span style="color: rgb(51, 51, 51);"> szMessageboxA</span><span style="color: rgb(51, 51, 51);">);</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">最后再输出</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szHello</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'c'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'u'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'n'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'y'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'e'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  </span><span style="color: rgb(167, 29, 93);">char</span><span style="color: rgb(51, 51, 51);"> szTip</span><span style="color: rgb(51, 51, 51);">[]</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">=</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">{</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'t'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'i'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(24, 54, 145);">'p'</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(0, 134, 179);">0</span><span style="color: rgb(51, 51, 51);"> </span><span style="color: rgb(51, 51, 51);">};</span></span></code><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(51, 51, 51);">  fn_MessageBoxA</span><span style="color: rgb(51, 51, 51);">(</span><span style="color: rgb(51, 51, 51);">NULL</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> szHello</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> szTip</span><span style="color: rgb(51, 51, 51);">,</span><span style="color: rgb(51, 51, 51);"> MB_OK</span><span style="color: rgb(51, 51, 51);">);</span></span></code></pre></section><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">运行结果可以看到没什么问题</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/5_aeT1Ar25exyrzLsp8WeCAVfP4S4OOw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCgjAAgz5T4eWaSVyYt33PaShuaeT1Ar25exyrzLsp8WeCAVfP4S4OOw/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.9203187250996016" data-w="251"  /></figure><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">然后我们peid打开</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/6_JENz6lKia8Kv1PvfKzFbicEDY5QSHg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCsY2nEXsc1o1kkcZYL25Of1nhtsJENz6lKia8Kv1PvfKzFbicEDY5QSHg/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.44080604534005036" data-w="397"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">看下偏移是400然后我们ue打开然后找到对应得偏移地址复制这个16进制就是我们需要的shellcode，然后把shellcode插入到进程中执行就可以了，这里我们可以静态得插入到未执行得exe文件中，或者动态的插入到正在执行得进程的内存中，这里我们试试插入到未执行的exe文件中</p><section class="code-snippet__github" style="margin: 10px 8px;height: auto;display: flex;font-size:12px;line-height:32px;;background-color: rgba(27, 31, 35, 0.05);color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;text-align: start;white-space: normal;"><pre data-lang="" style="padding: 1em;display: grid;counter-reset: line 0;overflow-x: auto;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;"><code style="padding-right: 8px;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex;border-width: 0px !important;border-style: initial !important;border-color: initial !important;"><span class="code-snippet_outer"><span style="color: rgb(0, 134, 179);">558BEC83EC4C56E8E40000008BC8E8FD0000008BF0C745D0437265618D45D0C745D47465466950C745D86C654100E8BD00000050FFD66A006A006A026A006A0068000000408D4DF4C745F4312E74785166C745F87400FFD08D45B4C745B44C6F616450C745B84C696272C745BC61727941C645C000E87600000050FFD68D4DC4C745DC55736572518D4DDCC745E033322E645166C745E46C6CC645E600C745C44D657373C745C861676542C745CC6F784100FFD050FFD66A008D4DFCC745E879696375518D4DE8C745EC6E796979516A0066C745F06500C745FC74697000FFD033C05E8BE55DC3CCCCCCCCCCCCCCCCCC64A1300000008B400C8B40148B008B008B4010C3CCCCCCCCCCCCCCCCCCCCCCCC558BEC8BD183EC088B423C837C107C00750633C08BE55DC38B44107885C074F28B4C102403CA538B5C1020894DFC03DA8B4C101C568B74101803CA57894DF833FF33C94E8B048B03C2803847754E80780165754880780274754280780350753C8078047275368078056F753080780663752A80780741752480780864751E80780964751880780A72751280780B65750C80780C73750680780D73740E413BCE76A38BC75F5E5B8BE55DC38B45FC8B7DF80FB704488B3C8703FA8BC75F5E5B8BE55DC30000</span></span></code></pre></section><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里是29行+4个，我用以前写的端口扫描做测试</p><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">先看看入口的文件偏移</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/7_RWWujAibxFTIalge6PL3diczf5AO1g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodC8qEj5QNKtmvz7aPkiaKKNzDwZW3RWWujAibxFTIalge6PL3diczf5AO1g/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.473551637279597" data-w="397"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">000C23A0然后用winhex打开</p><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">然后我们转到偏移地址</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/8_C0bapUgaPLFib85EGWkia18s2Y9hmA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCIyqLtYdcyDXbMIj4mBFOtp0bEqC0bapUgaPLFib85EGWkia18s2Y9hmA/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.697841726618705" data-w="556"  /></figure><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">修改同样大小他shellcode替换了，所以只要运行这个exe就会运行我们的shellcode</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/9_qXTUqIknc0xsmIf13gBeReOVrxX3sA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodClWCeFeuew5DggyfDBQuUa1CrqXTUqIknc0xsmIf13gBeReOVrxX3sA/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="1.3746958637469586" data-w="411"  /></figure><p><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, system-ui, Roboto, &quot;Helvetica Neue&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">然后我们保存运行</span></p><figure style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/10_PfHmga9Hq1AWCCzK7qUvIVPBsBerUw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz/Uq8QfeuvouibE6UibrhjicdKg6cn3BuZodCWQfIw9XDsXJ1EbJ2AgWf7PFrPfHmga9Hq1AWCCzK7qUvIVPBsBerUw/640?wx_fmt=bmp'" data-type="bmp" style="box-sizing: border-box;margin: 0.1em auto 0.5em;line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;border-radius: 4px;display: block;height: auto !important;" title="null" data-ratio="0.7950310559006211" data-w="322"  /></figure><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">说明我们的shellcode插入了这个exe中，执行他就执行了我们的shellcode</p><p style="margin: 1.5em 8px;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">我们也可以把他shellcode生成为一个bin文件再写个加载器运行</p><p style="white-space: normal;"><br  /></p><figure style="margin: 1.5em 8px;white-space: normal;font-size:14px;line-height:34px;;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/11_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-ratio="0.109375" data-w="640" style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;height: auto !important;"  /></figure><p style="white-space: normal;"><br  /></p><p style="white-space: normal;text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247490909&amp;idx=1&amp;sn=efdbd98bd302159324cb431f3d735165&amp;chksm=ec1f4862db68c174c21d98f46847bba21a19602c4823ec17fb7363662751c385817e85d9c6ce&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span class="js_jump_icon h5_image_link" data-positionback="static" style="top: auto;left: auto;right: auto;bottom: auto;"><img class="rich_pages" data-ratio="0.4255555555555556" data-s="300,640" src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/12_oDxIic2QaZYKKrLDlJFT5v6EpREmjg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou80h6Jor7Py4sKIwfiaowozsMP0Yjn9RcoJAmPMKa5hQVczeXoDxIic2QaZYKKrLDlJFT5v6EpREmjg/640?wx_fmt=png'" data-type="png" data-w="900" style="border-radius: 42px;height: auto !important;"  /></span></a></p><p style="white-space: normal;text-align: center;"><br  /></p><p style="white-space: normal;text-align: center;"><strong style="color: rgb(255, 104, 39);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:14px;line-height:34px;;"><span style="font-size:17px;line-height:37px;;">点赞 在看 转发</span></strong></p><figure style="margin: 1.5em 8px;white-space: normal;font-size:14px;line-height:34px;;text-align: right;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><span style="font-size:13px;line-height:33px;;">原创投稿作者：一寸一叶</span></figure><p style="white-space: normal;text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-11-07_ShellCode生成框架/13_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style="height: auto !important;"  /><span style="font family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"></span></p>
                </div>
</div>
</body>
</html>