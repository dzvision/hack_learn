<html>
<head>
<title>漏洞挖掘之信息收集</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
漏洞挖掘之信息收集
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2019-06-08</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><blockquote><p>原创投稿，作者：Only_Free</p></blockquote><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">对一个网站挖掘的深浅来说就得看你收集的如何，这说明信息收集在漏洞挖掘中是非常的重要的。</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">子域名收集</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">子域名收集是最简单的收集手法之一，有很多在线的工具可以直接套用，这里分享几个我经常用的。</span></p><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">开心的时候用用这个扫描器</span></h4><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">为什么这么说，因为这是我写的（你生气用的话我怕我屏幕里突然冒出一个拖孩）</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="python hljs" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> requests<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> threading<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> bs4 <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> BeautifulSoup<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> re<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> time<br  /><br  />url = input( <span class="hljs-string" style="color: rgb(230, 219, 116);">'url(如baidu.com): '</span> )<br  /><br  />head={<span class="hljs-string" style="color: rgb(230, 219, 116);">'User-Agent'</span>:<span class="hljs-string" style="color: rgb(230, 219, 116);">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'</span>}<br  /><br  />ip = <span class="hljs-string" style="color: rgb(230, 219, 116);">'http://site.ip138.com/{}'</span>.format( url )<br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);"># domain_url = url.split('.')</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);"># domain_url = domain_url[1]+'.'+domain_url[2]</span><br  />domain_url = url<br  />domain = <span class="hljs-string" style="color: rgb(230, 219, 116);">'http://site.ip138.com/{}/domain.htm'</span>.format( domain_url )<br  /><br  />t = time.strftime(<span class="hljs-string" style="color: rgb(230, 219, 116);">"%Y-%m-%d"</span>+<span class="hljs-string" style="color: rgb(230, 219, 116);">'_'</span>, time.localtime())<br  />html_file = open( url+<span class="hljs-string" style="color: rgb(230, 219, 116);">'_'</span>+t+<span class="hljs-string" style="color: rgb(230, 219, 116);">'.html'</span>,<span class="hljs-string" style="color: rgb(230, 219, 116);">'w'</span> )<br  /><br  />html_file.write( <span class="hljs-string" style="color: rgb(230, 219, 116);">'''<br  /><br  />&lt;head&gt;<br  /><br  />&lt;title&gt;%s的扫描结果&lt;/title&gt;<br  />&lt;link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"&gt;<br  />&lt;script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"&gt;&lt;/script&gt;<br  />&lt;script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"&gt;&lt;/script&gt;<br  />&lt;style&gt;<br  /><br  />pre{<br  /><br  />margin: 0 0 0px;<br  /><br  />}<br  /><br  />&lt;/style&gt;<br  />&lt;/head&gt;<br  /><br  />&lt;ul id="myTab" class="nav nav-tabs navbar-fixed-top navbar navbar-default"&gt;<br  />&nbsp; &nbsp; &lt;li class="active"&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;a href="#ip" data-toggle="tab"&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; IP历史解析<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/a&gt;<br  />&nbsp; &nbsp; &lt;/li&gt;<br  />&nbsp; &nbsp; &lt;li&gt;&lt;a href="#cms" data-toggle="tab"&gt;CMS识别&lt;/a&gt;&lt;/li&gt;<br  />&nbsp; &nbsp; &lt;li&gt;&lt;a href="#domain" data-toggle="tab"&gt;子域名信息&lt;/a&gt;&lt;/li&gt;<br  />&lt;/ul&gt;<br  />&lt;br&gt;<br  />&lt;br&gt;<br  />&lt;br&gt;<br  />&lt;br&gt;<br  />&lt;div id="myTabContent" class="tab-content"&gt;<br  />'''</span>%url )<br  /><br  /><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">class</span> <span class="hljs-title">IP( threading.Thread )</span>:</span><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">__init__</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self, ip)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;threading.Thread.__init__(self)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.ip = ip<br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">run</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;r = requests.get( self.ip,headers = head )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html = r.text<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;bs = BeautifulSoup(html, <span class="hljs-string" style="color: rgb(230, 219, 116);">"html.parser"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html_file.write(<span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;div class="tab-pane fade in active" id="ip"&gt;'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> i <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> bs.find_all(<span class="hljs-string" style="color: rgb(230, 219, 116);">'p'</span>):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ipc = i.get_text()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ip_html = <span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;pre&gt;{}&lt;/pre&gt;'</span>.format( ipc )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;html_file.write( ip_html )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html_file.write(<span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;/div&gt;'</span>)<br  /><br  /><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">class</span> <span class="hljs-title">CMS( threading.Thread )</span>:</span><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">__init__</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self, cms)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;threading.Thread.__init__(self)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.cms = cms<br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">run</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;cms = requests.post(<span class="hljs-string" style="color: rgb(230, 219, 116);">'http://whatweb.bugscaner.com/what/'</span>, data={<span class="hljs-string" style="color: rgb(230, 219, 116);">'url'</span>: self.cms}, headers = head)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;text = cms.text<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Web_Frameworks = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">'"Web Frameworks": "(.*?)"]'</span>, text)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Programming_Languages = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">'"Programming Languages":(.*?)"]'</span>, text)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;JavaScript_Frameworks = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">'"JavaScript Frameworks": (.*?)"]'</span>, text)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CMS = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">'"CMS": (.*?)"]'</span>, text)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Web_Server = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">'"Web Servers": (.*?)"]'</span>, text)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> CMS:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CMS = CMS.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)+<span class="hljs-string" style="color: rgb(230, 219, 116);">'"]'</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> Programming_Languages:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Programming_Languages = Programming_Languages.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)+<span class="hljs-string" style="color: rgb(230, 219, 116);">'"]'</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> JavaScript_Frameworks:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;JavaScript_Frameworks = JavaScript_Frameworks.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)+<span class="hljs-string" style="color: rgb(230, 219, 116);">'"]'</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> Web_Frameworks:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Web_Frameworks = Web_Frameworks.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)+<span class="hljs-string" style="color: rgb(230, 219, 116);">'"]'</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> Web_Server:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Web_Server = Web_Server.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)+<span class="hljs-string" style="color: rgb(230, 219, 116);">'"]'</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html = <span class="hljs-string" style="color: rgb(230, 219, 116);">'''<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;div class="tab-pane fade" id="cms"&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;div class="table-responsive"&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;table class="table table-condensed"&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;tr&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;th&gt;web框架&lt;/th&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;th&gt;脚本版本&lt;/th&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;th&gt;JavaScript框架&lt;/th&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;th&gt;CMS框架&lt;/th&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;th&gt;web服务器&lt;/th&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;/tr&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;tr&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;td&gt;{0}&lt;/td&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;td&gt;{1}&lt;/td&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;td&gt;{2}&lt;/td&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;td&gt;{3}&lt;/td&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;td&gt;{4}&lt;/td&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;/tr&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/table&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/div&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/div&gt;<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'''</span>.format(Web_Frameworks,Programming_Languages,JavaScript_Frameworks,CMS,Web_Server)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html_file.write( html )<br  /><br  /><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">class</span> <span class="hljs-title">DOMAIN( threading.Thread )</span>:</span><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">__init__</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self, domain)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;threading.Thread.__init__(self)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.domain = domain<br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">run</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;r = requests.get( self.domain,headers = head )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html = r.text<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;bs = BeautifulSoup(html, <span class="hljs-string" style="color: rgb(230, 219, 116);">"html.parser"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html_file.write(<span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;div class="tab-pane fade in active" id="domain"'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;num = <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> i <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> bs.find_all(<span class="hljs-string" style="color: rgb(230, 219, 116);">'p'</span>):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;num += <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;html_file.write( <span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;br&gt;'</span> )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;domainc = i.get_text()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;domain_html = <span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;pre&gt;[{}]： {}&lt;/pre&gt;'</span>.format( num,domainc )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;html_file.write( domain_html )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;print( domain_html )<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;html_file.write(<span class="hljs-string" style="color: rgb(230, 219, 116);">'&lt;/div&gt;'</span>)<br  /><br  />ip_cls = IP(ip)<br  />ip_html = ip_cls.run()<br  /><br  />cms_cls = CMS(url)<br  />cms_html = cms_cls.run()<br  /><br  />domain_cls = DOMAIN( domain )<br  />domain_html = domain_cls.run()</code></pre><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">github上开源的子域名扫描器</span></h4><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://github.com/lijiejie/subDomainsBrute&nbsp;<br  />https://github.com/chuhades/dnsbrute</p><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">在线网站收集</span></h4><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">1，</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://d.chinacycc.com/（非常推荐<span style="vertical-align: inherit;">）</span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.7839388145315488" data-s="300,640" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/1_jTzYJslLJVNCyhHkrfNHPJ3qJVHISw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlHDSicJW26Y7DrQoNfNSiciaMGJNjTzYJslLJVNCyhHkrfNHPJ3qJVHISw/640?wx_fmt=png'" data-type="png" data-w="1046" style=""  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">然后不到30秒就出结果了<span style="vertical-align: inherit;"></span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.12905317769131" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/2_1XxRH57aDdmoSRorBPUDVG7QltIibQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlFKxjIiaZwECegRAPgWH1XPLSTa1XxRH57aDdmoSRorBPUDVG7QltIibQ/640?wx_fmt=png'" data-type="png" data-w="1542" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5503597122302158" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/3_YcqOcEiaIHmWHKLLrRnjbsPGvCum5Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlLbz50KfQYg0bQ3LyRdE5wYyYpYcqOcEiaIHmWHKLLrRnjbsPGvCum5Q/640?wx_fmt=png'" data-type="png" data-w="1668" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">2，</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">http://z.zcjun.com/&nbsp;<br  />https://phpinfo.me/domain/</p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">端口信息收集</span></h3><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">扫描端口并且标记可以爆破的服务</span></h4><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs vim" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-keyword" style="color: rgb(249, 38, 114);">nmap</span> 目标 --script=ftp-brute,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">imap</span>-brute,smtp-brute,pop3-brute,mongodb-brute,redis-brute,ms-sql-brute,rlogin-brute,rsync-brute,mysql-brute,pgsql-brute,oracle-sid-brute,oracle-brute,rtsp-url-brute,snmp-brute,svn-brute,telnet-brute,vnc-brute,xmpp-brute</code></pre><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">判断常见的漏洞并扫描端口</span></h4><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs sql" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">nmap 目标 <span class="hljs-comment" style="color: rgb(117, 113, 94);">--script=auth,vuln</span></code></pre><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">精确判断漏洞并扫描端口</span></h4><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs tcl" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">nmap 目标 --script=dns-zone-transfer,ftp-anon,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-<span class="hljs-number" style="color: rgb(174, 129, 255);">4221</span>,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-backup-finder,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-cisco-anyconnect,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-iis-short-name-brute,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-put,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-php-version,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-shellshock,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-robots.txt,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-svn-enum,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">http</span>-webdav-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">scan</span>,iis-buffer-overflow,iax2-version,memcached-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,mongodb-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,msrpc-enum,ms-sql-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,mysql-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,nrpe-enum,pptp-version,redis-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,rpcinfo,samba-vuln-cve-<span class="hljs-number" style="color: rgb(174, 129, 255);">2012</span>-<span class="hljs-number" style="color: rgb(174, 129, 255);">1182</span>,smb-vuln-ms08-<span class="hljs-number" style="color: rgb(174, 129, 255);">067</span>,smb-vuln-ms17-<span class="hljs-number" style="color: rgb(174, 129, 255);">010</span>,snmp-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,sshv1,xmpp-<span class="hljs-keyword" style="color: rgb(249, 38, 114);">info</span>,tftp-enum,teamspeak2-version </code></pre><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">我喜欢这样做</span></h4><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">如图1所示，扫描子域名</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.7568058076225045" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/4_reeQP2CdDKR3wqibIbolaeH4q65kBA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlN4BLsSzBW4rCN0bf88r3tLCl2reeQP2CdDKR3wqibIbolaeH4q65kBA/640?wx_fmt=png'" data-type="png" data-w="551" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">提取出域名/</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">ip</code></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.6256410256410256" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/5_4liahwlBOXKN3wMYW7CBD2XBa8wvzQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlmz7iaVlj7Ex83ra97GKdpwbXcE4liahwlBOXKN3wMYW7CBD2XBa8wvzQ/640?wx_fmt=png'" data-type="png" data-w="1560" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">然后把域名放到</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">975.txt</code></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">2，批量扫描端口和漏洞检测</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs vim" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-keyword" style="color: rgb(249, 38, 114);">nmap</span> -iL <span class="hljs-number" style="color: rgb(174, 129, 255);">975</span>.txt --script=auth,vuln,ftp-brute,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">imap</span>-brute,smtp-brute,pop3-brute,mongodb-brute,redis-brute,ms-sql-brute,rlogin-brute,rsync-brute,mysql-brute,pgsql-brute,oracle-sid-brute,oracle-brute,rtsp-url-brute,snmp-brute,svn-brute,telnet-brute,vnc-brute,xmpp-brute &gt; scan.txt</code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">然后根据对应开放的端口进行针对性漏洞挖掘</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">C段信息收集</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">C的段我话教育一般都是使用</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">iis put</code><span style="vertical-align: inherit;">这款工具来扫描，自可以定义扫描</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">1-255</code><span style="vertical-align: inherit;">的端口并且还有报道查看服务器</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">banner</code><span style="vertical-align: inherit;">信息</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">自定义的端口</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs dns" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-number" style="color: rgb(174, 129, 255);">135,139,80,8080,15672,873,8983,7001,4848,6379,2381,8161,11211,5335,5336,7809,2181,9200,50070,50075,5984</span>,<span class="hljs-number" style="color: rgb(174, 129, 255);">2375,7809</span>,<span class="hljs-number" style="color: rgb(174, 129, 255);">16992,16993</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5447916666666667" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/6_18XxU2KMYMV2Om8hUYM5SCSENYPSPg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlquob2iaBKlvuNC5ufhN4loOy718XxU2KMYMV2Om8hUYM5SCSENYPSPg/640?wx_fmt=png'" data-type="png" data-w="1920" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">这里只是演示下他跑起来的美</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">目录信息收集</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">目录收集工具有很多，但是最看重的还是目录字典，之前我拿了很多工具的字典去重集合起来超级超级大，只不过是在之前电脑那里还原的时候忘记了备份,,,（说这句话主要是想让你们也可以这样子做，方便自己，然后发我一份，方便你我）</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">这里推荐一个工具</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">7kbstorm</code></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://github.com/7kbstorm/7kbscan-WebPathBrute</p><blockquote style="margin-top: 0px;margin-bottom: 0px;padding-top: 0px;padding-left: 3em;color: rgb(102, 102, 102);background-color: rgb(248, 248, 248);border-left-width: 0.5em;border-left-color: rgb(238, 238, 238);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;"><span style="vertical-align: inherit;">像</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">403</code><span style="vertical-align: inherit;">，</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">404</code><span style="vertical-align: inherit;">这种页面千万不要关闭，放目录里面扫就ok了</span></p></blockquote><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">谷歌语法收集敏感文件</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">最常见的就是用搜索引擎〜</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs profile" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">site:<span class="hljs-filename">ooxx.com filetype</span>:xls</code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">首先试试百度</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5495915985997666" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/7_TBkkKa21NzhVraeMWmnARBwnseEaow.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlFYPhedicJpjcphfMARXX1RFiaxTBkkKa21NzhVraeMWmnARBwnseEaow/640?wx_fmt=png'" data-type="png" data-w="857" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><blockquote style="margin-top: 0px;margin-bottom: 0px;padding-top: 0px;padding-left: 3em;color: rgb(102, 102, 102);background-color: rgb(248, 248, 248);border-left-width: 0.5em;border-left-color: rgb(238, 238, 238);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;"><span style="vertical-align: inherit;">$！@！~~ WDwadawicnm</span></p></blockquote><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">试试必应</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.8341810783316378" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/8_BfFP8s31f0le3H36ZKc7sicDu8ax2Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlPPDsWu8cR67xOwoROEPFziaXBOBfFP8s31f0le3H36ZKc7sicDu8ax2Q/640?wx_fmt=png'" data-type="png" data-w="983" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">这里主要是收集网站敏感文件（比如目标的某个系统手册演示的截图中截图到了用户名，然后我们可以根据用户名来爆破密码;甚至可以看看有没有写系统默认密码，或者一些后台的目录路径，如果有目录就可以尝试对其访问，说不定有未授权〜）</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">还能尝试对后台进行查找</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs profile" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">site:<span class="hljs-filename">xxx.xxx admin<br  />site</span>:<span class="hljs-filename">xxx.xxx login<br  />site</span>:<span class="hljs-filename">xxx.xxx system<br  />site</span>:<span class="hljs-filename">xxx.xxx 管理<br  />site</span>:<span class="hljs-filename">xxx.xxx 登录<br  />site</span>:<span class="hljs-filename">xxx.xxx 内部<br  />site</span>:<span class="hljs-filename">xxx.xxx 系统</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">还可以查找邮箱，然后进行钓鱼</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs profile" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">site:<span class="hljs-filename">xxx.xxx 邮件<br  />site</span>:<span class="hljs-filename">xxx.xxx email</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">可以还查找</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">qq</code><span style="vertical-align: inherit;">群等，然后假装员工验证进去看群文件泄露了什么东东（这里有个技巧，去找客服聊天处，然后对整个过程抓包也就是看历史请求，如果运气好可能在请求的返回包中返回客服的姓名，如果只单纯的泄露了姓如</span><span style="font-weight: 700;">张xx</span><span style="vertical-align: inherit;">，那么你加群的时候就说你是</span><span style="font-weight: 700;">小张工作号</span><span style="vertical-align: inherit;">，说这个工作号的原因是可能小张已经在群里了）</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs profile" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">注意事项：如果你是挖腾讯的话就不要看这条啦<br  />site:<span class="hljs-filename">xxx.xxx qq<br  />site</span>:<span class="hljs-filename">xxx.xxx 群<br  />site</span>:<span class="hljs-filename">xxx.xxx 企鹅<br  />site</span>:<span class="hljs-filename">xxx.xxx 腾讯</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">还可以对寻找一些公开的，危害大，普遍的漏洞的指纹，下面如搜索的</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">jboss</code><span style="vertical-align: inherit;">系统-</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs coffeescript" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-attribute" style="color: rgb(249, 38, 114);">site</span>:ooxx.com <span class="hljs-attribute" style="color: rgb(249, 38, 114);">inurl</span>:jmx-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">console</span></code></pre><h4 style="margin-top: 20px;margin-bottom: 20px;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">小技巧</span></h4><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">比如下面一个站存在越权（但是越权的对象很难猜测）</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs go" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">http:<span class="hljs-comment" style="color: rgb(117, 113, 94);">//xxx.xxx.xxx/userinfo/?uid=2018-WOIDJWOIDJ-5201314</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">那么我们可以尝试用搜索引擎来找</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs css" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-rule"><span class="hljs-attribute" style="color: rgb(102, 217, 239);">site</span>:<span class="hljs-value">xxx.xxx inurl=uid=<span class="hljs-number" style="color: rgb(174, 129, 255);">20</span></span></span></code></pre><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">利用云网盘搜索工具搜集敏感文件</span></h3><blockquote style="margin-top: 0px;margin-bottom: 0px;padding-top: 0px;padding-left: 3em;color: rgb(102, 102, 102);background-color: rgb(248, 248, 248);border-left-width: 0.5em;border-left-color: rgb(238, 238, 238);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;"><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;"><span style="vertical-align: inherit;">公司员工可能把一些内部资料放在了公网网盘，然后被在线云网盘搜索的网站抓取了，我们就可以利用这个来对目标系统进行深入交流</span></p></blockquote><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">我这边主要用凌风云搜索</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://www.lingfengyun.com/</p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5525641025641026" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/9_FgSVY0WTaLa1zwTklfWibu9YUxsBng.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrl3PKLHuDFBQ3Os7UJiaNkNofSDxFgSVY0WTaLa1zwTklfWibu9YUxsBng/640?wx_fmt=png'" data-type="png" data-w="1560" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">个人喜欢直接输入厂商名字然后搜索（比较全），然后边看电视（最好看鬼片，鬼出来的阶段想着找找找）边搜索</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">利用gayhub来收集信息</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">1，打开</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">gayhub</code></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.6083274523641496" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/10_v9DEPdkSOiaRxGBBrBu4juDIiciaqg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrldWBdwoA4WlxxvJZ41sJcvCnbaoEv9DEPdkSOiaRxGBBrBu4juDIiciaqg/640?wx_fmt=png'" data-type="png" data-w="1417" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">就是这里找</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">gayhub</code><span style="vertical-align: inherit;">全部开源项目内容中存在联想这个关键字的项目，这样子可以搜集到的方面更广，如果单纯只是对标题搜索，他们那么改成了</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">lenovo</code><span style="vertical-align: inherit;">你就搜不到了</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">然后说再多，也没这个好用</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://sec.xiaomi.com/article/37</p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">针对网站性收集</span></h3><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">1，把网站弄报错，看是什么</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">cms</code><span style="vertical-align: inherit;">，或者看返回包回显是什么中间件这些</span></h5><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">2，的英文看</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">linux</code><span style="vertical-align: inherit;">还是</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">window</code></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">目标如</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">url</code><span style="vertical-align: inherit;">的英文</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">www.onlyfree.xxx/login</code><span style="vertical-align: inherit;">，改成那么</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">www.onlyfree.xxx/Login</code><span style="vertical-align: inherit;">看看能不能访问，如果可以访问就可能是</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">window</code><span style="vertical-align: inherit;">，否则可能是</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">linux</code></p><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">3，可以去云溪等在线识别指纹的网站看指纹信息</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">http://whatweb.bugscaner.com/look/&nbsp;<br  />http://www.yunsee.cn/finger.html</p><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">如图4所示，对</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">waf</code><span style="vertical-align: inherit;">进行识别</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">这里有一款开源的识别工具，用挺好的</span><br  />https://github.com/EnableSecurity/wafw00f</p><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">5，网站对</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">whois</code><span style="vertical-align: inherit;">查询看注册人，手机号，邮箱等（可以收集起来放到密码生成工具）</span></h5><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">6，看</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">html</code><span style="vertical-align: inherit;">源代码，在一起项目测试的时候，在我找</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">html</code><span style="vertical-align: inherit;">源代码的时候发现一个注释的</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">js</code><span style="vertical-align: inherit;">文件，我将其打开后，里面的备注居然是配置信息...后台地址，管理员账号和密码等（我可是没</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">get</code><span style="vertical-align: inherit;">到</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">shell</code><span style="vertical-align: inherit;">，所以你要知道这回事而不要记住这件事）</span></h5><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">7，真实网站</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;">ip</code><span style="vertical-align: inherit;">识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来</span></h5><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="python hljs" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-comment" style="color: rgb(117, 113, 94);">#############################################################</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;▄▄▄▄&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; ▄▄▄&nbsp; &nbsp;&nbsp;&nbsp;▄▄▄▄&nbsp; &nbsp; ▀&nbsp; &nbsp;&nbsp; &nbsp;▄&nbsp; &nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp;&nbsp;▀&nbsp; &nbsp;▀█ ▄&nbsp; &nbsp;▄&nbsp;&nbsp;▄▄▄▄&nbsp; &nbsp;&nbsp;&nbsp;█&nbsp; &nbsp; ▄▀&nbsp;&nbsp;▀▄ ▄▄▄&nbsp; &nbsp; ▄▄█▄▄ </span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp; ▄▄▄▀&nbsp;&nbsp;█▄█&nbsp; &nbsp;█▀ ▀█&nbsp; &nbsp; █&nbsp; &nbsp; █&nbsp;&nbsp;▄ █&nbsp; &nbsp;█&nbsp; &nbsp;&nbsp; &nbsp;█&nbsp; &nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;&nbsp; &nbsp;▀█&nbsp;&nbsp;▄█▄&nbsp; &nbsp;█&nbsp; &nbsp;█&nbsp; &nbsp; █&nbsp; &nbsp; █&nbsp; &nbsp; █&nbsp; &nbsp;█&nbsp; &nbsp;&nbsp; &nbsp;█&nbsp; &nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp;&nbsp;▀▄▄▄█▀ ▄▀ ▀▄&nbsp;&nbsp;██▄█▀&nbsp;&nbsp;▄▄█▄▄&nbsp; &nbsp;█▄▄█&nbsp;&nbsp;▄▄█▄▄&nbsp; &nbsp; ▀▄▄ </span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; █&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; ▀&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">###&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; </span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">### name: xcdn.py</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">### function: try to get the actual ip behind cdn</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">### date: 2016-11-05</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">### author: quanyechavshuo</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">### blog: http://3xp10it.cc</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);">#############################################################</span><br  /><span class="hljs-comment" style="color: rgb(117, 113, 94);"># usage:python3 xcdn.py www.baidu.com</span><br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> time<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> os<br  />os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"pip3 install exp10it -U --no-cache-dir"</span>)&nbsp; &nbsp; <br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> figlet2file<br  />figlet2file(<span class="hljs-string" style="color: rgb(230, 219, 116);">"3xp10it"</span>,<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>,<span class="hljs-keyword" style="color: rgb(249, 38, 114);">True</span>)<br  />time.sleep(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)<br  /><br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> CLIOutput<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_root_domain<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_string_from_command<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_http_or_https<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> post_request<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_request<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> checkvpn<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> sys<br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> re<br  /><br  /><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">class</span> <span class="hljs-title">Xcdn(object)</span>:</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">__init__</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self,domain)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#必须保证连上了vpn,要在可以ping通google的条件下使用本工具,否则有些domain由于被GFW拦截无法正常访问会导致</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#本工具判断错误,checkvpn在可以ping通google的条件下返回1</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">while</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> checkvpn()==<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">break</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; time.sleep(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"vpn is off,connect vpn first"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> domain[:<span class="hljs-number" style="color: rgb(174, 129, 255);">4</span>]==<span class="hljs-string" style="color: rgb(230, 219, 116);">"http"</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"domain format error,make sure domain has no http,like www.baidu.com but not \<br  />http://www.baidu.com"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sys.exit(<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#首先保证hosts文件中没有与domain相关的项,有则删除相关</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;domainPattern=domain.replace(<span class="hljs-string" style="color: rgb(230, 219, 116);">"."</span>,<span class="hljs-string" style="color: rgb(230, 219, 116);">"\."</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#下面的sed的正则中不能有\n,sed匹配\n比较特殊</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#http://stackoverflow.com/questions/1251999/how-can-i-replace-a-newline-n-using-sed</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;command=<span class="hljs-string" style="color: rgb(230, 219, 116);">"sed -ri 's/.*\s+%s//' /etc/hosts"</span> % domainPattern<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;os.system(command)<br  /><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.domain=domain<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.http_or_https=get_http_or_https(self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;print(<span class="hljs-string" style="color: rgb(230, 219, 116);">'domain的http或https是:%s'</span> % self.http_or_https)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;result=get_request(self.http_or_https+<span class="hljs-string" style="color: rgb(230, 219, 116);">"://"</span>+self.domain,<span class="hljs-string" style="color: rgb(230, 219, 116);">'seleniumPhantomJS'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.domain_title=result[<span class="hljs-string" style="color: rgb(230, 219, 116);">'title'</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#下面调用相当于main函数的get_actual_ip_from_domain函数</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;actual_ip = self.get_actual_ip_from_domain()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> actual_ip != <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"恭喜,%s的真实ip是%s"</span> % (self.domain, actual_ip))<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#下面用来存放关键返回值</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.return_value=actual_ip<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">domain_has_cdn</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 检测domain是否有cdn</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 有cdn时,返回一个字典,如果cdn是cloudflare，返回{'has_cdn':1,'is_cloud_flare':1}</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 否则返回{'has_cdn':1,'is_cloud_flare':0}或{'has_cdn':0,'is_cloud_flare':0}</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> re<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在检测domain:%s是否有cdn"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;has_cdn = <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># ns记录和mx记录一样,都要查顶级域名,eg.dig +short www.baidu.com ns VS dig +short baidu.com ns</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;result = get_string_from_command(<span class="hljs-string" style="color: rgb(230, 219, 116);">"dig ns %s +short"</span> % get_root_domain(self.domain))<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;pattern = re.compile(<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-string" style="color: rgb(230, 219, 116);">r"(cloudflare)|(cdn)|(cloud)|(fast)|(incapsula)|(photon)|(cachefly)|(wppronto)|(softlayer)|(incapsula)|(jsdelivr)|(akamai)"</span>, re.I)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;cloudflare_pattern = re.compile(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"cloudflare"</span>, re.I)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> re.search(pattern, result):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> re.search(cloudflare_pattern, result):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"has_cdn=1 from ns,and cdn is cloudflare"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> {<span class="hljs-string" style="color: rgb(230, 219, 116);">'has_cdn'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">'is_cloud_flare'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>}<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"has_cdn=1 from ns"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> {<span class="hljs-string" style="color: rgb(230, 219, 116);">'has_cdn'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">'is_cloud_flare'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>}<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 下面通过a记录个数来判断,如果a记录个数&gt;1个,认为有cdn</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;result = get_string_from_command(<span class="hljs-string" style="color: rgb(230, 219, 116);">"dig a %s +short"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;find_a_record_pattern = re.findall(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"((\d{1,3}\.){3}\d{1,3})"</span>, result)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> find_a_record_pattern:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; ip_count = <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> find_a_record_pattern:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ip_count += <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> ip_count &gt; <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;has_cdn = <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> {<span class="hljs-string" style="color: rgb(230, 219, 116);">'has_cdn'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">'is_cloud_flare'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>}<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> {<span class="hljs-string" style="color: rgb(230, 219, 116);">'has_cdn'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">'is_cloud_flare'</span>: <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>}<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">get_domain_actual_ip_from_phpinfo</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 从phpinfo页面尝试获得真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在尝试从domain:%s可能存在的phpinfo页面获取真实ip"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;phpinfo_page_list = [<span class="hljs-string" style="color: rgb(230, 219, 116);">"info.php"</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"phpinfo.php"</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"test.php"</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"l.php"</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> phpinfo_page_list:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;url = self.http_or_https + <span class="hljs-string" style="color: rgb(230, 219, 116);">"://"</span> + self.domain + <span class="hljs-string" style="color: rgb(230, 219, 116);">"/"</span> + each<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在访问%s"</span> % url)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;visit = get_request(url,<span class="hljs-string" style="color: rgb(230, 219, 116);">'seleniumPhantomJS'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;code = visit[<span class="hljs-string" style="color: rgb(230, 219, 116);">'code'</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;content = visit[<span class="hljs-string" style="color: rgb(230, 219, 116);">'content'</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;pattern = re.compile(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"remote_addr"</span>, re.I)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> code == <span class="hljs-number" style="color: rgb(174, 129, 255);">200</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">and</span> re.search(pattern, content):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; print(each)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; actual_ip = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"REMOTE_ADDR[^\.\d]+([\d\.]{7,15})[^\.\d]+"</span>, content).group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> actual_ip<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># return 0代表没有通过phpinfo页面得到真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">flush_dns</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 这个函数用来刷新本地dns cache</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 要刷新dns cache才能让修改hosts文件有效</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在刷新系统的dns cache"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;command = <span class="hljs-string" style="color: rgb(230, 219, 116);">"service network-manager restart &amp;&amp; /etc/init.d/networking force-reload"</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;os.system(command)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> time<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;time.sleep(<span class="hljs-number" style="color: rgb(174, 129, 255);">3</span>)<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">modify_hosts_file_with_ip_and_domain</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self,ip)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 这个函数用来修改hosts文件</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在修改hosts文件"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;exists_domain_line = <span class="hljs-keyword" style="color: rgb(249, 38, 114);">False</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">with</span> open(<span class="hljs-string" style="color: rgb(230, 219, 116);">"/etc/hosts"</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"r+"</span>) <span class="hljs-keyword" style="color: rgb(249, 38, 114);">as</span> f:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;file_content = f.read()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"%s"</span> % self.domain.replace(<span class="hljs-string" style="color: rgb(230, 219, 116);">"."</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"\."</span>), file_content):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exists_domain_line = <span class="hljs-keyword" style="color: rgb(249, 38, 114);">True</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> exists_domain_line == <span class="hljs-keyword" style="color: rgb(249, 38, 114);">True</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"sed -ri 's/.*%s.*/%s&nbsp; &nbsp; %s/' %s"</span> % (self.domain.replace(<span class="hljs-string" style="color: rgb(230, 219, 116);">"."</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"\."</span>), ip, self.domain, <span class="hljs-string" style="color: rgb(230, 219, 116);">"/etc/hosts"</span>))<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"echo %s %s &gt;&gt; /etc/hosts"</span> % (ip, self.domain))<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">check_if_ip_is_actual_ip_of_domain</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self,ip)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 通过修改hosts文件检测ip是否是domain对应的真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 如果是则返回True,否则返回False</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#CLIOutput().good_print("现在通过修改hosts文件并刷新dns的方法检测ip:%s是否是domain:%s的真实ip" % (ip,self.domain))</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#python通过requests库或mechanicalsoup库或selenium_phantomjs来请求时不会被dns缓存影响，只会被hosts文件影响dns解析,人工用浏览器访问域名则会受dns缓存影响</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在通过修改hosts文件的方法检测ip:%s是否是domain:%s的真实ip"</span> % (ip,self.domain))<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"cp /etc/hosts /etc/hosts.bak"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;self.modify_hosts_file_with_ip_and_domain(ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#python通过requests库或mechanicalsoup库或selenium_phantomjs来请求时不会被dns缓存影响，只会被hosts文件影响dns解析,人工用浏览器访问域名则会受dns缓存影响</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#self.flush_dns()</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;hosts_changed_domain_title= get_request(self.http_or_https + <span class="hljs-string" style="color: rgb(230, 219, 116);">"://%s"</span> % self.domain,<span class="hljs-string" style="color: rgb(230, 219, 116);">'selenium_phantom_js'</span>)[<span class="hljs-string" style="color: rgb(230, 219, 116);">'title'</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"rm /etc/hosts &amp;&amp; mv /etc/hosts.bak /etc/hosts"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#这里要用title判断,html判断不可以,title相同则认为相同</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> self.domain_title == hosts_changed_domain_title:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"检测到真实ip!!!!!!"</span>,<span class="hljs-string" style="color: rgb(230, 219, 116);">'red'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">True</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"当前ip不是域名的真实ip"</span>,<span class="hljs-string" style="color: rgb(230, 219, 116);">'yellow'</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">False</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">get_c_80_or_443_list</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self,ip)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 得到ip的整个c段的开放80端口或443端口的ip列表</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> <span class="hljs-string" style="color: rgb(230, 219, 116);">"not found"</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> get_string_from_command(<span class="hljs-string" style="color: rgb(230, 219, 116);">"masscan"</span>):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#这里不用nmap扫描,nmap扫描结果不准</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;os.system(<span class="hljs-string" style="color: rgb(230, 219, 116);">"apt-get install masscan"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> self.http_or_https==<span class="hljs-string" style="color: rgb(230, 219, 116);">"http"</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;scanPort=<span class="hljs-number" style="color: rgb(174, 129, 255);">80</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在进行%s的c段开了80端口机器的扫描"</span> % ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> self.http_or_https==<span class="hljs-string" style="color: rgb(230, 219, 116);">"https"</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;scanPort=<span class="hljs-number" style="color: rgb(174, 129, 255);">443</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在进行%s的c段开了443端口机器的扫描"</span> % ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;masscan_command = <span class="hljs-string" style="color: rgb(230, 219, 116);">"masscan -p%d %s/24 &gt; /tmp/masscan.out"</span> % (scanPort,ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;os.system(masscan_command)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">with</span> open(<span class="hljs-string" style="color: rgb(230, 219, 116);">"/tmp/masscan.out"</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"r+"</span>) <span class="hljs-keyword" style="color: rgb(249, 38, 114);">as</span> f:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;strings = f.read()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);">#os.system("rm /tmp/masscan.out")</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> re<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;allIP=re.findall(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"((\d{1,3}\.){3}\d{1,3})"</span>,strings)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ipList=[]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> allIP:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ipList.append(each[<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>])<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;print(ipList)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> ipList<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">check_if_ip_c_machines_has_actual_ip_of_domain</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self,ip)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 检测ip的c段有没有domain的真实ip,如果有则返回真实ip,如果没有则返回0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在检测ip为%s的c段中有没有%s的真实ip"</span> % (ip,self.domain))<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;target_list=self.get_c_80_or_443_list(ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each_ip <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> target_list:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">True</span> == self.check_if_ip_is_actual_ip_of_domain(each_ip):<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> each_ip<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">get_ip_from_mx_record</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 从mx记录中得到ip列表,尝试从mx记录中的c段中找真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"尝试从mx记录中找和%s顶级域名相同的mx主机"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> socket<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># domain.eg:www.baidu.com</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_root_domain<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;root_domain = get_root_domain(self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">from</span> exp10it <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> get_string_from_command<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;result = get_string_from_command(<span class="hljs-string" style="color: rgb(230, 219, 116);">"dig %s +short mx"</span> % root_domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;sub_domains_list = re.findall(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"\d{1,} (.*\.%s)\."</span> % root_domain.replace(<span class="hljs-string" style="color: rgb(230, 219, 116);">"."</span>, <span class="hljs-string" style="color: rgb(230, 219, 116);">"\."</span>), result)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ip_list = []<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> sub_domains_list:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;print(each)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ip = socket.gethostbyname_ex(each)[<span class="hljs-number" style="color: rgb(174, 129, 255);">2</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> ip[<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>] <span class="hljs-keyword" style="color: rgb(249, 38, 114);">not</span> <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> ip_list:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; ip_list.append(ip[<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>])<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> ip_list<br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">check_if_mx_c_machines_has_actual_ip_of_domain</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 检测domain的mx记录所在ip[或ip列表]的c段中有没有domain的真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 有则返回真实ip,没有则返回0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"尝试从mx记录的c段中查找是否存在%s的真实ip"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ip_list = self.get_ip_from_mx_record()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> ip_list != []:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">for</span> each_ip <span class="hljs-keyword" style="color: rgb(249, 38, 114);">in</span> ip_list:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; result = self.check_if_ip_c_machines_has_actual_ip_of_domain(each_ip)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> result != <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> result<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">continue</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">get_ip_value_from_online_cloudflare_interface</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 从在线的cloudflare查询真实ip接口处查询真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 如果查询到真实ip则返回ip值,如果没有查询到则返回0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"现在从在线cloudflare类型cdn查询真实ip接口尝试获取真实ip"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;url = <span class="hljs-string" style="color: rgb(230, 219, 116);">"http://www.crimeflare.com/cgi-bin/cfsearch.cgi"</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;post_data = <span class="hljs-string" style="color: rgb(230, 219, 116);">'cfS=%s'</span> % self.domain<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;content = post_request(url, post_data)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;findIp = re.search(<span class="hljs-string" style="color: rgb(230, 219, 116);">r"((\d{1,3}\.){3}\d{1,3})"</span>, content)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> findIp:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> findIp.group(<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  /><br  />&nbsp; &nbsp; <span class="hljs-function" style="color: rgb(249, 38, 114);"><span class="hljs-keyword" style="color: rgb(102, 217, 239);">def</span> <span class="hljs-title" style="color: rgb(166, 226, 46);">get_actual_ip_from_domain</span><span class="hljs-params" style="color: rgb(248, 248, 242);">(self)</span>:</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 尝试获得domain背后的真实ip,前提是domain有cdn</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 如果找到了则返回ip,如果没有找到返回0</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"进入获取真实ip函数,认为每个domain都是有cdn的情况来处理"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> socket<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;has_cdn_value = self.domain_has_cdn()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> has_cdn_value[<span class="hljs-string" style="color: rgb(230, 219, 116);">'has_cdn'</span>] == <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"检测到domain:%s的A记录不止一个,认为它有cdn"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">pass</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;CLIOutput().good_print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"Attention...!!! Domain doesn't have cdn,I will return the only one ip"</span>)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;true_ip = socket.gethostbyname_ex(self.domain)[<span class="hljs-number" style="color: rgb(174, 129, 255);">2</span>][<span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>]<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> true_ip<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 下面尝试通过cloudflare在线查询真实ip接口获取真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> has_cdn_value[<span class="hljs-string" style="color: rgb(230, 219, 116);">'is_cloud_flare'</span>] == <span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ip_value = self.get_ip_value_from_online_cloudflare_interface()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> ip_value != <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> ip_value<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">pass</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 下面尝试通过可能存在的phpinfo页面获得真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;ip_from_phpinfo = self.get_domain_actual_ip_from_phpinfo()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> ip_from_phpinfo == <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">pass</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> ip_from_phpinfo<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: rgb(117, 113, 94);"># 下面通过mx记录来尝试获得真实ip</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;result = self.check_if_mx_c_machines_has_actual_ip_of_domain()<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> result == <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">pass</span><br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">else</span>:<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> result<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;print(<span class="hljs-string" style="color: rgb(230, 219, 116);">"很遗憾,在下认为%s有cdn,但是目前在下的能力没能获取它的真实ip,当前函数将返回0"</span> % self.domain)<br  />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: rgb(249, 38, 114);">return</span> <span class="hljs-number" style="color: rgb(174, 129, 255);">0</span><br  /><br  /><span class="hljs-keyword" style="color: rgb(249, 38, 114);">if</span> __name__ == <span class="hljs-string" style="color: rgb(230, 219, 116);">'__main__'</span>:<br  />&nbsp; &nbsp; <span class="hljs-keyword" style="color: rgb(249, 38, 114);">import</span> sys<br  />&nbsp; &nbsp; domain=sys.argv[<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span>]<br  />&nbsp; &nbsp; Xcdn(domain)</code></pre><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">如图8所示，服务器的ssh配置信息</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">丢工具：https：</span>//github.com/mozilla/ssh_scan</p><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">9，敏感文件爆破</span></h5><ul style="" class=" list-paddingleft-2"><li><p><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">svn</code><span style="vertical-align: inherit;">代码源泄露使用</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">svn</code><span style="vertical-align: inherit;">版本控制系统-时，操作错误将</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">.svn</code><span style="vertical-align: inherit;">文件存放，久那么可以看他</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">SVN</code><span style="vertical-align: inherit;">服务器账号密码等信息</span></p></li></ul><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs go" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">http:<span class="hljs-comment" style="color: rgb(117, 113, 94);">//xxx.xxx.xxx/.svn/entries</span></code></pre><h5 style="margin-top: 20px;margin-bottom: 20px;font-size:14px;line-height:34px;;border-width: 0px;border-style: initial;border-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">10，根据目标系统情况</span></h5><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">根据目标系统情况是因为看他对应的系统是什么对应有什么漏洞，这个下面的英文</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">tomcat</code><span style="vertical-align: inherit;">的</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">session</code><span style="vertical-align: inherit;">泄露</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs coffeescript" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-regexp" style="color: rgb(174, 129, 255);">/examples/servlets/servlet/SessionExample/examples/</span><br  />/examples/servlets/servlet/SessionExample<br  /><span class="hljs-regexp" style="color: rgb(174, 129, 255);">/examples/</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5597826086956522" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/11_Y50Rt5Lbeq4B38iaonT4ctu6AoDdvA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrlEHZ9aBHUHoLJIjpsTM1ZB2Pl5Y50Rt5Lbeq4B38iaonT4ctu6AoDdvA/640?wx_fmt=png'" data-type="png" data-w="920" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">敏感目录泄露</span></h3><ul style="" class=" list-paddingleft-2"><li><p><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">WEB-INF/web.xml</code><span style="vertical-align: inherit;">泄露</span></p></li></ul><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">WEB-INF</code><span style="vertical-align: inherit;">的英文</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">Java</code><span style="vertical-align: inherit;">的</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">WEB</code><span style="vertical-align: inherit;">应用的安全目录。如果想在页面中直接访问其中的文件，通过必须</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">web.xml</code><span style="vertical-align: inherit;">文件对要访问的文件进行相应映射才能访问</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs x86asm" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/config/jdbc.properties<br  />/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/web.xml<br  />/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/classes/<br  />/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/lib/<br  />/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/src/<br  />/WEB-<span class="hljs-built_in" style="color: rgb(230, 219, 116);">INF</span>/database.properties</code></pre><ul style="" class=" list-paddingleft-2"><li><p><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">bzr</code><span style="vertical-align: inherit;">泄露</span></p></li></ul><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">通过它我们可以看项目历史</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs go" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">http:<span class="hljs-comment" style="color: rgb(117, 113, 94);">//xxx.xxx.xxx/.bzr/</span></code></pre><ul style="" class=" list-paddingleft-2"><li><p><span style="vertical-align: inherit;">网站源代码泄露</span></p></li></ul><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">不多介绍，可能管理员觉得网站不安全，需要我们审计一下</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs css" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-tag" style="color: rgb(249, 38, 114);">www</span><span class="hljs-class" style="color: rgb(166, 226, 46);">.zip</span><br  /><span class="hljs-tag" style="color: rgb(249, 38, 114);">www</span><span class="hljs-class" style="color: rgb(166, 226, 46);">.tar.gz</span><br  /><span class="hljs-tag" style="color: rgb(249, 38, 114);">www</span><span class="hljs-class" style="color: rgb(166, 226, 46);">.rar</span><br  /><span class="hljs-tag" style="color: rgb(249, 38, 114);">web</span><span class="hljs-class" style="color: rgb(166, 226, 46);">.zip</span><br  /><span class="hljs-tag" style="color: rgb(249, 38, 114);">web</span><span class="hljs-class" style="color: rgb(166, 226, 46);">.rar</span><br  />...</code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">这些有很多,,不一一详细，后面我会将这些全部集合在一个字典里，然后我们可以放入目录遍历的工具里批量扫〜</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">利用shodan，Fofa等收集信息</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">查找标题是携程并且语言是国语的站点</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs ruby" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-symbol" style="color: rgb(249, 38, 114);">https:</span>/<span class="hljs-regexp" style="color: rgb(174, 129, 255);">/www.shodan.io/search</span>?query=http.<span class="hljs-symbol" style="color: rgb(249, 38, 114);">title:</span><span class="hljs-string" style="color: rgb(230, 219, 116);">"携程"</span> <span class="hljs-symbol" style="color: rgb(249, 38, 114);">country:</span><span class="hljs-string" style="color: rgb(230, 219, 116);">"CN"</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img class="" data-ratio="0.5251009809578765" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/12_mBBR0bVw7ffFE1JC3sk9qn2CWZCwTQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9xg5bnjkR6MZoickDbupXrl9dvz2gZthsib4fTqjEVtlmmhsmBBR0bVw7ffFE1JC3sk9qn2CWZCwTQ/640?wx_fmt=png'" data-type="png" data-w="1733" style="border-width: 0px;border-style: initial;border-color: initial;vertical-align: middle;max-width: 740px;"  /></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">我们可以将其收藏为文件夹，方便下次打开，然后记录时间，看看有没有新上线的（这里已经有监控的功能，师傅各位去可以看看米斯特大佬写的</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">shodan</code><span style="vertical-align: inherit;">监控点文章，很有趣很实用）</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">shodan</code><span style="vertical-align: inherit;">，</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">fofa</code><span style="vertical-align: inherit;">不多介绍了，有对应的手册，见的肯定比我好</span></p><h3 style="margin-top: 20px;margin-bottom: 20px;font-size:18px;line-height:38px;;border-width: 0px 0px 2px;border-top-style: initial;border-right-style: initial;border-bottom-style: solid;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(204, 204, 204);border-left-color: initial;font-weight: bold;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">思路扩展</span></h3><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">扩展思路就是在</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">a</code><span style="vertical-align: inherit;">功能点中找出</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">b</code><span style="vertical-align: inherit;">功能点，以此类推</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">比如一些后台登录是</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs go" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;">http:<span class="hljs-comment" style="color: rgb(117, 113, 94);">//xxx.xxx.xxx/admin-login</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">的英文我们不是可以尝试吧</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">login</code><span style="vertical-align: inherit;">改成</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">register</code><span style="vertical-align: inherit;">来注册</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">再比如获取用户手机号的接口（这里不存在越权）</span></p><pre style="margin-top: 15px;margin-bottom: 15px;padding: 2px;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;overflow: auto;color: rgb(81, 81, 81);font-size:14px;line-height:34px;;text-align: start;"><code class="hljs ruby" style="padding: 0.5em;font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;display: block;overflow-x: auto;background: rgb(35, 36, 31);text-size-adjust: none;color: rgb(248, 248, 242);border-width: 0px;border-style: initial;border-color: initial;"><span class="hljs-symbol" style="color: rgb(249, 38, 114);">http:</span>/<span class="hljs-regexp" style="color: rgb(174, 129, 255);">/xxx.xxx.xxx/user/GetPhone/</span>?id=<span class="hljs-number" style="color: rgb(174, 129, 255);">1</span></code></pre><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">我们然后把</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">GetPhone</code><span style="vertical-align: inherit;">改成</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">GetPasswd</code><span style="vertical-align: inherit;">或者</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">GetPwd</code><span style="vertical-align: inherit;">或者</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">GetPassword</code><span style="vertical-align: inherit;">然后</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">id</code><span style="vertical-align: inherit;">就可能可以越权，这里或者可以</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">json</code><span style="vertical-align: inherit;">劫持或者</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">origin</code><span style="vertical-align: inherit;">劫持等，我们可以诱导用户点开来劫持账号密码</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">或者还是看源代码，然后搜索</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">hidden</code><span style="vertical-align: inherit;">（滑稽），我们可能可能会找到敏感操作的按钮，然后管理员也知道敏感，将其“隐藏”了，我们可以根据这个来搜索然后访问他，嘿嘿嘿（之前一个对小站点进行挖掘的时候我</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">hidden</code><span style="vertical-align: inherit;">找居然找到了不可描述的目录下面放着不可描述的电影，当时我的心情是非常拒绝的，经过几小时的思考我迅速的将那个目录关闭了，毕竟我是祖国的花朵）</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;">有这里的英文很多最</span><code style="font family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace;background-color: rgb(248, 248, 248);border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);border-radius: 3px;">adrian</code><span style="vertical-align: inherit;">师傅与我分享的，然后暂时只写那么多吧（其实还有几个，怕触犯到权什么的就是他给你学了但不给我写的那种，很麻烦所以就以后有机会再写吧），如果遇到了更多我会补充</span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="vertical-align: inherit;font-size:17px;line-height:37px;;">推荐知识星球</span></strong></p><p style="text-align: center;"><img class="rich_pages" data-croporisrc="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/13_IKGz1YqVsk6gSjiahPBcTD8mxeeSbA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou86dQRqxDwj86v66MSJK5NiaILJ0RQTnIDx5q6A2gl6vGVovoIKGz1YqVsk6gSjiahPBcTD8mxeeSbA/0?wx_fmt=png'" data-cropx1="39.118705035971225" data-cropx2="709.5323741007195" data-cropy1="56.65467625899281" data-cropy2="388.48920863309354" data-ratio="0.4955223880597015" data-s="300,640" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/14_GkoHjBUVkD0gKIQXNLaPgiaxgV2O2Q.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvou86dQRqxDwj86v66MSJK5NiallnIBoy8YwHOtYmhvAk8HJpVHGkoHjBUVkD0gKIQXNLaPgiaxgV2O2Q/640?wx_fmt=jpeg'" data-type="jpeg" data-w="670" style="width: 497px;height: 246px;"  /><span style="font-size:14px;line-height:34px;;"></span></p><p style="margin-top: 15px;margin-bottom: 15px;border-width: 0px;border-style: initial;border-color: initial;color: rgb(81, 81, 81);font family: &quot;Microsoft Yahei&quot;, Simsun;font-size:14px;line-height:34px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="vertical-align: inherit;"></span><span style="color: rgb(255, 76, 0);"><strong>加入申请理由/填写验证信息</strong></span></p><p style="text-align: center;"><span style="font-size:15px;line-height:35px;;"><span style="color: rgb(255, 76, 0);"><strong>务必填写是：</strong></span><strong><span style="color: rgb(0, 0, 0);">HACK学习</span></strong></span></p><p style="text-align: center;"><span style="font-size:15px;line-height:35px;;"><strong><span style="color: rgb(0, 0, 0);"><br  /></span></strong></span></p><p style="text-align: center;"><span style="font-size:15px;line-height:35px;;"><strong><span style="font-size:15px;line-height:35px;;color: rgb(0, 0, 0);">否则可能无法通过</span></strong></span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2019-06-08_漏洞挖掘之信息收集/15_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>