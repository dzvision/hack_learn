<html>
<head>
<title>渗透测试中如何快速拿到Webshell</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0;max-width:100%;box-sizing:border-box;}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{-webkit-touch-callout:none;font family:-apple-system-font,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei UI","Microsoft YaHei",Arial,sans-serif;color:#333;letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px;line-height:36px;}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;line-height:37px;;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:42px;;line-height:1.4;margin:10px 0;padding-bottom:10px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;line-height:35px;;line-height:35px;;line-height:35px;;line-height:35px;;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:4px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:rgba(0,0,0,0.3)}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;line-height:34px;;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;line-height:32px;;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;line-height:38px;;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size:15px;line-height:35px;;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}.playVideoWx{position:relative;display:block;}.icon_mid_play{position:absolute;z-index:9999;top:50%;left:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:48px;height:48px;background:rgba(237,237,237,0.9);border-radius:50%}.icon_mid_play:before{content:"";text-indent:-999em;display:inline-block;width:28px;height:28px;vertical-align:middle;background-size:cover;background-image:url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E  %3Cpath fill='%23151515' fill-rule='evenodd' d='M9.524 4.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 8 18.21V5.79a1 1 0 0 1 1.524-.852z'/%3E%3C/svg%3E")}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet"/>
</head>
<body>
<div class="rich_media">
                
                <h1 class="rich_media_title" id="activity-name">
                    
                    
                    
渗透测试中如何快速拿到Webshell
                </h1>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                                <span class="rich_media_meta rich_media_meta_text">
                                                                    Mr.wu
                                                            </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
                      <a href="javascript:void(0);" class=" weui-wa-hotarea" id="js_name">
                        HACK学习呀                      </a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">HACK学习呀</strong>
                              

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">Hacker1961X</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>
                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2019-07-18</em>
                </div>

                
                                                <div id="js_tags"  class="article-tag__list" style="display: none;" data-len="0">
                                            
                        <div class="article-tag-card__title">收录于话题</div>
                        <div class="article-tags">
                                                    </div>
                                    </div><div id="weixin_content"><blockquote style="margin-top: 0.6em;margin-bottom: 0.6em;padding: 5px 10px 5px 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;border-left-width: 4px;border-left-color: rgb(221, 221, 221);vertical-align: baseline;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><p style="word-break: break-word;vertical-align: baseline;line-height: 1.8;">WEB安全漏洞中，与文件操作相关的漏洞类型就不少，在大部分的渗透测试过程中，上传文件（大、小马）是必不可少的一个流程，然而各种各样的防火墙拦截了文件上传，遂整理文件操作相关漏洞的各种姿势，如有不妥之处，还望各位斧正，小东感激不尽。</p></blockquote><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">最近在代码审计某项目的时候发现了一个文件上传漏洞，但是在生产环境测试的过程中，各种各样的“狗”和“盾”都给拦截了，徒有漏洞，没法儿利用，所以整理整理，杀狗破盾，冲冲冲！</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×01 寻找文件操作相关漏洞</a></h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">文件操作相关的漏洞主要有：任意文件上传、任意文件下载、任意文件删除、任意文件读取四大类（简单理解：增删改查）</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1.1 文件上传：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">文件上传功能在大多数的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">web</code>&nbsp;应用中都存在，比如用户头像上传，文章内容的图片、视频、音频、附件上传，一些&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CMS</code>&nbsp;系统上传模版文件，数据库备份文件，插件文件等地方。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">而文件上传，在大部分的渗透测试进一步利用漏洞的时候是比较关键的一步。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">一般来说，对于那些未校验文件类型的上传操作的，可以直接上传我们的小马、大马文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">有校验文件后缀、类型的，如果是黑名单的方式，比如某&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">WAF</code>&nbsp;设置了不允许上传文件后缀为<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">php,asp,apsx</code>的文件，根据<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">PHP</code>的一些可解析后缀比如：<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">php3</code>&nbsp;、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">php4</code>、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">php5</code>、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">phtml</code>等等</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">黑名单：</p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-default"><span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">array</span>( <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php5"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php4"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php3"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php2"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"php1"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".html"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".htm"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 52px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".phtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pht"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp5"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp4"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp3"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp2"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"pHp1"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".Html"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".Htm"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspx"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsw"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsv"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSw"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSv"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jHtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aspx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asax"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".ascx"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".ashx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asmx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".cer"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSpx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSax"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aScx"</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aShx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSmx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".cEr"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".sWf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".swf"</span>);</code></pre></section><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1.2 文件删除：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">任意文件删除漏洞，一般来讲删除文件是一个比较危险的操作，都是管理员才具有的权限，所以对于文件的删除必须有权限的控制，当然如果没有做好CSRF防护，同样是可以以管理员权限进行操作。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">任意文件删除漏洞一般存在于：用户删除文章的附件（图片、压缩包等），管理员删除文章（同时关联删除文章附件），管理员删除插件，删除模版，删除数据库备份文件等操作的地方。</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1.3 文件修改：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">文件修改其实比较少见，其实现的一般思路是删除原文件，替换成新上传的文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">修改文件的操作，在后台的操作还比较常见，比如写后台修改web应用的配置文件<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">config.php</code>（配置网站标题、关键词、数据库等等），常见于安装CMS系统时候的引导操作流程，所以会经常去寻找类似于<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">install.php</code>等的文件，检查是否存在重装漏洞。</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1.4 读取/下载文件：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">在一个web应用中，对于网站有风险的文件下载操作的是用户可以读取或下载任意文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">常见存在此漏洞的地方比如：网站程序备份文件、数据库备份文件，文件备份&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">index.php.bak</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.git</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">VM</code>&nbsp;文件修改的时候异常退出的而生成的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.swp</code>备份文件等</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×02 如何突破上传文件</h2><blockquote style="margin-top: 0.6em;margin-bottom: 0.6em;padding: 5px 10px 5px 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;border-left-width: 4px;border-left-color: rgb(221, 221, 221);vertical-align: baseline;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><p style="word-break: break-word;vertical-align: baseline;line-height: 1.8;">实际的环境中，很少有直接可以任意上传文件的漏洞&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">常见于前端限制</code>，小东根据个人经验整理出主要的三大类突破文件上传拦截的方法：</p></blockquote><table><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><th style="padding: 8px;box-sizing: border-box;border-top-width: 1px;border-color: rgb(242, 242, 242);" width="123">操作</th><th style="padding: 8px;box-sizing: border-box;border-top-width: 1px;border-color: rgb(242, 242, 242);" width="412">说明</th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">前端禁用JS</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">前端限制，禁用JS，去除<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">input</code>标签的<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">accept</code>属性</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">抓包工具，修改文件后缀为黑名单之外的后缀</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">修改文件后缀为<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">index.jpg.php</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">%00</code>截断，比如<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">index.php%00.jpg</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">文件名末尾添加<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">::$DATA</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">windows</code>会把<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">::$DATA</code>之后的数据当成文件流，不会检测后缀名<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.</code>且保持<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">::$DATA</code>之前的文件名</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">在<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">linux</code>主机上的文件名大小写敏感，文件后缀大小混写</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">在文件末尾添加空格，黑名单的方式没法儿检测</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件类型</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">抓包工具，修改<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Content-Type:image/png</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改文件后缀</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="412">修改文件名<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php:.jpg</code>，上传后会得到一个空的文件<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>，然后修改文件名为<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.&gt;&gt;&gt;</code>或者<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.&lt;</code>、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.&lt;&lt;&lt;</code>、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.&gt;&gt;&lt;</code>再上传，重写<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">换行解析</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Apache2.4.0~2.4.29</code>换行解析漏洞<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">%0d</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">%0a</code>(<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CR</code>,<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">LF</code>(回车，换行))</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">未知后缀名</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Apache</code>配置<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">AddHandler application/x-httpd-php .php</code>不当导致未知后缀脚本执行</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">后缀名正则替换</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411">这种需要构造，使得替换之后的可以重组成为新的可执行后缀，双后缀名绕过</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">修改上传路径</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">name="upload_file/1.php%00"; filename="shell.jpg"</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">条件竞争</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411">条件竞争删除/重命名文件时间差绕过</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">图片马</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">copy code.jpg/b + shell.php/b hourse.jpg</code></td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">图片重绘包含马</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411">做一个就好了</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">上传压缩包</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411">配合PHP伪协议、文件协议等读取执行本地文件</td></tr><tr style="box-sizing: border-box;"><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="91">数据库写文件</td><td style="padding: 8px;box-sizing: border-box;border-color: rgb(242, 242, 242);" width="411"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">UDF</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;box-sizing: border-box;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">select</code>查询输入</td></tr></tbody></table><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><strong>实战示例：</strong></p><blockquote style="margin-top: 0.6em;margin-bottom: 0.6em;padding: 5px 10px 5px 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;border-left-width: 4px;border-left-color: rgb(221, 221, 221);vertical-align: baseline;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><p style="word-break: break-word;vertical-align: baseline;line-height: 1.8;">来自<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Upload-labs</code>漏洞演示靶场的文件上传的第九关示例，一看到下面这种情况，是不是感觉完全没思路？</p></blockquote><p><br  /></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-default"><span class="php"><span class="hljs-default-meta" style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;">&lt;?php</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />$is_upload = <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">false</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />$msg = <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">null</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">if</span> (<span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">isset</span>($_POST[<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 52px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'submit'</span>])) {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">if</span> (file_exists(UPLOAD_PATH)) {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $deny_ext = <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">array</span>(<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php5"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php4"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php3"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".php2"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".html"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".htm"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 52px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".phtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pht"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp5"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp4"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp3"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHp2"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".Html"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".Htm"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 52px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".pHtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsw"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jsv"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jspf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSw"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSv"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jSpf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 53px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".jHtml"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aspx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asax"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".ascx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".ashx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".asmx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".cer"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSp"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSpx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSa"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSax"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aScx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aShx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 46px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".aSmx"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".cEr"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".sWf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".swf"</span>,<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 72px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">".htaccess"</span>);<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_name = trim($_FILES[<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 85px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'upload_file'</span>][<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'name'</span>]);<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_name = deldot($file_name);<span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 120px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//删除文件名末尾的点</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_ext = strrchr($file_name, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'.'</span>); <span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 178px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">// 获取文件的后缀名，如`.php`</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_ext = strtolower($file_ext); <span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 73px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//转换为小写</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_ext = str_ireplace(<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 59px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'::$DATA'</span>, <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 14px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">''</span>, $file_ext);<span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 118px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//去除字符串::$DATA</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $file_ext = trim($file_ext); <span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 61px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//首尾去空</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> <br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">if</span> (!in_array($file_ext, $deny_ext)) {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $temp_file = $_FILES[<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 86px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'upload_file'</span>][<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'tmp_name'</span>];<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $img_path = UPLOAD_PATH.<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 19px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'/'</span>.$file_name;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">if</span> (move_uploaded_file($temp_file, $img_path)) {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $is_upload = <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">true</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> } <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">else</span> {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $msg = <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 72px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'上传出错！'</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> }<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> } <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">else</span> {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $msg = <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 144px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'此文件类型不允许上传！'</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> }<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> } <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">else</span> {<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> $msg = UPLOAD_PATH . <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 162px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'文件夹不存在,请手工创建！'</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /> }<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />}<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-meta" style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;">?&gt;</span></span></code></pre></section><p><span style="background-color: rgba(255, 255, 255, 0.88);color: rgb(0, 0, 0);font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;"></span><br  /></p><p><span style="background-color: rgba(255, 255, 255, 0.88);color: rgb(0, 0, 0);font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size:14px;line-height:34px;;text-align: start;">面对这样的情况，该怎么上传绕过呐？各位不妨先思考一下！</span></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">小东看到这样的情况是这样思考的：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1、什么操作系统？</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">2、如何绕过函数？</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">环境是自己的<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">windows</code>笔记本，那么通过<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">windows</code>系统特征可以尝试正则绕过，文件流<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">::$DATA</code>，大小写绕过，换行截断等方式。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">如果是<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">linux</code>，就有文件大小写，换行截断，解析文件上传等等方式。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">分析上面的文件：黑名单限制文件后缀，限制文件后缀大小写，去除<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">::$DATA</code>，限制上传<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.htaccess</code>，难道这个题是假的？</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">这里可以尝试二次上传的方式，借助<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">windows</code>平台的正则匹配规则：</p><p>如下符号在windows平台下等效果</p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-default">" =&gt; .<br mpa-from-tpl="t"  /><span class="hljs-default-meta" style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 6px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;"><br mpa-from-tpl="t"  />&gt;</span><span class="bash"> =&gt; ?</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />&lt; =&gt; *</code></pre></section><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">首先随便上传一个<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>，使用抓包工具(比如:<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">burpsuite</code>)，将文件后缀修改为：<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php:.jpg</code></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3357 no-shadow" data-ratio="0.5604838709677419" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/1_n9M5ZpR8bE2xd2ia4r4GF689BZEwug.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYytanjTlgezt6HUvroIkMNLKicyPn9M5ZpR8bE2xd2ia4r4GF689BZEwug/640?wx_fmt=jpeg'" data-type="jpeg" data-w="1240" height="616" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="1100"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">此时，会在<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">upload</code>目录下生成一个名为<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>的空文件：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3358 no-shadow" data-ratio="0.43595505617977526" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/2_6ibtMhc49S1ewU1ry4gJzYB89ePCXQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYylSPibHmNkDYQ5OqHpwLhto53796ibtMhc49S1ewU1ry4gJzYB89ePCXQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="445" height="194" style="margin: 0px 64.7px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="445"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">然后，修改数据包文件名为：<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.&lt;&lt;&lt;</code>，这里在<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">move_uploaded_file($temp_file, '../../upload/shell.&lt;&lt;&lt;')</code>类似与正则匹配，匹配到<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.../../upload/shell.php</code>文件，然后会将此次上传的文件数据写入到<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>文件中，这样就成功写入我们的小马了。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3359 no-shadow" data-ratio="0.5608695652173913" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/3_Ozy2kakajLPhfLLxxMLYzgPIGhFHhA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYy7AHQS7Qnq0ic62C0IOq7zPMgzOzy2kakajLPhfLLxxMLYzgPIGhFHhA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="387" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">试试能不能执行呐？</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3360 no-shadow" data-ratio="0.4217391304347826" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/4_W3C1z0CMEG07aHvZVGIP2xuDJJeYag.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyhKdaic3UCbwlafIWO7Gu7Bc0qW3C1z0CMEG07aHvZVGIP2xuDJJeYag/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="291" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">在这里，对于文件上传的练习靶场，非常推荐<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Uplaod-labs</code>这个项目：https://github.com/c0ny1/upload-labs。</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×03 如何突破文件删除</h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">任意删除文件漏洞常存在于删除头像、文章附件、<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CMS</code>&nbsp;管理插件、模版和数据库备份删除的地方，同时文件重写的地方，通常来说这些删除的操作是需要严格控制用户权限和资源所有对象，因为删除文件的操作，没有太多的可研究性，其主要在于寻找类似在&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">PHP</code>&nbsp;中的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">unlink()</code>&nbsp;函数或者文件覆盖的一些函数（没有重命名），对于有权限验证，不好利用的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CSRF</code>&nbsp;漏洞配合一起利用</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><strong>实战示例：</strong></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">来自&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">emlog 6.0.0</code>&nbsp;博客&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CMS</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">emlog</code>&nbsp;官方于不久前更新了&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">6.0.0</code>&nbsp;的正式版，小东在之前审计过测试版代码，不知道修复了没？不清楚的老铁，可以先瞅瞅这篇文章：[代码审计]Emlog 6.0 Beta</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">安装：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3361 no-shadow" data-ratio="0.5623188405797102" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/5_saxiaNnFvoasSFzsI0voeb7n6ia8LA.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyAO23rwJGgWos10Z2yKppCNwMVCsaxiaNnFvoasSFzsI0voeb7n6ia8LA/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="388" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">正常的下载安装到本地环境，直接来到&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">/admin/data.php</code>&nbsp;文件，这个文件内的操作是用作数据库的备份、导入和删除，如下代码，可以看到，通过构造参数可以直接删除&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">$_PSOT['bak']</code>&nbsp;参数传递的文件名，这就形成了一个删除任意文件的漏洞（不过这个CMS做了全局的文件访问权限控制，此文件仅限管理员可以访问，配合&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CSRF</code>&nbsp;可以实现任意文件删除！）。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3362 no-shadow" data-ratio="0.5144927536231884" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/6_MIKUJ5V9dqVAjNs9wKT4icMXt4YiaQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyNu7AZrdDKMTUwm5yusRZVnfEmuMIKUJ5V9dqVAjNs9wKT4icMXt4YiaQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="355" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">那么Payload：</p><p>POST http:<span class="hljs-comment">//www.test.com/admin/?act=dell_all_bak</span></p><p style="margin-top: 20px;margin-bottom: 20px;word-break: break-word;vertical-align: baseline;line-height: 1.8;"><span class="hljs-symbol">data:</span>bak=../index.php</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">构造一个&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CSRF</code>&nbsp;网页，发到各大&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">emlog</code>&nbsp;QQ交流群、论坛等等去，emmmm~（太危险，不建议这样做，别说是我说的）。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">那么修复的方法，自然是加上一个&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">TOKEN</code>&nbsp;身份判断！</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">最后补充&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">emlog6.0.0</code>&nbsp;下载地址：点我下载。</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×04 如何突破文件修改</h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><strong>文件修改</strong>，是针对已存在的文件进行修改，比如有的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CMS</code>&nbsp;可以实现模版的在线编辑，利用一些规则特性可以直接写入木马。当然还有备份文件，配置文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">常见于一些配置文件没有过滤参数，使得单双引号被闭合，写入小马到配置文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">修改文件的时候，可能会遇到一些权限不足，没法儿写入的问题，一般会寻找<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">images</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">uplaod</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">logs</code>，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">runtime</code>等可以执行写操作的目录（寻找方式也比较简单，查看文章图片的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">URL</code>，用户头像&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">URL</code>等等）</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">此漏洞就不做实战演示了，基本都是配合上传文件使用，比如某些&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">CMS</code>&nbsp;提供插件安装，插件市场有修改模版文件的一些插件，emmm~，好心帮助站长安装一个，然后编辑一下，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Webshell</code>就到手了！</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×05 如何突破文件读取</h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><strong>文件的读取</strong>，包括列目录、读取任意文件内容、任意文件包含、任意文件下载。任意文件读取/包含漏洞常常在实战场景有非常大的用处，在寻找文件读取漏洞的时候，需要根据网站的类型及CMS去代码审计或者寻找&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">indexOf</code>&nbsp;列目录寻找可能存在任意文件包含读取的特殊文件，比如一些：&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">file.php</code>,<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">download.php</code></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">通过御剑扫描，扫描到一些数据库、源码备份文件，来一次代码审计，那就赚大发了。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">找到任意文件包含的漏洞，配合上传<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">图片马</code>，就可以轻松实现&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Getshell</code>，想想就觉得美滋滋~</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">在文件包含上，可能存在一些无法读取，文件名限制等等，该如何处理呐？</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">实战示例</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">简单构造了一个典型的文件包含漏洞，简单看看利用&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">PHP</code>&nbsp;伪协议怎么玩儿？</p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" class="mpa-template" mpa-preserve="t" mpa-from-tpl="t"><pre style="margin:0;padding:0;border-radius:none;background:none;"><code style="border-radius: 4px;font-size: 0.85em;margin: 0px 0.15em;background: rgb(40, 44, 52);color: rgb(171, 178, 191);display: block;padding: 5.95px;overflow-x: auto;white-space: nowrap;" class="hljs-default"><span class="php"><span class="hljs-default-meta" style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;">&lt;?php</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 209px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">//D:/server/htdocs/test/test.php</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-comment" style="color: rgb(92, 99, 112);background: rgba(0, 0, 0, 0);display: inline;width: 67px;text-decoration: none solid rgb(92, 99, 112);font-weight: 400;font-style: italic;">// 文件包含</span><br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  />@$file = <span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 33px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">isset</span>($_GET)?$_GET[<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 39px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'file'</span>]:<span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 66px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">'test.php'</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 78px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">include_once</span>($file);<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-keyword" style="color: rgb(198, 120, 221);background: rgba(0, 0, 0, 0);display: inline;width: 26px;text-decoration: none solid rgb(198, 120, 221);font-weight: 400;font-style: normal;">echo</span> <span class="hljs-default-string" style="color: rgb(152, 195, 121);background: rgba(0, 0, 0, 0);display: inline;width: 234px;text-decoration: none solid rgb(152, 195, 121);font-weight: 400;font-style: normal;">"这个文件可以包含任意的文件(⊙o⊙)哦！"</span>;<br mpa-from-tpl="t"  /><br mpa-from-tpl="t"  /><span class="hljs-default-meta" style="color: rgb(97, 174, 238);background: rgba(0, 0, 0, 0);display: inline;width: 13px;text-decoration: none solid rgb(97, 174, 238);font-weight: 400;font-style: normal;">?&gt;</span></span></code></pre></section><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">在PHP中，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">include</code>&nbsp;和&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">require</code>&nbsp;两个文件包含函数，将包含进来的代码当作可执行PHP代码执行，所以无论我们包含的文件格式后缀是什么，都会当作&nbsp;<strong><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;font-weight: normal;">PHP</code>代码来执行</strong>，即使是一个&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">txt</code>&nbsp;文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">在&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">upload/</code>&nbsp;文件夹下情况：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3363 no-shadow" data-ratio="0.22647058823529412" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/7_XI499YfhJiaW3ZBDSyVfMtd0jnMe5Q.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyzAcZmfbmADCFjg3rgvx1RMJCsXI499YfhJiaW3ZBDSyVfMtd0jnMe5Q/640?wx_fmt=jpeg'" data-type="jpeg" data-w="680" height="154" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="680"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">其中&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.zip</code>&nbsp;是一个内含名为&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>&nbsp;的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">zip</code>&nbsp;格式压缩包。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><strong>开始利用</strong></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">第一种：读取&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">hourse.jpg</code>，通过图片马包含执行，<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">$_GET</code>&nbsp;是一个超全局变量，所以在包含的&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">shell.php</code>&nbsp;文件也可以接收参数&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">x</code>&nbsp;执行：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Payload</code>:&nbsp;http://www.test.com/test.php?file=upload/hourse.jpg&amp;x=phpinfo()</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3364 no-shadow" data-ratio="0.5492753623188406" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/8_Nkqf5FwSvDQZcz4icMpZbltSjgDKEw.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyXY01LpAS9icXOiaPagvHqCjJdeSNkqf5FwSvDQZcz4icMpZbltSjgDKEw/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="379" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">第二种：文件协议读取</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">其前提是得知道网站应用的绝对路径（物理路径）：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Payload</code>:&nbsp;http://www.test.com/test.php?file=file://D:/Server/htdocs/test/upload/hourse.jpg&amp;x=phpinfo()</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">结果和上图一样，只是地址栏链接不一样。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">第三种：压缩包文件读取</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">依然需要知道压缩包文件的绝对路径：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Payload</code>:&nbsp;http://www.test.com/test.php?file=zip://D:/Server/htdocs/test/upload/shell.zip%23shell.php&amp;x=phpinfo())</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3365 no-shadow" data-ratio="0.5028985507246376" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/9_sg7qPNQw2I5riaAZsRRicicWAYZljg.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyBQS0vAg5qDJkL88KGHiauuicKWxLAsg7qPNQw2I5riaAZsRRicicWAYZljg/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="347" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">第四种：<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">phar://</code>相对路径运行PHP文件</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">当我们想要运行自己的<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">PHP</code>文件，该咋做呐？通过文件包含（<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">include</code>,<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">require</code>这类函数），首先构造一个这样的文件，将&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">webshell.php</code>&nbsp;添加到压缩文件&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.zip</code>，然后将压缩包后缀名改为<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">.jpg</code>反正合法的文件后缀即可（一般的操作是这样的，当只能上传图片的时候），最后使用<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">phar://</code>按照相对路径读取并执行文件。</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><img class="aligncenter size-full wp-image-3366 no-shadow" data-ratio="0.7260869565217392" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/10_J60zfHRKicicbH4mOEB9icpZ37BKKQ.jpg" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_jpg/Uq8QfeuvouicnsR4nuEt5U2GbjdnLbbYyunkgzTbdY992dVyicO7OWTfbCXawJ60zfHRKicicbH4mOEB9icpZ37BKKQ/640?wx_fmt=jpeg'" data-type="jpeg" data-w="690" height="501" style="margin: 0px;border-width: 0px;border-style: initial;border-color: initial;box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 2.6875rem;border-radius: 2px;display: block;text-align: center;top: 0px;left: 0px;right: 0px;bottom: 0px;" width="690"  /></p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Payload</code>：http://www.test.php?file=phar://upload/shell.jpg/shell.php?x=phpinfo()</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">第五种：读取源码</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">当我们没法儿上传文件，但是又想读取文件的源码来寻找别的漏洞从而进一步利用该怎么做呐？同样的利用&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">php://filter/</code>&nbsp;协议可以实现，要注意的是，因为编码问题，一般我们会将读取的文件先&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Base64</code>&nbsp;编码一下输出：</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);"><code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Payload</code>：http://www.test.com/test.php?file=php://filter/read=convert.base64-encode/resource=upload/shell.php</p><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">补充PHP伪协议的知识：PHP之伪协议深入理解</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×06 简述突破拦截</h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">某些网站总是存在一些“看门狗”和“XX盾”，拦截可谓是相当的暴力。对于拦截来说，分两种：一种是基于文件后缀，另一种是基于文件内容。</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">1.基于文件后缀：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">一般来说，在配置都是白名单的方式，我们可以&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">Fuzz</code>&nbsp;测试一下，可上传文件类型，再配合上述说到的方法，尝试去绕过。</p><h3 style="margin-top: 1em;margin-bottom: 0.8em;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: 1.1em;font-weight: 700;color: rgb(0, 0, 0);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">2.基于文件内容：</h3><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">这种方式一定程度上减少了误报，根据一些表哥的经验：程序开发人员会犯什么错误，这样的错误我们是否可以利用起来？比如&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">preg_replace('/e','',"$GET['x']")</code>，反序列化，远程读取文件，本地文件包含，小马混淆加密加壳，关键词拆分替换组合等等，还有很多很多的骚思路，欢迎各位表哥一起探讨。</p><h2 style="margin-top: 30px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight: 600;font-size: 1.3em;color: rgb(68, 68, 68);text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">0×07 总结</h2><p style="margin-top: 20px;margin-bottom: 20px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;word-break: break-word;vertical-align: baseline;line-height: 1.8;color: rgb(0, 0, 0);font-size:14px;line-height:34px;;text-align: start;white-space: normal;background-color: rgba(255, 255, 255, 0.88);">总结了文件操作方面的漏洞，以及单纯从文件操作上来获取<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">SHELL</code>，但真实的环境，我们常常是多种类型的漏洞组合利用，比如<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">SQL</code>注入写文件，命令执行漏洞权限高可不直接就拿下服务器了么，服务器存在进程溢出的程序，直接&nbsp;<code style="margin-right: 2px;margin-left: 2px;padding: 2px 5px;font family: &quot;Microsoft Yahei&quot;, 微软雅黑, &quot;Helvetica Neue&quot;, Helvetica, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color: rgb(255, 255, 255);background-color: rgb(155, 155, 155);border-radius: 3px;">MSF</code>&nbsp;给打过去，之后就是内网一把梭。渗透测试，是一次充分活跃思维，跳出局限的脑力活动，不断总结经验，才会不断进步，共勉！</p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong>推荐阅读：</strong></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong><br  /></strong></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><span style="color: rgb(0, 0, 0);font-size:17px;line-height:37px;;"><strong><span style="color: rgb(0, 0, 0);font family: &quot;PingFang SC&quot;, Tahoma, Helvetica, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Heiti SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-align: left;white-space: pre-wrap;background-color: rgb(255, 255, 255);">Discuz ML RCE漏洞检测工具</span></strong></span></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: center;"><strong><span style="font-size:13px;line-height:33px;;color: rgb(255, 76, 0);">https://github.com/theLSA/discuz-ml-rce</span></strong></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);"><strong><img data-type="png" class="" data-ratio="0.109375" data-w="640" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/11_rsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q.png" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png'" style="letter-spacing: 0.544px;visibility: visible !important;width: 640px !important;"  /></strong><br  /></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;"><span style="font-size:12px;line-height:32px;;">作者：</span><span style="font-size:12px;line-height:32px;;">Mr.wu</span></p><p style="font family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;background-color: rgb(255, 255, 255);text-align: right;"><span style="font-size:12px;line-height:32px;;">&nbsp;来源：</span><span style="font-size:12px;line-height:32px;;">Mr.wu's博客</span></p><p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="0.5197505197505198" src="图片/HACK学习呀_2019-07-18_渗透测试中如何快速拿到Webshell/12_EedaMZeibI6cKE55jiaLMf9APuY0pA.gif" onerror="this.src='https://mmbiz.qpic.cn/mmbiz_gif/Uq8QfeuvouibQiaEkicNSzLStibHWxDSDpKeBqxDe6QMdr7M5ld84NFX0Q5HoNEedaMZeibI6cKE55jiaLMf9APuY0pA/640?wx_fmt=gif'" data-type="gif" data-w="962" style=""  /></p>
                </div>
</div>
</body>
</html>